<?xml version="1.0" encoding="iso-8859-1"?>
<!-- comment -->
<!DOCTYPE rfc SYSTEM "rfc2629.dtd"[]>
<?rfc toc="yes" ?>
<?rfc compact="yes" ?>
<?rfc sortrefs="no" ?>
<rfc ipr="pre5378Trust200902" category="std" docName="draft-ietf-mmusic-sdp-bundle-negotiation-36.txt" updates="3264" submissionType="IETF" xml:lang="en">
<front>
    <title abbrev="Bundled media">
    Negotiating Media Multiplexing Using the Session Description Protocol (SDP)
  </title>
    <author initials="C.H." surname="Holmberg" fullname="Christer Holmberg">
    <organization>Ericsson</organization>
    <address>
      <postal>
        <street>Hirsalantie 11</street>
        <code>02420</code>
        <city>Jorvas</city>
        <country>Finland</country>
      </postal>
      <email>christer.holmberg@ericsson.com</email>
    </address>
    </author>

  <author fullname="Harald Tveit Alvestrand" surname="Alvestrand" initials="H. T.">
    <organization>Google</organization>
    <address>
      <postal>
        <street>Kungsbron 2</street>
        <city>Stockholm</city>
        <code>11122</code>
        <country>Sweden</country>
      </postal>
      <email>harald@alvestrand.no</email>
    </address>
    </author>

  <author fullname="Cullen Jennings" initials="C." surname="Jennings">
    <organization>Cisco</organization>
    <address>
      <postal>
        <street>400 3rd Avenue SW, Suite 350</street>
        <city>Calgary</city>
        <region>AB</region>
        <code>T2P 4H2</code>
        <country>Canada</country>
      </postal>
      <email>fluffy@iii.ca</email>
      </address>
    </author>

    <date year="2016" />
    <area>Transport</area>
    <workgroup>MMUSIC Working Group</workgroup>
    <keyword>RTP</keyword>
    <keyword>SDP</keyword>
  <keyword>Bundle</keyword>
    <keyword>Multiplexing</keyword>
    <keyword>RTCWEB</keyword>
  <keyword>CLUE</keyword>
  <keyword>RTCWEB</keyword>
  <keyword>MMUSIC</keyword>
  <keyword>AVT</keyword>
    <keyword>WEB</keyword>
    <keyword>Browser</keyword>

    <abstract>
      <t>
        This specification defines a new Session Description
        Protocol (SDP) Grouping Framework
        extension, 'BUNDLE'. The extension can be used with the
        SDP Offer/Answer mechanism to negotiate the usage of a
        single address:port combination (BUNDLE address) for receiving media,
        referred to as bundled media, specified by multiple
        SDP media descriptions ("m=" lines).
      </t>
      <t>
        To assist endpoints in negotiating the use of bundle this
        specification defines a new SDP attribute, 'bundle-only',
        which can be used to request that specific media is only
        used if bundled. The specification also updates RFC 3264,
        to allow usage of zero port values without meaning that
        media is rejected.
      </t>
      <t>
        There are multiple ways to correlate the bundled RTP
        packets with the appropriate media descriptions. This
        specification defines a new Real-time Transport Protocol
        (RTP) source description (SDES) item and a new RTP header
        extension that provides an additional way to do this
        correlation by using them to carry a value that
        associates the RTP/RTCP packets with a specific media
        description.
      </t>
    </abstract>
</front>

<middle>
  <section title="Introduction" toc="default">
   <t>
     When multimedia communications are established, each 5-tuple reserved for an individual media stream
     consume additional resources (especially when Interactive Connectivity Establishment (ICE)
     <xref format="default" pageno="false" target="RFC5245"/> is used). For this reason, it is
     attractive to use a 5-tuple for multiple media streams.
  </t>
  <t>
    This specification defines a way to use a single address:port combination (BUNDLE address) for
    receiving media specified by multiple SDP media descriptions ("m=" lines).
  </t>
  <t>
    This specification defines a new SDP Grouping Framework <xref format="default" pageno="false"
    target="RFC5888"/> extension called 'BUNDLE'. The extension can be used with the Session Description
    Protocol (SDP) Offer/Answer mechanism <xref format="default" pageno="false" target="RFC3264"/>
    to negotiate the usage of a BUNDLE group. Within the BUNDLE group, a BUNDLE address is used
    for receiving media specified by multiple "m=" lines. This is referred to as bundled media.
  </t>
  <t>
    The offerer and answerer <xref format="default" pageno="false" target="RFC3264"/> use
    the BUNDLE extension to negotiate the BUNDLE addresses, one for the offerer (offerer BUNDLE
    address) and one for the answerer (answerer BUNDLE address), to be used for receiving
    the bundled media specified by a BUNDLE group. Once the offerer and the answerer have
    negotiated a BUNDLE group, they associate their respective BUNDLE address with each "m=" line
    in the BUNDLE group. The BUNDLE addresses are used to receive all media specified by
    the BUNDLE group.
  </t>
  <t>
    The use of a BUNDLE group and a BUNDLE address also allows the usage of a single set of
    Interactive Connectivity Establishment (ICE) <xref format="default" pageno="false" target="RFC5245"/>
    candidates for multiple "m=" lines.
  </t>
  <t>
    This specification  also defines a new SDP attribute, 'bundle-only', which can be used to
    request that specific media is only used if kept within a BUNDLE group. The specification
    also updates RFC 3264, to allow usage of zero port values without meaning that media is rejected.
  </t>
  <t>
    As defined in RFC 4566 <xref format="default" pageno="false" target="RFC4566"/>, the
    semantics of assigning the same transport address (IP address and port) to multiple
    "m=" lines are undefined, and there is no grouping defined by such means. Instead, an
    explicit grouping mechanism needs to be used to express the intended semantics. This
    specification provides such an extension.
  </t>
  <t>
    This specification also updates sections 5.1, 8.1 and 8.2 of RFC 3264 <xref format="default" pageno="false"
    target="RFC3264"/>. The update allows an answerer to assign a non-zero port value to an "m=" line in an
    SDP answer, even if the "m=" line in the associated SDP offer contained a zero port value.
  </t>
  <t>
    This specification also defines a new Real-time Transport Protocol (RTP) <xref format="default"
    pageno="false" target="RFC3550"/> source description (SDES) item, 'MID', and a new RTP SDES header
    extension that can be used to associate RTP streams with media descriptions.
  </t>
  <t>
    SDP bodies can contain multiple BUNDLE groups. A given BUNDLE address MUST only be associated
    with a single BUNDLE group. The procedures in this specification apply independently to a given
    BUNDLE group. All RTP based media flows described by a single BUNDLE group belong to a single
    RTP session <xref format="default" pageno="false" target="RFC3550"/>.
  </t>
  <t>
    The BUNDLE extension is backward compatible. Endpoints that do not support the extension
    are expected to generate offers and answers without an SDP 'group:BUNDLE' attribute, and
    are expected to associate a unique address with each "m=" line within an offer and answer, according
    to the procedures in <xref format="default" pageno="false" target="RFC4566"/> and
    <xref format="default" pageno="false" target="RFC3264"/>
  </t>
  </section>


    <section title="Terminology" toc="default">
    <t>
      "m=" line: SDP bodies contain one or more media descriptions. Each media
      description is identified by an SDP "m=" line.
    </t>
    <t>
      5-tuple: A collection of the following values: source address, source
      port, destination address, destination port, and transport-layer
      protocol.
    </t>
    <t>
      Unique address: An IP address and port combination that is associated with
      only one "m=" line in an offer or answer.
    </t>
    <t>
      Shared address: An IP address and port combination that is associated with
      multiple "m=" lines within an offer or answer.
    </t>
    <t>
      Offerer BUNDLE-tag: The first identification-tag in a given
      SDP 'group:BUNDLE' attribute identification-tag list in an offer.
    </t>
    <t>
      Answerer BUNDLE-tag: The first identification-tag in a given
      SDP 'group:BUNDLE' attribute identification-tag list in an answer.
    </t>
    <t>
      Offerer BUNDLE address: Within a given BUNDLE group, an IP address and
      port combination used by an offerer to receive all media specified
      by each "m=" line within the BUNDLE group.
    </t>
    <t>
      Answerer BUNDLE address: Within a given BUNDLE group, an IP address and
      port combination used by an answerer to receive all media specified
      by each "m=" line within the BUNDLE group.
    </t>
    <t>
      BUNDLE group: A set of "m=" lines, created using an SDP Offer/Answer
      exchange, which uses the same BUNDLE address for receiving media.
    </t>
    <t>
      Bundled "m=" line: An "m=" line, whose identification-tag
      is placed in an SDP 'group:BUNDLE' attribute identification-tag list
      in an offer or answer.
    </t>
    <t>
      Bundle-only "m=" line: A bundled "m=" line with an associated
      SDP 'bundle-only' attribute.
    </t>
    <t>
      Bundled media: All media specified by a given BUNDLE group.
    </t>
    <t>
      Initial offer: The first offer, within an SDP session (e.g. a SIP dialog
      when the Session Initiation Protocol (SIP) <xref format="default"
      pageno="false" target="RFC3261" /> is used to carry SDP), in which
      the offerer indicates that it wants to create a given BUNDLE group.
    </t>
    <t>
      Subsequent offer: An offer which contains a BUNDLE group that
      has been created as part of a previous offer/answer exchange.
    </t>
    <t>
      Identification-tag: A unique token value that is used to identify an
      "m=" line. The SDP 'mid' attribute <xref format="default" pageno="false"
      target="RFC5888" />, associated with an "m=" line, carries
      an unique identification-tag. The session-level SDP 'group' attribute
      <xref format="default" pageno="false" target="RFC5888" /> carries a list
      of identification-tags, identifying the "m=" lines associated with that
      particular 'group' attribute.
    </t>
  </section>


    <section title="Conventions" toc="default">
    <t>
      The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT",
      "SHOULD", "SHOULD NOT", "RECOMMENDED", "MAY", and "OPTIONAL" in this
      document are to be interpreted as described in BCP 14, RFC 2119 <xref
      format="default" pageno="false" target="RFC2119" />.
    </t>
    </section>


    <section title="Applicability Statement" toc="default">
    <t>
      The mechanism in this specification only applies to the Session
      Description Protocol (SDP) <xref format="default" pageno="false"
      target="RFC4566"/>, when used together with the SDP offer/answer
      mechanism <xref format="default" pageno="false" target="RFC3264"/>.
      Declarative usage of SDP is out of scope of this document, and is
      thus undefined.
    </t>
    </section>

  <section title="SDP Grouping Framework BUNDLE Extension" anchor="sec-group" toc="default">
    <t>
      This section defines a new SDP Grouping Framework extension
      <xref format="default" pageno="false" target="RFC5888"/>, 'BUNDLE'. The
      BUNDLE extension can be used with the SDP Offer/Answer mechanism to negotiate
      the usage of a single address:port combination (BUNDLE address) for receiving bundled media.
    </t>
    <t>
      A single address:port combination is also used for sending bundled media. The address:port
      combination used for sending bundled media MAY be the same as the BUNDLE address, used to receive
      bundled media, depending on whether symmetric RTP <xref format="default" pageno="false"
      target="RFC4961"/> is used.
    </t>
    <t>
      All media associated with a BUNDLE group MUST be transport using the same
      transport-layer protocol (e.g., UDP or TCP).
    </t>
    <t>
      The BUNDLE extension is indicated using an SDP 'group' attribute
      with a "BUNDLE" semantics value <xref format="default" pageno="false"
      target="RFC5888"/>. An identification-tag is associated with each bundled
      "m=" line, and each identification-tag is listed in the SDP 'group:BUNDLE'
      attribute identification-tag list. Each "m=" line whose identification-tag
      is listed in the identification-tag list is associated with a given
      BUNDLE group.
    </t>
    <t>
      SDP bodies can contain multiple BUNDLE groups. Any given bundled "m="
      line MUST NOT be associated with more than one BUNDLE group.
    </t>
    <t>
      NOTE: The order of the "m=" lines listed in the SDP 'group:BUNDLE' attribute
      identification-tag list does not have to be the same as the order in which
      the "m=" lines occur in the SDP.
    </t>
    <t>
      <xref target="sec-sdp-oa" pageno="false" format="default"/> defines the
      detailed SDP Offer/Answer procedures for the BUNDLE extension.
    </t>
  </section>

  <section anchor="sec-bundle-only" title="SDP 'bundle-only' Attribute" toc="default">
    <t>
      This section defines a new SDP media-level attribute <xref target="RFC4566" pageno="false"
      format="default"/>, 'bundle-only'. 'bundle-only' is a property attribute
      <xref target="RFC4566" pageno="false" format="default"/>, and hence has no value.
    </t>
    <figure>
      <preamble></preamble>
      <artwork><![CDATA[

   Name: bundle-only

   Value: N/A

   Usage Level: media

   Charset Dependent: no

   Example:

     a=bundle-only

      ]]></artwork>
    </figure>
    <t>
      In order to ensure that an answerer that does not support the BUNDLE extension always
      rejects a bundled "m=" line, the offerer can assign a zero port value to the "m="
      line. According to <xref target="RFC3264" pageno="false" format="default"/> an answerer
      will reject such "m=" line.
      By associating an SDP 'bundle-only' attribute with such "m=" line, the offerer can
      request that the answerer accepts the "m=" line if the answerer supports the Bundle
      extension, and if the answerer keeps the "m=" line within the associated BUNDLE group.
    </t>
    <t>
      NOTE: Once the offerer BUNDLE address has been selected, the offerer does
      not need to include the 'bundle-only' attribute in subsequent offers. By
      associating the offerer BUNDLE address with an "m=" line of a subsequent offer,
      the offerer will ensure that the answerer will either keep the "m=" line within
      the BUNDLE group, or the answerer will have to reject the "m=" line.
    </t>
    <t>
      The usage of the 'bundle-only' attribute is only defined for a bundled "m=" line with
      a zero port value, within an offer. Other usage is unspecified.
    </t>
    <t>
      <xref target="sec-sdp-oa" pageno="false" format="default"/> defines the detailed SDP
      Offer/Answer procedures for the 'bundle-only' attribute.
    </t>
  </section>

  <section title="SDP Information Considerations" anchor="sec-sdp-cons" toc="default">
      <t>
        This section describes restrictions associated with the usage of
        SDP parameters within a BUNDLE group. It also describes, when parameter
        and attribute values have been associated with each bundled "m=" line, how to
        calculate a value for the whole BUNDLE group.
      </t>
    <section title="Connection Data (c=)" anchor="sec-sdp-cons-c" toc="default">
      <t>
        The "c=" line nettype value <xref format="default" pageno="false"
        target="RFC4566"/> associated with a bundled "m=" line MUST be 'IN'.
      </t>
      <t>
        The "c=" line addrtype value <xref format="default" pageno="false"
        target="RFC4566"/> associated with a bundled "m=" line MUST be 'IP4' or
        'IP6'. The same value MUST be associated with each "m=" line.
      </t>
      <t>
        NOTE: Extensions to this specification can specify usage of the BUNDLE
        mechanism for other nettype and addrtype values than the ones listed above.
      </t>
    </section>
    <section title="Bandwidth (b=)" anchor="sec-sdp-cons-b" toc="default">
        <t>
        An offerer and answerer MUST use the rules and restrictions defined
        in <xref target="I-D.ietf-mmusic-sdp-mux-attributes" /> for
        associating the SDP bandwidth (b=) line with bundled "m=" lines.
      </t>
    </section>
    <section title="Attributes (a=)" anchor="sec-sdp-cons-a" toc="default">
        <t>
        An offerer and answerer MUST use the rules and restrictions defined
        in <xref target="I-D.ietf-mmusic-sdp-mux-attributes" /> for
        associating SDP attributes with bundled "m=" lines.
      </t>
    </section>
  </section>

  <section title="SDP Offer/Answer Procedures" anchor="sec-sdp-oa" toc="default">
      <t>
        This section describes the SDP Offer/Answer <xref format="default"
        pageno="false" target="RFC3264"/> procedures for:
        <list style="symbols">
          <t>
            Negotiating and creating a BUNDLE group; and
          </t>
          <t>
            Selecting the BUNDLE addresses (offerer BUNDLE address and answerer BUNDLE address); and
          </t>
          <t>
            Adding an "m=" line to a BUNDLE group; and
          </t>
          <t>
            Moving an "m=" line out of a BUNDLE group; and
          </t>
          <t>
            Disabling an "m=" line within a BUNDLE group.
          </t>
        </list>
      </t>
      <t>
        The generic rules and procedures defined in <xref format="default" pageno="false"
        target="RFC3264"/> and <xref format="default" pageno="false" target="RFC5888"/>
        also apply to the BUNDLE extension. For example, if an offer is rejected
        by the answerer, the previously negotiated SDP parameters and characteristics
        (including those associated with a BUNDLE group) apply. Hence, if an offerer
        generates an offer in which the offerer wants to create a BUNDLE group,
        and the answerer rejects the offer, the BUNDLE group is not created.
      </t>
      <t>
        The procedures in this section are independent of the media type or
        "m=" line proto value represented by a bundled "m=" line.
        <xref format="default" pageno="false" target="sec-rtp"/> defines additional
        considerations for RTP based media.
        <xref format="default" pageno="false" target="sec-bundle-only"/> defines
        additional considerations for the usage of the SDP 'bundle-only' attribute.
        <xref format="default" pageno="false" target="sec-ice"/> defines additional
        considerations for the usage of Interactive Connectivity Establishment (ICE)
        <xref format="default" pageno="false" target="I-D.ietf-ice-rfc5245bis"/> mechanism.
      </t>
      <t>
        SDP offers and answers can contain multiple BUNDLE groups. The procedures in this
        section apply independently to a given BUNDLE group.
      </t>
        <section anchor="sec-sdp-oa-cat" title="Mux Category Considerations" toc="default">
        <t>
          When an offerer associates SDP attributes with a bundled "m=" line associated
          with a shared address, IDENTICAL and TRANSPORT mux category SDP attributes
          <xref target="I-D.ietf-mmusic-sdp-mux-attributes" /> are associated with the
          "m=" line only if the "m=" line is also associated with the offerer BUNDLE-tag.
          Otherwise the offerer MUST NOT associate such SDP attributes with the "m=" line.
        </t>
        <t>
          When an answerer associates SDP attributes with a bundled "m=" line,
          IDENTICAL and TRANSPORT mux category SDP attributes are associated with the
          "m=" line only if the "m=" line is also associated with the answerer BUNDLE-tag.
          Otherwise the answerer MUST NOT associated such SDP attributes with the "m=" line.
        </t>
        <t>
          NOTE: As bundled "m=" lines associated with a shared address will share the same IDENTICAL
          and TRANSPORT mux category SDP attributes, and attribute values, there is no need to
          associate such SDP attributes with each "m=" line. The attributes and attribute
          values are implicitly applied to each "m=" line associated with the shared address.
        </t>
    </section>
    <section anchor="sec-sdp-oa-ino" title="Generating the Initial SDP Offer" toc="default">
        <t>
          When an offerer generates an initial offer, in order to create a
          BUNDLE group, it MUST:
          <list style="symbols">
            <t>
              Assign a unique address to each "m=" line within the offer,
              following the procedures in <xref target="RFC3264" pageno="false"
              format="default"/>, unless the media line is a 'bundle-only'
              "m=" line (see below); and
            </t>
            <t>
              Add an SDP 'group:BUNDLE' attribute to the offer; and
            </t>
            <t>
              Place the identification-tag of each bundled "m=" line in the
              SDP 'group:BUNDLE' attribute identification-tag list; and
            </t>
            <t>
              Indicate which unique address the offerer suggests as the
              offerer BUNDLE address [<xref target="sec-sdp-oa-ino-req" pageno="false"
              format="default"/>].
            </t>
          </list>
        </t>
        <t>
          If the offerer wants to request that the answerer accepts a given bundled "m=" line only if
          the answerer keeps the "m=" line within the BUNDLE group, the offerer MUST:
          <list style="symbols">
            <t>
              Associate an SDP 'bundle-only' attribute [<xref target="sec-sdp-oa-ino-req" pageno="false"
              format="default"/>] with the "m=" line; and
            </t>
            <t>
              Assign a zero port value to the "m=" line.
            </t>
          </list>
        </t>
        <t>
          NOTE: If the offerer assigns a zero port value to an "m=" line, but does not also associate an
          SDP 'bundle-only' attribute with the "m=" line, it is an indication that the offerer wants
          to disable the "m=" line [<xref target="sec-sdp-oa-mod-dis" pageno="false" format="default"/>].
        </t>
        <t>
          [<xref target="sec-example-add" pageno="false" format="default"/>] shows
          an example of an initial offer.
        </t>
      <section title="Suggesting the offerer BUNDLE address" anchor="sec-sdp-oa-ino-req" toc="default">
        <t>
          In the offer, the address associated with the "m=" line associated with the
          offerer BUNDLE-tag indicates the address that the offerer suggests as
          the offerer BUNDLE address.
        </t>
        <t>
          The "m=" line associated with the offerer BUNDLE-tag MUST NOT contain a zero
          port value or an SDP 'bundle-only' attribute.
        </t>
      </section>
      <section anchor="sec-sdp-oa-ino-ex" title="Example: Initial SDP Offer">
        <t>
          The example shows an initial SDP offer. The offer includes two
          "m=" lines in the SDP, and suggests that both are included in
          a BUNDLE group. The audio "m=" line is associated with the
          offerer BUNDLE-tag (placed first in the SDP group:BUNDLE
          attribute identificatoin-id list).
        </t>
        <figure>
        <artwork align="left" alt="" height="" name="" type="" width=""
                 xml:space="preserve"><![CDATA[

SDP Offer

  v=0
  o=alice 2890844526 2890844526 IN IP4 atlanta.example.com
  s=
  c=IN IP4 atlanta.example.com
  t=0 0
  a=group:BUNDLE foo bar
  m=audio 10000 RTP/AVP 0 8 97
  b=AS:200
  a=mid:foo
  a=rtcp-mux
  a=rtpmap:0 PCMU/8000
  a=rtpmap:8 PCMA/8000
  a=rtpmap:97 iLBC/8000
  a=extmap 1 urn:ietf:params:rtp-hdrext:sdes:mid
  m=video 10002 RTP/AVP 31 32
  b=AS:1000
  a=mid:bar
  a=rtcp-mux
  a=rtpmap:31 H261/90000
  a=rtpmap:32 MPV/90000
  a=extmap 1 urn:ietf:params:rtp-hdrext:sdes:mid

]]></artwork>
      </figure>
      </section>
    </section>

    <section anchor="sec-sdp-oa-ans" title="Generating the SDP Answer" toc="default">
        <t>
          When an answerer generates an answer that contains a BUNDLE group, the following general
          SDP grouping framework restrictions, defined in <xref target="RFC5888" pageno="false"
          format="default"/>, also apply to the BUNDLE group:
          <list style="symbols">
            <t>
              The answerer MUST NOT include a BUNDLE group in the answer, unless the
              offerer requested the BUNDLE group to be created in the corresponding offer; and
            </t>
            <t>
              The answerer MUST NOT include an "m=" line within a BUNDLE group, unless
              the offerer requested the "m=" line to be within that BUNDLE group in the
              corresponding offer.
            </t>
          </list>
        </t>
        <t>
          If the answer contains a BUNDLE group, the answerer MUST:
          <list style="symbols">
            <t>
              Select an Offerer BUNDLE Address [<xref target="sec-sdp-oa-ans-off"
              pageno="false" format="default"/>]; and
            </t>
            <t>
              Select an Answerer BUNDLE Address [<xref target="sec-sdp-oa-ans-ans"
              pageno="false" format="default"/>];
            </t>
          </list>
        </t>
        <t>
          The answerer is allowed to select a new Answerer BUNDLE address each time it
          generates an answer to an offer.
        </t>
        <t>
          If the answerer does not want to keep an "m=" line within a BUNDLE group, it MUST:
          <list style="symbols">
            <t>
              Move the "m=" line out of the BUNDLE group [<xref target="sec-sdp-oa-ans-mov"
              pageno="false" format="default"/>]; or
            </t>
            <t>
              Reject the "m=" line [<xref target="sec-sdp-oa-ans-rej" pageno="false"
              format="default"/>];
            </t>
          </list>
        </t>
        <t>
          If the answerer keeps a bundle-only "m=" line within the BUNDLE group,
          it follows the procedures (associates the answerer BUNDLE address with the "m="
          line etc) for any other "m=" line kept within the BUNDLE group.
        </t>
        <t>
          If the answerer does not want to keep a bundle-only "m=" line within the
          BUNDLE group, it MUST reject the "m=" line [<xref target="sec-sdp-oa-ans-rej"
          pageno="false" format="default"/>].
        </t>
        <t>
          The answerer MUST NOT associate an SDP 'bundle-only' attribute with any
          "m=" line in an answer.
        </t>
        <t>
          NOTE: If a bundled "m=" line in an offer contains a zero port value, but the "m=" line does not contain
          an SDP 'bundle-only' attribute, it is an indication that the offerer wants to disable the "m="
          line [<xref target="sec-sdp-oa-mod-dis" pageno="false" format="default"/>].
        </t>

      <section title="Answerer Selection of Offerer Bundle Address" anchor="sec-sdp-oa-ans-off" toc="default">
        <t>
          In an offer, the address (unique or shared) associated with the bundled "m=" line
          associated with the offerer BUNDLE-tag indicates the address that
          the offerer suggests as the offerer BUNDLE address
          [<xref target="sec-sdp-oa-ino-req" pageno="false" format="default"/>]. The answerer
          MUST check whether that "m=" line fulfils the following criteria:
          <list style="symbols">
            <t>
              The answerer will not move the "m=" line out of the BUNDLE group
              [<xref target="sec-sdp-oa-ans-mov" pageno="false" format="default"/>]; and
            </t>
            <t>
              The answerer will not reject the "m=" line [<xref target="sec-sdp-oa-ans-rej"
              pageno="false" format="default"/>]; and
            </t>
            <t>
              The "m=" line does not contain a zero port value.
            </t>
          </list>
        </t>
        <t>
          If all of the criteria above are fulfilled, the answerer MUST select the address
          associated with the "m=" line as the offerer BUNDLE address. In the answer, the
          answerer BUNDLE-tag represents the "m=" line, and the
          address associated with the "m=" line in the offer becomes the offerer BUNDLE address.
        </t>
        <t>
          If one or more of the criteria are not fulfilled, the answerer MUST select the next
          identification-tag in the identification-tag list, and perform the same criteria
          check for the "m=" line associated with that identification-tag. If there are no
          more identification-tags in the identification-tag list, the answerer MUST NOT
          create the BUNDLE group. In addition, unless the answerer rejects the whole offer,
          the answerer MUST apply the answerer procedures for moving an "m=" line out of a
          BUNDLE group [<xref target="sec-sdp-oa-ans-mov" pageno="false" format="default"/>]
          to each bundled "m=" line in the offer when creating the answer.
        </t>
        <t>
          [<xref target="sec-example-add" pageno="false" format="default"/>] shows an
          example of an offerer BUNDLE address selection.
        </t>
      </section>

      <section title="Answerer Selection of Answerer BUNDLE Address" anchor="sec-sdp-oa-ans-ans" toc="default">
        <t>
          When the answerer selects a BUNDLE address for itself, referred to as the answerer
          BUNDLE address, it MUST associate that address with each bundled "m=" line within the
          created BUNDLE group in the answer.
        </t>
        <t>
          The answerer MUST NOT associate the answerer BUNDLE address with an "m=" line that is
          not within the BUNDLE group, or to an "m=" line that is within another BUNDLE group.
        </t>
        <t>
          [<xref target="sec-example-add" pageno="false" format="default"/>] shows an example of an
          answerer BUNDLE address selection.
        </t>
      </section>

      <section title="Moving A Media Description Out Of A BUNDLE Group" anchor="sec-sdp-oa-ans-mov" toc="default">
        <t>
          When an answerer wants to move an "m=" line out of a BUNDLE group,
          it MUST first check the following criteria:
          <list style="symbols">
          <t>
            In the corresponding offer, the "m=" line is associated with a shared
            address (e.g. a previously selected offerer BUNDLE address); or
          </t>
          <t>
            In the corresponding offer, an SDP 'bundle-only' attribute is
            associated with the "m=" line, and the "m=" line contains a
            zero port value.
          </t>
          </list>
        </t>
        <t>
          If either criteria above is fulfilled, the answerer MUST reject the "m=" line
          [<xref target="sec-sdp-oa-ans-rej" pageno="false" format="default"/>].
        </t>
        <t>
          Otherwise, if in the corresponding offer the "m=" line is associated with
          a unique address, the answerer MUST associate a unique address with the
          "m=" line in the answer (the answerer does not reject the "m=" line).
        </t>
        <t>
          In addition, in either case above, the answerer MUST NOT place the
          identification-tag, associated with the moved "m=" line, in the SDP
          'group' attribute identification-tag list associated with the BUNDLE
          group.
        </t>
      </section>

      <section title="Rejecting A Media Description In A BUNDLE Group" anchor="sec-sdp-oa-ans-rej" toc="default">
        <t>
          When an answerer rejects an "m=" line, it MUST associate an address with a zero port
          value with the "m=" line in the answer, according to the procedures in <xref
          target="RFC3264" pageno="false" format="default"/>.
        </t>
        <t>
          In addition, the answerer MUST NOT place the identification-tag, associated with
          the rejected "m=" line, in the SDP 'group' attribute identification-tag list
          associated with the BUNDLE group.
        </t>
      </section>
      <section title="Example: SDP Answer">
        <t>
          The example shows an SDP answer, based on the SDP offer in
          [<xref target="sec-sdp-oa-ino-ex" pageno="false" format="default"/>].
          The answers acceppts both "m=" lines in the BUNDLE group.
        </t>
        <figure>
        <artwork align="left" alt="" height="" name="" type="" width=""
                 xml:space="preserve"><![CDATA[

SDP Answer

  v=0
  o=bob 2808844564 2808844564 IN IP4 biloxi.example.com
  s=
  c=IN IP4 biloxi.example.com
  t=0 0
  a=group:BUNDLE foo bar
  m=audio 20000 RTP/AVP 0
  b=AS:200
  a=mid:foo
  a=rtcp-mux
  a=rtpmap:0 PCMU/8000
  a=extmap 1 urn:ietf:params:rtp-hdrext:sdes:mid
  m=video 20000 RTP/AVP 32
  b=AS:1000
  a=mid:bar
  a=rtcp-mux
  a=rtpmap:32 MPV/90000
  a=extmap 1 urn:ietf:params:rtp-hdrext:sdes:mid


]]></artwork>
      </figure>
      </section>
    </section>

    <section anchor="sec-sdp-oa-off-ans" title="Offerer Processing of the SDP Answer" toc="default">
      <t>
        When an offerer receives an answer, if the answer contains a BUNDLE group, the offerer
        MUST check that any bundled "m=" line in the answer was indicated as bundled in the
        corresponding offer. If there is no mismatch, the offerer MUST use the offerer BUNDLE address,
        selected by the answerer [<xref format="default" pageno="false" target="sec-sdp-oa-ans-off"/>],
        as the address for each bundled "m=" line.
      </t>
      <t>
        NOTE: As the answerer might reject one or more bundled "m=" lines, or move a bundled
        "m=" line out of a BUNDLE group, each bundled "m=" line in the offer might not be
        indicated as bundled in the answer.
      </t>
      <t>
        If the answer does not contain a BUNDLE group, the offerer MUST process the answer
        as a normal answer.
      </t>
    </section>

    <section title="Modifying the Session" anchor="sec-sdp-oa-mod" toc="default">
        <t>
          When an offerer generates a subsequent offer, it MUST associate
          the previously selected offerer BUNDLE address [<xref format="default"
          pageno="false" target="sec-sdp-oa-ans-off"/>] with each bundled "m=" line
          (including any bundle-only "m=" line), except if:
          <list style="symbols">
            <t>
              The offerer suggests a new offerer BUNDLE address
              [<xref target="sec-sdp-oa-mod-req" pageno="false" format="default"/>]; or
            </t>
            <t>
              The offerer wants to add a bundled "m=" line to the BUNDLE group
              [<xref target="sec-sdp-oa-mod-add" pageno="false" format="default"/>]; or
            </t>
            <t>
              The offerer wants to move a bundled "m=" line out of the BUNDLE group
              [<xref target="sec-sdp-oa-mod-mov" pageno="false" format="default"/>]; or
            </t>
            <t>
              The offerer wants to disable the bundled "m=" line [<xref format="default"
              pageno="false" target="sec-sdp-oa-mod-dis"/>].
            </t>
          </list>
        </t>
        <t>
          In addition, the offerer MUST select an offerer BUNDLE-tag
          [<xref format="default" pageno="false" target="sec-sdp-oa-ino-req"/>]
          associated with the previously selected offerer BUNDLE address, unless
          the offerer suggests a new offerer BUNDLE address.
        </t>
      <section title="Suggesting a new offerer BUNDLE address" anchor="sec-sdp-oa-mod-req" toc="default">
        <t>
          When an offerer generates an offer, in which it suggests a new
          offerer BUNDLE address [<xref target="sec-sdp-oa-ino-req"
          pageno="false" format="default"/>], the offerer MUST:
          <list style="symbols">
            <t>
              Assign the address (shared address) to each "m=" line within the BUNDLE group; or
            </t>
            <t>
              Assign the address (unique address) to one bundled "m=" line.
            </t>
          </list>
        </t>
        <t>
          In addition, the offerer MUST indicate that the address is the
          new suggested offerer BUNDLE address [<xref format="default" pageno="false"
          target="sec-sdp-oa-ino-req"/>].
        </t>
        <t>
          NOTE: Unless the offerer associates the new suggested offerer BUNDLE address with each
          bundled "m=" line, it can associate unique addresses with any number of bundled "m="
          lines (and the previously selected offerer BUNDLE address to any remaining bundled
          "m=" line) if it wants to suggest multiple alternatives for the new offerer
          BUNDLE address.
        </t>
      </section>
      <section title="Adding a media description to a BUNDLE group" anchor="sec-sdp-oa-mod-add" toc="default">
        <t>
          When an offerer generates an offer, in which it wants to add a bundled "m=" line
          to a BUNDLE group, the offerer MUST:
          <list style="symbols">
          <t>
            Assign a unique address to the added "m=" line; or
          </t>
          <t>
            Assign the previously selected offerer BUNDLE address to the added "m=" line; or
          </t>
          <t>
            If the offerer associates a new (shared address) suggested offerer BUNDLE address with each
            bundled "m=" line [<xref format="default" pageno="false"
            target="sec-sdp-oa-mod-req"/>], also associate that address with the
            added "m=" line.
          </t>
          </list>
        </t>
        <t>
          In addition, the offerer MUST add the identification-tag associated with the added
          "m=" line to the SDP 'group:BUNDLE' attribute identification-tag list with the
          BUNDLE group [<xref format="default" pageno="false" target="sec-sdp-oa-ino-req"/>].
        </t>
        <t>
          NOTE: Assigning a unique address to the "m=" line allows the answerer
          to move the "m=" line out of the BUNDLE group [<xref format="default" pageno="false"
          target="sec-sdp-oa-ans-mov"/>], without having to reject the "m=" line.
        </t>
        <t>
          If the offerer associates a unique address with the added "m=" line, and if the offerer
          suggests that address as the new offerer BUNDLE address [<xref format="default"
          pageno="false" target="sec-sdp-oa-mod-req"/>], the offerer BUNDLE-tag MUST represent
          the added "m=" line [<xref format="default" pageno="false" target="sec-sdp-oa-ino-req"/>].
        </t>
        <t>
          If the offerer associates a new suggested offerer BUNDLE address with each bundled "m=" line
          [<xref format="default" pageno="false" target="sec-sdp-oa-mod-req"/>], including the added
          "m=" line, the offerer BUNDLE-tag MAY represent the added "m=" line
          [<xref format="default" pageno="false" target="sec-sdp-oa-ino-req"/>].
        </t>
        <t>
          [<xref target="sec-example-off-add" pageno="false" format="default"/>]
          shows an example where an offerer sends an offer in order to
          add a bundled "m=" line to a BUNDLE group.
        </t>
      </section>
      <section title="Moving A Media Description Out Of A BUNDLE Group" anchor="sec-sdp-oa-mod-mov" toc="default">
        <t>
          When an offerer generates an offer, in which it wants to move a bundled "m=" line out
          of a BUNDLE group it was added to in a previous offer/answer transaction, the offerer:
          <list style="symbols">
          <t>
            MUST associate a unique address with the "m=" line; and
          </t>
          <t>
            MUST NOT place the identification-tag associated with the "m=" line in
            the SDP 'group:BUNDLE' attribute identification-tag list associated with
            the BUNDLE group.
          </t>
          </list>
        </t>
        <t>
          NOTE: If the removed "m=" line is associated with the previously selected
          BUNDLE-tag, the offerer needs to suggest a new BUNDLE-tag
          [<xref format="default" pageno="false" target="sec-sdp-oa-ino-req"/>].
        </t>
        <t>
          NOTE: If an "m=" line, when being moved out of a BUNDLE group, is added to
          another BUNDLE group, the offerer applies the procedures in
          [<xref target="sec-sdp-oa-mod-add" pageno="false" format="default"/>] to
          the "m=" line.
        </t>
        <t>
          [<xref target="sec-example-off-mov" pageno="false" format="default"/>]
          shows an example of an offer for moving an "m=" line out of a BUNDLE group.
        </t>
      </section>
         <section title="Disabling A Media Description In A BUNDLE Group" anchor="sec-sdp-oa-mod-dis" toc="default">
        <t>
          When an offerer generates an offer, in which it wants to disable a bundled "m=" line (added
          to the BUNDLE group in a previous offer/answer transaction), the offerer:
          <list style="symbols">
            <t>
              MUST associate an address with a zero port value with the "m=" line,
              following the procedures in <xref target="RFC4566" pageno="false"
              format="default"/>; and
            </t>
            <t>
              MUST NOT place the identification-tag associated with the "m=" line in
              the SDP 'group:BUNDLE' attribute identification-tag list associated with
              the BUNDLE group.
            </t>
          </list>
        </t>
        <t>
          [<xref target="sec-example-off-dis" pageno="false" format="default"/>]
          shows an example of an offer for disabling an "m=" line within a
          BUNDLE group.
        </t>
      </section>
    </section>
  </section>

  <section title="Protocol Identification" anchor="sec-protocol-id" toc="default">
    <t>
      Each "m=" line within a BUNDLE group MUST use the same transport-
      layer protocol. If bundled "m=" lines use different protocols on top
      of the transport-layer protocol, there MUST exist a publicly
      available specification which describes a mechanism, for this
      particular protocol combination, how to associate received data
      with the correct protocol.
    </t>
    <t>
      In addition, if received data can be associated with more than
      one bundled "m=" line, there MUST exist a publicly available
      specification which describes a mechanism for associating the
      received data with the correct "m=" line.
    </t>
    <t>
      This document describes a mechanism to identify the
      protocol of received data among the STUN, DTLS and SRTP protocols
      (in any combination), when UDP is used as transport-layer protocol,
      but does not describe how to identify different protocols transported on
      DTLS. While the mechanism is generally applicable to other protocols and
      transport-layer protocols, any such use requires further specification around
      how to multiplex multiple protocols on a given transport-layer protocol,
      and how to associate received data with the correct protocols.
    </t>
    <section anchor="sec-packets-id-sds" title="STUN, DTLS, SRTP" toc="default">
      <t>
        Section 5.1.2 of <xref format="default" pageno="false" target="RFC5764"/> describes a
        mechanism to identify the protocol of a received packet among the STUN, Datagram
        Transport Layer Security (DTLS) and SRTP protocols (in any combination).
        If an offer or answer includes bundled "m=" lines that represent these protocols, the offerer
        or answerer MUST support the mechanism described in <xref format="default" pageno="false"
        target="RFC5764"/>, and no explicit negotiation is required in order to indicate support
        and usage of the mechanism.
      </t>
      <t>
        <xref format="default" pageno="false" target="RFC5764"/> does not describe how to identify
        different protocols transported on DTLS, only how to identify the DTLS protocol itself. If
        multiple protocols are transported on DTLS, there MUST exist a specification describing a
        mechanism for identifying each individual protocol. In addition, if a received DTLS packet
        can be associated with more than one "m=" line, there MUST exist a specification which
        describes a mechanism for associating the received DTLS packet with the correct "m=" line.
      </t>
      <t>
        [<xref format="default" pageno="false" target="sec-rtp-pt"/>] describes how to
        associate the packets in a received SRTP stream with the correct "m=" line.
      </t>
    </section>
  </section>


  <section anchor="sec-rtp" title="RTP Considerations" toc="default">
    <section anchor="sec-rtp-sessions" title="Single RTP Session" toc="default">
          <t>
            All RTP-based media within a single BUNDLE group belong to a
            single RTP session <xref format="default" pageno="false"
            target="RFC3550"/>.
          </t>
          <t>
            Since a single RTP session is used for each bundle group, all
            "m=" lines representing RTP-based media in a bundle group will
            share a single SSRC numbering space <xref format="default"
            pageno="false" target="RFC3550"/>.
          </t>
          <t>
            The following rules and restrictions apply for a single RTP
            session:
          </t>
          <t>
            <list style="symbols">
              <t>
                A specific payload type value can be used in multiple bundled "m=" lines
                only if each codec associated with the payload type number shares an identical
                codec configuration [<xref format="default" pageno="false"
                target="sec-rtp-sessions-pt"/>].
              </t>
              <t>
                The proto value in each bundled RTP-based "m=" line MUST be identical
                (e.g. RTP/AVPF).
              </t>
              <t>
                The RTP MID header extension MUST be enabled, by associating
                an SDP 'extmap' attribute <xref format="default" pageno="false" target="RFC5285"/>,
                with a 'urn:ietf:params:rtp- hdrext:sdes:mid' URI value, with each
                bundled RTP-based "m=" line in every offer and answer.
              </t>
              <t>
                A given SSRC MUST NOT transmit RTP packets using payload types that
                originate from different bundled "m=" lines.
              </t>
            </list>
          </t>
          <t>
            NOTE: The last bullet above is to avoid sending multiple media types
            from the same SSRC. If transmission of multiple media types are done
            with time overlap, RTP and RTCP fail to function. Even if done in
            proper sequence this causes RTP Timestamp rate switching issues
            <xref format="default" pageno="false" target="RFC7160"/>. However,
            once an SSRC has left the RTP session (by sending an RTCP BYE packet),
            that SSRC can be reused by another source (possibly associated
            with a different bundled "m=" line) after a delay of 5 RTCP reporting intervals
            (the delay is to ensure the SSRC has timed out, in case the RTCP BYE
            packet was lost <xref format="default" pageno="false" target="RFC3550"/>).
          </t>
      <section anchor="sec-rtp-sessions-pt" title="Payload Type (PT) Value Reuse" toc="default">
          <t>
            Multiple bundled "m=" lines might represent RTP based media. As all RTP based
            media specified by a BUNDLE group belong to the same RTP session, in order
            for a given payload type value to be used inside more than one bundled "m=" line,
            all codecs associated with the payload type number MUST share an identical codec
            configuration. This means that the codecs MUST share the same media type,
            encoding name, clock rate and any parameter that can affect the codec configuration
            and packetization. <xref format="default" pageno="false"
            target="I-D.ietf-mmusic-sdp-mux-attributes"/> lists SDP attributes, whose attribute
            values must be identical for all codecs that use the same payload type value.
          </t>
      </section>
    </section>

    <section anchor="sec-rtp-pt" title="Associating RTP/RTCP Streams With Correct SDP Media Description" toc="default">
        <t>
          As described in <xref format="default" pageno="false" target="RFC3550"/>, RTP/RTCP packets
          are associated with RTP streams <xref format="default" pageno="false"
          target="RFC7656"/>. Each RTP stream is identified by an SSRC value, and each
          RTP/RTCP packet carries an SSRC value that is used to associate the packet with the correct
          RTP stream (an RTCP packet can carry multiple SSRC values, and might therefore be associated
          with multiple RTP streams).
        </t>
        <t>
          In order to be able to process received RTP/RTCP packets correctly it must be possible
          to associate an RTP stream with the correct "m=" line, as the "m=" line and SDP attributes
          associated with the "m=" line contain information needed to process the packets.
        </t>
        <t>
          As all RTP streams associated with a BUNDLE group are using the same
          address:port combination for sending and receiving RTP/RTCP packets, the
          local address:port combination cannot be used to associate an RTP stream
          with the correct "m=" line. In addition, multiple RTP streams might be
          associated with the same "m=" line.
        </t>
        <t>
          Also, as described in [<xref format="default" pageno="false" target="sec-rtp-sessions-pt"/>],
          the same payload type value might be used by multiple RTP streams, in which case the payload
          type value cannot be used to associate an RTP stream with the correct "m=" line.
        </t>
        <t>
          An offerer and answerer can inform each other which SSRC values they will use
          for an RTP stream by using the SDP 'ssrc' attribute <xref format="default" pageno="false"
          target="RFC5576"/>. However, an offerer will not know which SSRC values the
          answerer will use until the offerer has received the answer providing that information.
          Due to this, before the offerer has received the answer, the offerer will not be
          able to associate an RTP stream with the correct "m=" line using the SSRC value associated
          with the RTP stream. In addition, the offerer and answerer may start using new SSRC
          values mid-session, without informing each other using the SDP 'ssrc' attribute.
        </t>
        <t>
          In order for an offerer and answerer to always be able to associate an RTP stream
          with the correct "m=" line, the offerer and answerer using the BUNDLE extension MUST
          support the mechanism defined in <xref format="default" pageno="false" target="sec-receiver-id"/>,
          where the offerer and answerer insert the identification-tag (provided by the remote peer)
          associated with an "m=" line in RTP and RTCP packets associated with a BUNDLE group.
        </t>
        <t>
          The mapping from an SSRC to an identification-tag is carried in RTCP
          SDES packets or in RTP header extensions (<xref format="default" pageno="false"
          target="sec-receiver-id"/>). Since a compound RTCP packet can contain multiple
          RTCP SDES packets, and each RTCP SDES packet can contain multiple chunks, an
          RTCP packet can contain several SSRC to identification-tag mappings. The offerer
          and answerer maintain tables mapping RTP streams identified by SSRC,
          to m= lines identified by the identification-tag. These tables are
          updated each time an RTP/RTCP packet containing one or more mappings
          from SSRC to identification-tag is received. Note that the mapping
          from SSRC to identification-tag can change at any time during an RTP
          session.

          Once an offerer or answerer recieve an RTP/RTCP packet carrying an identification-tag
          and an SSRC value (an RTCP packet might carry multiple identification-tags and SSRC values), it creates a
          mapping between the SSRC value and the identification-tag, in order to associate the RTP stream
          with the "m=" line associated with the identification-tag. Note that the mapping might
          change mid-session if, for a given SSRC value, a different identification-tag is provided in
          an RTP/RTCP packet.
        </t>
        <t>
          If an offerer and answerer is not able to associate an RTP stream with an "m=" line (using
          the mechanisms described in this section, or using other appropriate mechanism, e.g, based
          on the payload type value if it is unique to a single "m=" line), it MUST either drop the
          RTP/RTCP packets associated with the RTP stream, or process them in an application specific
          manner, once non-stream specific processing (e.g., related to congestion control) of the packets
          have occurred. Note that RTCP packets can report on multiple RTP streams.
        </t>
    </section>

    <section title="RTP/RTCP Multiplexing" anchor="sec-rtprtcp-mux" toc="default">
        <t>
          Within a BUNDLE group, the offerer and answerer MUST enable
          RTP/RTCP multiplexing <xref format="default" pageno="false"
          target="RFC5761"/> for the RTP-based media specified by
          the BUNDLE group.
        </t>
        <t>
          When RTP/RTCP multiplexing is enabled, the same address:port
          combination will be used for sending all RTP packets
          and the RTCP packets associated with the BUNDLE group. Each endpoint
          will send the packets towards the BUNDLE address of the other
          endpoint. The same address:port combination MAY be used
          for receiving RTP packets and RTCP packets.
        </t>
        <section title="SDP Offer/Answer Procedures" anchor="sec-rtprtcp-mux-oa" toc="default">
          <t>
            This section describes how an offerer and answerer use the
            SDP 'rtcp-mux' attribute <xref format="default" pageno="false"
            target="RFC5761"/> and the SDP 'rtcp-mux-only' attribute
            <xref format="default" pageno="false" target="I-D.ietf-mmusic-mux-exclusive"/>
            to negotiate usage of RTP/RTCP multiplexing for RTP-based media specified
            by a BUNDLE group.
          </t>
          <t>
            The procedures in this section only apply to RTP-based "m=" lines.
          </t>
        <section title="Generating the Initial SDP Offer" anchor="sec-rtprtcp-mux-oa-ino" toc="default">
          <t>
            When an offerer generates an initial offer, the
            offerer MUST associate an SDP 'rtcp-mux' attribute
            <xref format="default" pageno="false" target="RFC5761"/>
            with each bundled RTP-based "m=" line in the offer, including
            a bundle-only "m=" line. In addition, the offerer MUST
            associate an SDP 'rtcp-mux-only' attribute
            <xref format="default" pageno="false" target="I-D.ietf-mmusic-mux-exclusive"/>
            with each RTP-based bundle-only "m=" line, and MAY associated an SDP
            'rtcp-mux-only' attribute with other bundled RTP-based "m=" lines.
          </t>
          <t>
            NOTE: Whether the offerer associates an SDP 'rtcp-mux-only' attribute with
            a bundled "m=" line or not depends on whether the offerer supports fallback to
            usage of a separate port for RTCP in case the answerer does not include the
            "m=" line in the BUNDLE group.
          </t>
          <t>
            NOTE: If the offerer associates an SDP 'rtcp-mux' attribute with a bundled "m=" line,
            but does not associate an SDP 'rtcp-mux-only' attribute with the "m=" line, the
            offerer can also associate an SDP 'rtcp' attribute <xref format="default" pageno="false" target="RFC3605"/>
            with the "m=" line in order to provide a fallback port for RTCP, as described
            in <xref format="default" pageno="false" target="RFC5761"/>. However, the fallback
            port will only be used in case the answerer does not include the
            "m=" line in the BUNDLE group.
          </t>
          <t>
            In the initial offer, the address:port combination for RTCP
            MUST be unique in each bundled RTP-based "m=" line (excluding a
            bundle-only "m=" line), similar to RTP.
          </t>
        </section>
        <section title="Generating the SDP Answer" anchor="sec-rtprtcp-mux-oa-ans" toc="default">
          <t>
            When an answerer generates an answer, if the answerer accepts one or more RTP-based
            "m=" lines within a BUNDLE group, the answerer MUST enable usage of RTP/RTCP
            multiplexing. The answerer MUST associate an SDP "rtcp-mux" attribute with
            each RTP-based "m=" line in the answer. In addition, if an "m=" line in the
            corresponding offer contained an SDP "rtcp-mux-only" attribute, the answerer
            MUST associate an SDP "rtcp-mux-only" attribute with the "m=" line in the answer.
          </t>
          <t>
            If an RTP-based "m=" line in the corresponding offer did not contain an
            SDP 'rtcp-mux' attribute, the answerer MUST NOT include the "m=" line within
            a BUNDLE group in the answer.
          </t>
          <t>
            If an RTP-based "m=" line in the corresponding offer contained an
            SDP "rtcp-mux-only" attribute, and if the answerer moves the "m=" line out of
            the BUNDLE group in the answer <xref format="default" pageno="false" target="sec-sdp-oa-ans-mov"/>,
            the answerer MUST still either enable RTP/RTCP multiplexing for the media associated
            with the "m=" line, or reject the "m=" line <xref format="default" pageno="false" target="sec-sdp-oa-ans-rej"/>.
          </t>
          <t>
            The answerer MUST NOT associate an SDP 'rtcp' attribute with any bundled
            "m=" line in the answer. The answerer will use the port value of the selected
            offerer BUNDLE address for sending RTP and RTCP packets associated
            with each RTP-based bundled "m=" line towards the offerer.
          </t>
          <t>
            If the usage of RTP/RTCP multiplexing within a BUNDLE group has been
            negotiated in a previous offer/answer transaction, the answerer MUST
            associate an SDP 'rtcp-mux' attribute with each bundled RTP-based "m=" line
            in the answer.
          </t>
        </section>
        <section title="Offerer Processing of the SDP Answer" anchor="sec-rtprtcp-mux-oa-pra" toc="default">
          <t>
            When an offerer receives an answer, if the answerer has accepted
            the usage of RTP/RTCP multiplexing (see <xref target="sec-rtprtcp-mux-oa-ans"/>),
            the answerer follows the procedures for RTP/RTCP multiplexing defined
            in <xref format="default" pageno="false" target="RFC5761"/>.  The
            offerer will use the port value associated with the answerer
            BUNDLE address for sending RTP and RTCP packets associated with each
            RTP-based bundled "m=" line towards the answerer.
          </t>
          <t>
            NOTE: It is considered a protocol error if the answerer has not
            accepted the usage of RTP/RTCP multiplexing for RTP-based "m=" lines
            that the answerer included in the BUNDLE group.
          </t>
        </section>
        <section title="Modifying the Session" anchor="sec-rtprtcp-mux-oa-mod" toc="default">
          <t>
            When an offerer generates a subsequent offer, for each RTP-based "m=" line
            that was previously added to the BUNDLE group the offerer MUST associate
            an SDP 'rtcp-mux' attribute and an SDP 'rtcp-mux-only' attribute with
            the "m=" line in the same way it was previously done, unless the offerer
            wants to disable or remove the "m=" line from the BUNDLE group.
          </t>
          <t>
            If the offerer wants to add a bundled RTP-based "m=" line
            to the BUNDLE group, it associates an SDP 'rtcp-mux' attribute and
            an SDP 'rtcp-mux-only' attribute with the "m=" line using the procedures in
            [<xref format="default" pageno="false" target="sec-rtprtcp-mux-oa-ino"/>].
          </t>
        </section>
      </section>
    </section>
  </section>

  <section title="ICE Considerations" anchor="sec-ice" toc="default">
      <t>
        This section describes how to use the BUNDLE grouping extension together
        with the Interactive Connectivity Establishment (ICE) mechanism <xref
        format="default" pageno="false" target="I-D.ietf-ice-rfc5245bis"/>.
      </t>
      <t>
        The generic procedures for negotiating usage of ICE using SDP, defined
        in <xref target="I-D.ietf-mmusic-ice-sip-sdp"/>, also apply to usage of ICE
        with BUNDLE, with the following exceptions:
      </t>
      <t>
        <list style="symbols">
          <t>
            When BUNDLE addresses for a BUNDLE group have been selected for both endpoints, ICE
            connectivity checks and keep-alives only need to be performed for the whole BUNDLE group,
            instead of per bundled "m=" line.
          </t>
          <t>
            Among bundled "m=" lines with which the offerer has associated a shared address, the
            offerer only associates ICE-related media-level SDP attributes with the "m=" line
            associated with the offerer BUNDLE-tag.
          </t>
          <t>
            Among bundled "m=" lines with which the answerer has associated a shared address, the
            answerer only associates ICE-related media-level SDP attributes with the "m=" line
            associated with the answerer BUNDLE-tag.
          </t>
        </list>
      </t>
      <t>
        Support and usage of ICE mechanism together with the BUNDLE extension is OPTIONAL.
      </t>

    <section title="SDP Offer/Answer Procedures" anchor="sec-ice-oa" toc="default">
      <t>
        When an offerer associates a unique address with a bundled "m=" line (excluding
        any bundle-only "m=" line), the offerer MUST associate SDP 'candidate' attributes (and
        other applicable ICE-related media-level SDP attributes), containing unique ICE properties
        (candidates etc), with the "m=" line, according to the procedures in <xref target="I-D.ietf-mmusic-ice-sip-sdp" />.
      </t>
      <t>
        When an offerer associates a shared address with a bundled "m=" line, if the
        "m=" line is associated with the offerer BUNDLE-tag, the offerer MUST associate
        SDP 'candidate' attributes (and other applicable ICE-related media-level SDP attributes),
        containing shared ICE properties, with the "m=" line. If the "m=" line is not
        associated with the offerer BUNDLE-tag, the offerer MUST NOT associate
        ICE-related SDP attributes with the "m=" line.
      </t>
      <t>
        When an answerer associates a shared address with a bundled "m=" line, if the
        "m=" line is associated with the answerer BUNDLE-tag, the answerer MUST associate
        SDP 'candidate' attributes (and other applicable ICE-related media-level SDP attributes),
        containing shared ICE properties, with the "m=" line. If the "m=" line is not
        associated with the answerer BUNDLE-tag, the answerer MUST NOT associate
        ICE-related SDP attributes with the "m=" line.
      </t>
      <t>
        NOTE: As most ICE-related media-level SDP attributes belong to the TRANSPORT mux category
        <xref target="I-D.ietf-mmusic-sdp-mux-attributes" />, the offerer and answerer follow the
        rules in <xref format="default" pageno="false" target="sec-sdp-oa-cat"/>. However, in the
        case of ICE-related media-level attributes, the rules apply to all attributes (see note below),
        even if they belong to a different mux category.
      </t>
      <t>
        NOTE: The following ICE-related media-level SDP attributes are defined in
        <xref target="I-D.ietf-mmusic-ice-sip-sdp" />: 'candidiate', 'remote-candidates', 'ice-mismatch',
        'ice-ufrag', 'ice-pwd', and 'ice-pacing'.
      </t>
      <section title="Generating the Initial SDP Offer" anchor="sec-ice-oa-ino" toc="default">
        <t>
          When an offerer generates an initial offer, the offerer MUST associate ICE-related media-level
          SDP attributes with each bundled "m=" line, according to [<xref format="default" pageno="false"
          target="sec-ice-oa"/>].
        </t>
      </section>
      <section title="Generating the SDP Answer" anchor="sec-ice-oa-ans" toc="default">
        <t>
          When an answerer generates an answer that contains a BUNDLE group,
          the answerer MUST associate ICE-related SDP attributes with the
          "m=" line associated with the answerer BUNDLE-tag, according to
          [<xref format="default" pageno="false" target="sec-ice-oa"/>].
        </t>
      </section>
      <section title="Offerer Processing of the SDP Answer" anchor="sec-ice-oa-pra" toc="default">
        <t>
          When an offerer receives an answer, if the answerer supports and uses the ICE
          mechanism and the BUNDLE extension, the offerer MUST associate the ICE properties
          associated with the offerer BUNDLE address, selected by the
          answerer [<xref format="default" pageno="false" target="sec-sdp-oa-ans-off"/>],
          with each bundled "m=" line.
        </t>
      </section>
      <section title="Modifying the Session" anchor="sec-ice-oa-mod" toc="default">
        <t>
          When an offerer generates a subsequent offer, it MUST associate
          unique or shared ICE properties to one or more bundled "m=" lines,
          according to [<xref format="default" pageno="false" target="sec-ice-oa"/>].
        </t>
      </section>
    </section>
    </section>

    <section title="DTLS Considerations" anchor="sec-dtls" toc="default">
      <t>
        One or more media streams within a BUNDLE group might use
        the Datagram Transport Layer Security (DTLS) protocol
        <xref format="default" pageno="false" target="RFC6347"/>
        in order to encrypt the data, or to negotiate encryption keys
        if another encryption mechanism is used to encrypt media.
      </t>
      <t>
        When DTLS is used within a BUNDLE group, the following rules
        apply:
        <list style="symbols">
        <t>
          There can only be one DTLS association
          <xref format="default" pageno="false" target="RFC6347"/>
          associated with the BUNDLE group; and
        </t>
        <t>
          Each usage of the DTLS association within the BUNDLE
          group MUST use the same mechanism for determining
          which endpoints (the offerer or answerer) become
          DTLS client and DTLS server; and
        </t>
        <t>
          Each usage of the DTLS association within the Bundle
          group MUST use the same mechanism for determining
          whether an offer or answer will trigger the
          establishment of a new DTLS association, or whether
          an existing DTLS association will be used; and
        </t>
        <t>
          If the DTLS client supports DTLS-SRTP
          <xref format="default" pageno="false" target="RFC5764"/>
          it MUST include the 'use_srtp' extension
          <xref format="default" pageno="false" target="RFC5764"/>
          in the DTLS ClientHello message
          <xref format="default" pageno="false" target="RFC5764"/>,
          The client MUST include the extension even if the usage
          of DTLS-SRTP is not negotiated as part of the
          multimedia session (e.g., SIP session <xref format="default"
          pageno="false" target="RFC3261"/>.
        </t>
        </list>
      </t>
      <t>
        NOTE: The inclusion of the 'use_srtp' extension during the initial
        DTLS handshake ensures that a DTLS renegotiation will not be required
        in order to include the extension, in case DTLS-SRTP encrypted media
        is added to the BUNDLE group later during the multimedia session.
      </t>
    </section>

  <section anchor="sec-3264" title="Update to RFC 3264" toc="default">
      <t>
        This section replaces the text of the following sections
        of RFC 3264:
      </t>
      <t>
        <list style="symbols">
          <t>Section 5.1 (Unicast Streams).</t>
          <t>Section 8.2 (Removing a Media Stream).</t>
          <t>Section 8.4 (Putting a Unicast Media Stream on Hold).</t>
        </list>
      </t>
    <section anchor="sec-3264-old-5_1" title="Original text of section 5.1 (2nd paragraph) of RFC 3264" toc="default">
      <t>
        For recvonly and sendrecv streams, the port number and address in the
        offer indicate where the offerer would like to receive the media
        stream. For sendonly RTP streams, the address and port number
        indirectly indicate where the offerer wants to receive RTCP reports.
        Unless there is an explicit indication otherwise, reports are sent to
        the port number one higher than the number indicated.  The IP address
        and port present in the offer indicate nothing about the source IP
        address and source port of RTP and RTCP packets that will be sent by
        the offerer. A port number of zero in the offer indicates that the
        stream is offered but MUST NOT be used.  This has no useful semantics
        in an initial offer, but is allowed for reasons of completeness,
        since the answer can contain a zero port indicating a rejected stream
        (Section 6). Furthermore, existing streams can be terminated by
        setting the port to zero (Section 8). In general, a port number of
        zero indicates that the media stream is not wanted.
      </t>
    </section>
    <section anchor="sec-3264-new-5_1" title="New text replacing section 5.1 (2nd paragraph) of RFC 3264" toc="default">
      <t>
        For recvonly and sendrecv streams, the port number and address in the
        offer indicate where the offerer would like to receive the media
        stream. For sendonly RTP streams, the address and port number
        indirectly indicate where the offerer wants to receive RTCP reports.
        Unless there is an explicit indication otherwise, reports are sent to
        the port number one higher than the number indicated. The IP address
        and port present in the offer indicate nothing about the source IP
        address and source port of RTP and RTCP packets that will be sent by
        the offerer. A port number of zero in the offer by default indicates that the
        stream is offered but MUST NOT be used, but an extension mechanism
        might specify different semantics for the usage of a zero port value.
        Furthermore, existing streams can be terminated by setting the port to
        zero (Section 8). In general, a port number of zero by default indicates
        that the media stream is not wanted.
      </t>
    </section>
    <section anchor="sec-3264-old-8_2" title="Original text of section 8.2 (2nd paragraph) of RFC 3264" toc="default">
      <t>
        A stream that is offered with a port of zero MUST be marked with port
        zero in the answer. Like the offer, the answer MAY omit all
        attributes present previously, and MAY list just a single media
        format from amongst those in the offer.
      </t>
    </section>
    <section anchor="sec-3264-new-8_2" title="New text replacing section 8.2 (2nd paragraph) of RFC 3264" toc="default">
      <t>
        A stream that is offered with a port of zero MUST by default be
        marked with port zero in the answer, unless an extension mechanism,
        which specifies semantics for the usage of a non-zero port value, is
        used. If the stream is marked with port zero in the answer, the answer
        MAY omit all attributes present previously, and MAY list
        just a single media format from amongst those in the offer."
      </t>
    </section>
    <section anchor="sec-3264-old-8_4" title="Original text of section 8.4 (6th paragraph) of RFC 3264" toc="default">
      <t>
        RFC 2543 [10] specified that placing a user on hold was accomplished
        by setting the connection address to 0.0.0.0.  Its usage for putting
        a call on hold is no longer recommended, since it doesn't allow for
        RTCP to be used with held streams, doesn't work with IPv6, and breaks
        with connection oriented media.  However, it can be useful in an
        initial offer when the offerer knows it wants to use a particular set
        of media streams and formats, but doesn't know the addresses and
        ports at the time of the offer.  Of course, when used, the port
        number MUST NOT be zero, which would specify that the stream has been
        disabled.  An agent MUST be capable of receiving SDP with a
        connection address of 0.0.0.0, in which case it means that neither
        RTP nor RTCP should be sent to the peer.
      </t>
    </section>
    <section anchor="sec-3264-new-8_4" title="New text replacing section 8.4 (6th paragraph) of RFC 3264" toc="default">
      <t>
        RFC 2543 [10] specified that placing a user on hold was accomplished
        by setting the connection address to 0.0.0.0.  Its usage for putting
        a call on hold is no longer recommended, since it doesn't allow for
        RTCP to be used with held streams, doesn't work with IPv6, and breaks
        with connection oriented media. However, it can be useful in an
        initial offer when the offerer knows it wants to use a particular set
        of media streams and formats, but doesn't know the addresses and
        ports at the time of the offer. Of course, when used, the port
        number MUST NOT be zero, if it would specify that the stream has been
        disabled. However, an extension mechanism might specify different
        semantics of the zero port number usage. An agent MUST be capable
        of receiving SDP with a connection address of 0.0.0.0, in which case it
        means that neither RTP nor RTCP should be sent to the peer.
      </t>
    </section>
  </section>


    <section title="RTP/RTCP extensions for identification-tag transport" anchor="sec-receiver-id" toc="default">
      <t>
        SDP Offerers and Answerers <xref format="default" pageno="false" target="RFC3264"/>
        can associate identification-tags with "m=" lines within SDP Offers
        and Answers, using the procedures in <xref format="default" pageno="false"
        target="RFC5888"/>. Each identification-tag uniquely represents an "m=" line.
      </t>
      <t>
        This section defines a new RTCP SDES item <xref format="default" pageno="false"
        target="RFC3550"/>, 'MID', which is used to carry identification-tags within RTCP
        SDES packets. This section also defines a new RTP SDES header extension
        <xref format="default" pageno="false" target="RFC7941"/>, which
        is used to carry the 'MID' RTCP SDES item in RTP packets.
      </t>
      <t>
        The SDES item and RTP SDES header extension make it possible for a receiver to associate
        each RTP stream with with a specific "m=" line, with which the receiver has
        associated an identification-tag, even if those "m=" lines are part of the same RTP session.
        The RTP SDES header extension also ensures that the media recipient gets the identification-tag
        upon receipt of the first decodable media and is able to associate the media with the
        correct application.
      </t>
      <t>
        A media recipient informs the media sender about the identification-tag
        associated with an "m=" line through the use of an 'mid' attribute
        <xref format="default" pageno="false" target="RFC5888"/>. The media sender then
        inserts the identification-tag in RTCP and RTP packets sent to the media recipient.
      </t>
      <t>
        NOTE: This text above defines how identification-tags are carried in SDP Offers
        and Answers. The usage of other signalling protocols for carrying identification-tags
        is not prevented, but the usage of such protocols is outside the scope of this document.
      </t>
      <t>
        <xref format="default" pageno="false" target="RFC3550"/> defines general procedures
        regarding the RTCP transmission interval. The RTCP MID SDES item SHOULD be sent in
        the first few RTCP packets sent after joining the session, and SHOULD be sent regularly
        thereafter. The exact number of RTCP packets in which this SDES item is sent is
        intentionally not specified here, as it will depend on the expected packet loss
        rate, the RTCP reporting interval, and the allowable overhead.
      </t>
      <t>
        The RTP SDES header extension for carrying the 'MID' RTCP SDES SHOULD be included
        in some RTP packets at the start of the session and whenever the SSRC changes. It might
        also be useful to include the header extension in RTP packets that comprise access points in the media
        (e.g., with video I-frames). The exact number of RTP packets in which this header
        extension is sent is intentionally not specified here, as it will depend on expected
        packet loss rate and loss patterns, the overhead the application can tolerate, and
        the importance of immediate receipt of the identification-tag.
      </t>
      <t>
        For robustness purpose, endpoints need to be prepared for situations where the
        reception of the identification-tag is delayed, and SHOULD NOT terminate sessions
        in such cases, as the identification-tag is likely to arrive soon.
      </t>
    <section title="RTCP MID SDES Item" anchor="sec-receiver-id-sdes-item" toc="default">
       <figure>
         <artwork align="left"><![CDATA[

    0                   1                   2                   3
    0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |      MID=TBD  |     length    | identification-tag          ...
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

          ]]></artwork>
        </figure>
        <t>
          The identification-tag payload is UTF-8 encoded, as in SDP.
        </t>
        <t>
          The identification-tag is not zero terminated.
        </t>
        <t>
          [RFC EDITOR NOTE: Please replace TBD with the assigned SDES
          identifier value.]
        </t>
    </section>
    <section title="RTP SDES Header Extension For MID" anchor="sec-receiver-id-rtp-he" toc="default">
        <t>
          The payload, containing the identification-tag, of the RTP SDES header extension element
          can be encoded using either the one-byte or two-byte header <xref format="default"
          pageno="false" target="RFC7941"/>. The identification-tag payload is UTF-8
          encoded, as in SDP.
        </t>
        <t>
          The identification-tag is not zero terminated. Note, that the set of header extensions
          included in the packet needs to be padded to the next 32-bit boundary using zero
          bytes <xref format="default" pageno="false" target="RFC5285"/>.
        </t>
        <t>
          As the identification-tag is included in either an RTCP SDES item or an RTP SDES header
          extension, or both, there should be some consideration about the packet expansion
          caused by the identification-tag. To avoid Maximum Transmission Unit (MTU) issues
          for the RTP packets, the header extension's size needs to be taken into account when
          encoding the media.
        </t>
        <t>
          It is recommended that the identification-tag is kept short. Due to the properties of
          the RTP header extension mechanism, when using the one-byte header, a tag that is 1-3 bytes
          will result in a minimal number of 32-bit words used for the RTP SDES header extension,
          in case no other header extensions are included at the same time. Note, do take into
          account that some single characters when UTF-8 encoded will result in multiple octets.
          The identification-tag MUST NOT contain any user information, and applications SHALL
          avoid generating the identification-tag using a pattern that enables application
          identification.
        </t>
    </section>
  </section>
  <section title="IANA Considerations" anchor="sec-receiver-id-iana" toc="default">
    <section title="New SDES item" anchor="sec-receiver-id-iana-sdes-item" toc="default">
      <t>
        [RFC EDITOR NOTE: Please replace RFCXXXX with the RFC number
        of this document.]
      </t>
      <t>
        [RFC EDITOR NOTE: Please replace TBD with the assigned SDES
        identifier value.]
      </t>
      <t>
        This document adds the MID SDES item to the IANA "RTP SDES item
        types" registry as follows:
      </t>
      <figure>
        <artwork align="left"><![CDATA[

  Value:     TBD
  Abbrev.:   MID
  Name:      Media Identification
  Reference: RFCXXXX

        ]]></artwork>
      </figure>
    </section>
    <section title="New RTP SDES Header Extension URI" anchor="sec-receiver-id-iana-rtp-uri" toc="default">
      <t>
        [RFC EDITOR NOTE: Please replace RFCXXXX with the RFC number
        of this document.]
      </t>
      <t>
        This document defines a new extension URI in the RTP SDES Compact Header Extensions
        sub-registry of the RTP Compact Header Extensions registry sub-registry, according
        to the following data:
      </t>
      <figure>
        <artwork align="left"><![CDATA[

  Extension URI: urn:ietf:params:rtp-hdrext:sdes:mid
  Description:   Media identification
  Contact:       christer.holmberg@ericsson.com
  Reference:     RFCXXXX

  The SDES item does not reveal privacy information about the users.
  It is simply used to associate RTP-based media with the correct SDP
  media description (m- line) in the SDP used to negotiate the media.

  The purpose of the extension is for the offerer to be able to
  associate received multiplexed RTP-based media before the offerer
  receives the associated SDP answer.

        ]]></artwork>
      </figure>
    </section>
    <section title="New SDP Attribute" anchor="sec-receiver-id-iana-sdp-attribute" toc="default">
      <t>
        [RFC EDITOR NOTE: Please replace RFCXXXX with the RFC number
        of this document.]
      </t>
      <t>
        This document defines a new SDP media-level attribute,
        'bundle-only', according to the following data:
      </t>
      <figure>
        <artwork align="left"><![CDATA[

  Attribute name:     bundle-only
  Type of attribute:  media
  Subject to charset: No
  Purpose:            Request a media description to be accepted
                      in the answer only if kept within a BUNDLE
                      group by the answerer.
  Appropriate values: N/A
  Contact name:       Christer Holmberg
  Contact e-mail:     christer.holmberg@ericsson.com
  Reference:          RFCXXXX
  Mux category:       NORMAL

        ]]></artwork>
      </figure>
    </section>

    <section title="New SDP Group Semantics" anchor="sec-receiver-id-iana-sdp-group-semantics" toc="default">
      <t>
        [RFC EDITOR NOTE: Please replace RFCXXXX with the RFC number
        of this document.]
      </t>
      <t>
        This document registers the following semantics with IANA in the
        "Semantics for the "group" SDP Attribute" subregistry (under the
        "Session Description Protocol (SDP) Parameters" registry:
      </t>
      <figure>
        <artwork align="left"><![CDATA[

    Semantics                              Token   Reference
    -------------------------------------  ------  ---------
    Media bundling                         BUNDLE  [RFCXXXX]

        ]]></artwork>
      </figure>
    </section>
  </section>

    <section title="Security Considerations" anchor="sec-security" toc="default">
    <t>
      The security considerations defined in <xref format="default"
      pageno="false" target="RFC3264"/> and <xref format="default"
      pageno="false" target="RFC5888"/> apply to the BUNDLE
      extension. Bundle does not change which information
      flows over the network but only changes which addresses and
      ports that information is flowing on and thus has very little
      impact on the security of the RTP sessions.
    </t>
    <t>
      When the BUNDLE extension is used, a single set of security credentials
      might be used for all media streams specified by a BUNDLE group.
    </t>
    <t>
      When the BUNDLE extension is used, the number of SSRC values within
      a single RTP session increases, which increases the risk of SSRC
      collision. <xref format="default" pageno="false" target="RFC4568"/>
      describes how SSRC collision may weaken SRTP and SRTCP encryption
      in certain situations.
    </t>
    </section>

  <section title="Examples" anchor="sec-example-alt1" toc="default">
    <section title="Example: Bundle Address Selection" anchor="sec-example-add" toc="default">
      <t>
        The example below shows:
        <list style="symbols">
          <t>An offer, in which the offerer associates a unique address with each bundled "m=" line within the BUNDLE group.</t>
          <t>An answer, in which the answerer selects the offerer BUNDLE address, and then selects its own BUNDLE
          address (the answerer BUNDLE address) and associates it with each bundled "m=" line within the BUNDLE group.</t>
        </list>
      </t>
          <figure>
          <artwork align="left" alt="" height="" name="" type="" width=""
                   xml:space="preserve"><![CDATA[

SDP Offer (1)

    v=0
    o=alice 2890844526 2890844526 IN IP4 atlanta.example.com
    s=
    c=IN IP4 atlanta.example.com
    t=0 0
    a=group:BUNDLE foo bar
    m=audio 10000 RTP/AVP 0 8 97
    b=AS:200
    a=mid:foo
    a=rtcp-mux
    a=rtpmap:0 PCMU/8000
    a=rtpmap:8 PCMA/8000
    a=rtpmap:97 iLBC/8000
    a=extmap 1 urn:ietf:params:rtp-hdrext:sdes:mid
    m=video 10002 RTP/AVP 31 32
    b=AS:1000
    a=mid:bar
    a=rtcp-mux
    a=rtpmap:31 H261/90000
    a=rtpmap:32 MPV/90000
    a=extmap 1 urn:ietf:params:rtp-hdrext:sdes:mid


SDP Answer (2)

    v=0
    o=bob 2808844564 2808844564 IN IP4 biloxi.example.com
    s=
    c=IN IP4 biloxi.example.com
    t=0 0
    a=group:BUNDLE foo bar
    m=audio 20000 RTP/AVP 0
    b=AS:200
    a=mid:foo
    a=rtcp-mux
    a=rtpmap:0 PCMU/8000
    a=extmap 1 urn:ietf:params:rtp-hdrext:sdes:mid
    m=video 20000 RTP/AVP 32
    b=AS:1000
    a=mid:bar
    a=rtcp-mux
    a=rtpmap:32 MPV/90000
    a=extmap 1 urn:ietf:params:rtp-hdrext:sdes:mid


]]></artwork>
        </figure>
    </section>

    <section title="Example: BUNDLE Extension Rejected" anchor="sec-example-bunrej" toc="default">
      <t>
        The example below shows:
        <list style="symbols">
          <t>An offer, in which the offerer associates a unique address with each bundled "m=" line within the BUNDLE group.</t>
          <t>An answer, in which the answerer rejects the offered BUNDLE group, and associates a unique address
          with each "m=" line (following normal RFC 3264 procedures).</t>
        </list>
      </t>
      <figure>
      <artwork align="left" alt="" height="" name="" type="" width=""
                   xml:space="preserve"><![CDATA[

SDP Offer (1)

    v=0
    o=alice 2890844526 2890844526 IN IP4 atlanta.example.com
    s=
    c=IN IP4 atlanta.example.com
    t=0 0
    a=group:BUNDLE foo bar
    m=audio 10000 RTP/AVP 0 8 97
    b=AS:200
    a=mid:foo
    a=rtcp-mux
    a=rtpmap:0 PCMU/8000
    a=rtpmap:8 PCMA/8000
    a=rtpmap:97 iLBC/8000
    a=extmap 1 urn:ietf:params:rtp-hdrext:sdes:mid
    m=video 10002 RTP/AVP 31 32
    b=AS:1000
    a=mid:bar
    a=rtcp-mux
    a=rtpmap:31 H261/90000
    a=rtpmap:32 MPV/90000
    a=extmap 1 urn:ietf:params:rtp-hdrext:sdes:mid


SDP Answer (2)

    v=0
    o=bob 2808844564 2808844564 IN IP4 biloxi.example.com
    s=
    c=IN IP4 biloxi.example.com
    t=0 0
    m=audio 20000 RTP/AVP 0
    b=AS:200
    a=rtcp-mux
    a=rtpmap:0 PCMU/8000
    m=video 30000 RTP/AVP 32
    b=AS:1000
    a=rtcp-mux
    a=rtpmap:32 MPV/90000


      ]]></artwork>
      </figure>
    </section>

    <section title="Example: Offerer Adds A Media Description To A BUNDLE Group" anchor="sec-example-off-add" toc="default">
      <t>
        The example below shows:
        <list style="symbols">
          <t>A subsequent offer (the BUNDLE group has been created as part of a previous offer/answer
          exchange), in which the offerer adds a new "m=" line, represented by the "zen"
          identification-tag, to a previously negotiated BUNDLE group, associates a unique address
          with the added "m=" line, and associates the previously selected offerer BUNDLE address with
          each of the other bundled "m=" lines within the BUNDLE group.</t>
          <t>An answer, in which the answerer associates the answerer BUNDLE address with each
          bundled "m=" line (including the newly added "m=" line) within the BUNDLE group.</t>
        </list>
      </t>
          <figure>
          <artwork align="left" alt="" height="" name="" type="" width=""
                   xml:space="preserve"><![CDATA[

SDP Offer (1)

    v=0
    o=alice 2890844526 2890844526 IN IP4 atlanta.example.com
    s=
    c=IN IP4 atlanta.example.com
    t=0 0
    a=group:BUNDLE foo bar zen
    m=audio 10000 RTP/AVP 0 8 97
    b=AS:200
    a=mid:foo
    a=rtcp-mux
    a=rtpmap:0 PCMU/8000
    a=rtpmap:8 PCMA/8000
    a=rtpmap:97 iLBC/8000
    a=extmap 1 urn:ietf:params:rtp-hdrext:sdes:mid
    m=video 10000 RTP/AVP 31 32
    b=AS:1000
    a=mid:bar
    a=rtcp-mux
    a=rtpmap:31 H261/90000
    a=rtpmap:32 MPV/90000
    a=extmap 1 urn:ietf:params:rtp-hdrext:sdes:mid
    m=video 20000 RTP/AVP 66
    b=AS:1000
    a=mid:zen
    a=rtcp-mux
    a=rtpmap:66 H261/90000
    a=extmap 1 urn:ietf:params:rtp-hdrext:sdes:mid


SDP Answer (2)

    v=0
    o=bob 2808844564 2808844564 IN IP4 biloxi.example.com
    s=
    c=IN IP4 biloxi.example.com
    t=0 0
    a=group:BUNDLE foo bar zen
    m=audio 20000 RTP/AVP 0
    b=AS:200
    a=mid:foo
    a=rtcp-mux
    a=rtpmap:0 PCMU/8000
    a=extmap 1 urn:ietf:params:rtp-hdrext:sdes:mid
    m=video 20000 RTP/AVP 32
    b=AS:1000
    a=mid:bar
    a=rtcp-mux
    a=rtpmap:32 MPV/90000
    a=extmap 1 urn:ietf:params:rtp-hdrext:sdes:mid
    m=video 20000 RTP/AVP 66
    b=AS:1000
    a=mid:zen
    a=rtcp-mux
    a=rtpmap:66 H261/90000
    a=extmap 1 urn:ietf:params:rtp-hdrext:sdes:mid


]]></artwork>
        </figure>
    </section>

    <section title="Example: Offerer Moves A Media Description Out Of A BUNDLE Group" anchor="sec-example-off-mov" toc="default">
      <t>
        The example below shows:
        <list style="symbols">
          <t>A subsequent offer (the BUNDLE group has been created as part of a previous offer/answer
          transaction), in which the offerer moves a bundled "m=" line out of a BUNDLE group, associates a unique address with
          the moved "m=" line, and associates the offerer BUNDLE address with each other bundled "m=" line within the BUNDLE group.</t>
          <t>An answer, in which the answerer moves the "m=" line out of the BUNDLE group, associates a unique address with
          the moved "m=" line, and associates the answerer BUNDLE address with each of the remaining bundled "m=" line within the BUNDLE group.</t>
        </list>
      </t>
          <figure>
          <artwork align="left" alt="" height="" name="" type="" width=""
                   xml:space="preserve"><![CDATA[

SDP Offer (1)

    v=0
    o=alice 2890844526 2890844526 IN IP4 atlanta.example.com
    s=
    c=IN IP4 atlanta.example.com
    t=0 0
    a=group:BUNDLE foo bar
    m=audio 10000 RTP/AVP 0 8 97
    b=AS:200
    a=mid:foo
    a=rtcp-mux
    a=rtpmap:0 PCMU/8000
    a=rtpmap:8 PCMA/8000
    a=rtpmap:97 iLBC/8000
    a=extmap 1 urn:ietf:params:rtp-hdrext:sdes:mid
    m=video 10000 RTP/AVP 31 32
    b=AS:1000
    a=mid:bar
    a=rtcp-mux
    a=rtpmap:31 H261/90000
    a=rtpmap:32 MPV/90000
    a=extmap 1 urn:ietf:params:rtp-hdrext:sdes:mid
    m=video 50000 RTP/AVP 66
    b=AS:1000
    a=mid:zen
    a=rtcp-mux
    a=rtpmap:66 H261/90000


SDP Answer (2)

    v=0
    o=bob 2808844564 2808844564 IN IP4 biloxi.example.com
    s=
    c=IN IP4 biloxi.example.com
    t=0 0
    a=group:BUNDLE foo bar
    m=audio 20000 RTP/AVP 0
    b=AS:200
    a=mid:foo
    a=rtcp-mux
    a=rtpmap:0 PCMU/8000
    a=extmap 1 urn:ietf:params:rtp-hdrext:sdes:mid
    m=video 20000 RTP/AVP 32
    b=AS:1000
    a=mid:bar
    a=rtcp-mux
    a=rtpmap:32 MPV/90000
    a=extmap 1 urn:ietf:params:rtp-hdrext:sdes:mid
    m=video 60000 RTP/AVP 66
    b=AS:1000
    a=mid:zen
    a=rtcp-mux
    a=rtpmap:66 H261/90000


]]></artwork>
        </figure>
    </section>

        <section title="Example: Offerer Disables A Media Description Within A BUNDLE Group" anchor="sec-example-off-dis" toc="default">
      <t>
        The example below shows:
        <list style="symbols">
          <t>A subsequent offer (the BUNDLE group has been created as part of a previous offer/answer
          transaction), in which the offerer disables a bundled "m=" line within a BUNDLE group, assigns a zero port number
          to the disabled "m=" line, and associates the offerer BUNDLE address with each of the other bundled
          "m=" lines within the BUNDLE group.</t>
          <t>An answer, in which the answerer moves the disabled "m=" line out of the BUNDLE group, assigns a zero port value
          to the disabled "m=" line, and associates the answerer BUNDLE address with each of the remaining bundled "m=" line within
          the BUNDLE group.</t>
        </list>
      </t>
          <figure>
          <artwork align="left" alt="" height="" name="" type="" width=""
                   xml:space="preserve"><![CDATA[

SDP Offer (1)

    v=0
    o=alice 2890844526 2890844526 IN IP4 atlanta.example.com
    s=
    c=IN IP4 atlanta.example.com
    t=0 0
    a=group:BUNDLE foo bar
    m=audio 10000 RTP/AVP 0 8 97
    b=AS:200
    a=mid:foo
    a=rtcp-mux
    a=rtpmap:0 PCMU/8000
    a=rtpmap:8 PCMA/8000
    a=rtpmap:97 iLBC/8000
    a=extmap 1 urn:ietf:params:rtp-hdrext:sdes:mid
    m=video 10000 RTP/AVP 31 32
    b=AS:1000
    a=mid:bar
    a=rtcp-mux
    a=rtpmap:31 H261/90000
    a=rtpmap:32 MPV/90000
    a=extmap 1 urn:ietf:params:rtp-hdrext:sdes:mid
    m=video 0 RTP/AVP 66
    a=mid:zen
    a=rtpmap:66 H261/90000


SDP Answer (2)

    v=0
    o=bob 2808844564 2808844564 IN IP4 biloxi.example.com
    s=
    c=IN IP4 biloxi.example.com
    t=0 0
    a=group:BUNDLE foo bar
    m=audio 20000 RTP/AVP 0
    b=AS:200
    a=mid:foo
    a=rtcp-mux
    a=rtpmap:0 PCMU/8000
    a=extmap 1 urn:ietf:params:rtp-hdrext:sdes:mid
    m=video 20000 RTP/AVP 32
    b=AS:1000
    a=mid:bar
    a=rtcp-mux
    a=rtpmap:32 MPV/90000
    a=extmap 1 urn:ietf:params:rtp-hdrext:sdes:mid
    m=video 0 RTP/AVP 66
    a=mid:zen
    a=rtpmap:66 H261/90000


      ]]></artwork>
      </figure>
    </section>
  </section>

  <section anchor="sec-acks" title="Acknowledgements" toc="default">
    <t>
      The usage of the SDP grouping extension for negotiating bundled media is
      based on a similar alternatives proposed by Harald Alvestrand and Cullen
      Jennings. The BUNDLE extension described in this document is based on
      the different alternative proposals, and text (e.g., SDP examples)
      have been borrowed (and, in some cases, modified) from those alternative
      proposals.
    </t>
    <t>
      The SDP examples are also modified versions from the ones in the Alvestrand
      proposal.
    </t>
    <t>
      Thanks to Paul Kyzivat, Martin Thomson, Flemming Andreasen, Thomas Stach,
      Ari Keranen, Adam Roach, Christian Groves, Roman Shpount, Suhas Nandakumar, Nils
      Ohlmeier, Jens Guballa, Raju Makaraju and Justin Uberti for
      reading the text, and providing useful feedback.
    </t>
    <t>
      Thanks to Magnus Westerlund, Colin Perkins and Jonathan Lennox for providing
      help and text on the RTP/RTCP procedures.
    </t>
    <t>
      Thanks to Spotify for providing music for the countless hours of
      document editing.
    </t>
  </section>

  <section title="Change Log">
    <t>[RFC EDITOR NOTE: Please remove this section when publishing]</t>
    <t>Changes from draft-ietf-mmusic-sdp-bundle-negotiation-35
      <list style="symbols">
        <t>Editorial changes on RTP streaming mapping section based on comments from Colin Perkins.</t>
      </list>
    </t>
    <t>Changes from draft-ietf-mmusic-sdp-bundle-negotiation-34
      <list style="symbols">
        <t>RTP streams, instead of RTP packets, are associated with m- lines.</t>
      </list>
    </t>
    <t>Changes from draft-ietf-mmusic-sdp-bundle-negotiation-33
      <list style="symbols">
        <t>Editorial changes based on comments from Eric Rescorla and Cullen Jennings:</t>
        <t>- Changes regarding usage of RTP/RTCP multiplexing attributes.</t>
        <t>- Additional text regarding associating RTP/RTCP packets with SDP m- lines.</t>
        <t>- Reference correction.</t>
      </list>
    </t>
    <t>Changes from draft-ietf-mmusic-sdp-bundle-negotiation-32
      <list style="symbols">
        <t>Editorial changes based on comments from Eric Rescorla and Cullen Jennings:</t>
        <t>- Justification for mechanism added to Introduction.</t>
        <t>- Clarify that the order of m- lines in the group:BUNDLE
          attribute does not have to be the same as the order in which
          the m- lines are listed in the SDP.</t>
      </list>
    </t>
    <t>Changes from draft-ietf-mmusic-sdp-bundle-negotiation-31
      <list style="symbols">
        <t>Editorial changes based on GitHub Pull requests by Martin Thomson:</t>
        <t>- https://github.com/cdh4u/draft-sdp-bundle/pull/2</t>
        <t>- https://github.com/cdh4u/draft-sdp-bundle/pull/1</t>
        <t>Editorial change based on comment from Diederick Huijbers (9th July 2016).</t>
        <t>Changes based on comments from Flemming Andreasen (21st June 2016):</t>
        <t>- Mux category for SDP bundle-only attribute added.</t>
        <t>- Mux category considerations editorial clarification.</t>
        <t>- Editorial changes.</t>
        <t>RTP SDES extension according to draft-ietf-avtext-sdes-hdr-ext.</t>
        <t>Note whether Design Considerations appendix is to be kept removed:</t>
        <t>- Appendix is kept within document.</t>
      </list>
    </t>
    <t>Changes from draft-ietf-mmusic-sdp-bundle-negotiation-30
      <list style="symbols">
        <t>Indicating in the Abstract and Introduction that
        the document updates RFC 3264.</t>
      </list>
    </t>
    <t>Changes from draft-ietf-mmusic-sdp-bundle-negotiation-29
      <list style="symbols">
        <t>Change based on WGLC comment from Colin Perkins.</t>
        <t>- Clarify that SSRC can be reused by another source
             after a delay of 5 RTCP reporting intervals.</t>
        <t>Change based on WGLC comment from Alissa Cooper.</t>
        <t>- IANA registry name fix.</t>
        <t>- Additional IANA registration information added.</t>
      </list>
    </t>
    <t>Changes from draft-ietf-mmusic-sdp-bundle-negotiation-28
      <list style="symbols">
       <t>- Alignment with exclusive mux procedures.</t>
      </list>
    </t>
    <t>Changes from draft-ietf-mmusic-sdp-bundle-negotiation-27
      <list style="symbols">
       <t>- Yet another terminology change.</t>
       <t>- Mux category considerations added.</t>
      </list>
    </t>
    <t>Changes from draft-ietf-mmusic-sdp-bundle-negotiation-26
      <list style="symbols">
        <t>- ICE considerations modified: ICE-related SDP attributes only added
             to the bundled m- line representing the selected BUNDLE address.</t>
        <t>- Reference to draft-ietf-mmusic-ice-sip-sdp added.</t>
        <t>- Reference to RFC 5245 replaced with reference to draft-ietf-ice-rfc5245bis.</t>
      </list>
    </t>
    <t>Changes from draft-ietf-mmusic-sdp-bundle-negotiation-25
      <list style="symbols">
        <t>- RTP/RTCP mux procedures updated with exclusive RTP/RTCP mux considerations.</t>
      </list>
    </t>
    <t>Changes from draft-ietf-mmusic-sdp-bundle-negotiation-24
      <list style="symbols">
        <t>- Reference and procedures associated with exclusive RTP/RTCP mux added</t>
      </list>
    </t>
    <t>Changes from draft-ietf-mmusic-sdp-bundle-negotiation-23
      <list style="symbols">
        <t>- RTCP-MUX mandatory for bundled RTP m- lines</t>
        <t>- Editorial fixes based on comments from Flemming Andreasen</t>
      </list>
    </t>
    <t>Changes from draft-ietf-mmusic-sdp-bundle-negotiation-22
      <list style="symbols">
        <t>- Correction of Ari's family name</t>
        <t>- Editorial fixes based on comments from Thomas Stach</t>
        <t>- RTP/RTCP correction based on comment from Magnus Westerlund</t>
        <t>-- http://www.ietf.org/mail-archive/web/mmusic/current/msg14861.html</t>
      </list>
    </t>
    <t>Changes from draft-ietf-mmusic-sdp-bundle-negotiation-21
      <list style="symbols">
        <t>- Correct based on comment from Paul Kyzivat</t>
        <t>-- 'received packets' replaced with 'received data'</t>
      </list>
    </t>
    <t>Changes from draft-ietf-mmusic-sdp-bundle-negotiation-20
      <list style="symbols">
        <t>- Clarification based on comment from James Guballa</t>
        <t>- Clarification based on comment from Flemming Andreasen</t>
      </list>
    </t>
    <t>Changes from draft-ietf-mmusic-sdp-bundle-negotiation-19
      <list style="symbols">
        <t>- DTLS Considerations section added.</t>
        <t>- BUNDLE semantics added to the IANA Considerations</t>
        <t>- Changes based on WGLC comments from Adam Roach</t>
        <t>-- http://www.ietf.org/mail-archive/web/mmusic/current/msg14673.html</t>
      </list>
    </t>
    <t>Changes from draft-ietf-mmusic-sdp-bundle-negotiation-18
      <list style="symbols">
        <t>- Changes based on agreements at IETF#92</t>
        <t>-- BAS Offer removed, based on agreement at IETF#92.</t>
        <t>-- Procedures regarding usage of SDP "b=" line is replaced with a
        reference to to draft-ietf-mmusic-sdp-mux-attributes.</t>
      </list>
    </t>
    <t>Changes from draft-ietf-mmusic-sdp-bundle-negotiation-17
      <list style="symbols">
        <t>- Editorial changes based on comments from Magnus Westerlund.</t>
      </list>
    </t>
    <t>Changes from draft-ietf-mmusic-sdp-bundle-negotiation-16
      <list style="symbols">
        <t>- Modification of RTP/RTCP multiplexing section, based
        on comments from Magnus Westerlund.</t>
        <t>- Reference updates.</t>
      </list>
    </t>
    <t>Changes from draft-ietf-mmusic-sdp-bundle-negotiation-15
      <list style="symbols">
        <t>- Editorial fix.</t>
      </list>
    </t>
    <t>Changes from draft-ietf-mmusic-sdp-bundle-negotiation-14
      <list style="symbols">
        <t>- Editorial changes.</t>
      </list>
    </t>
    <t>Changes from draft-ietf-mmusic-sdp-bundle-negotiation-13
      <list style="symbols">
        <t>Changes to allow a new suggested offerer BUNDLE address
        to be assigned to each bundled m- line.</t>
        <t>Changes based on WGLC comments from Paul Kyzivat</t>
        <t>- Editorial fixes</t>
      </list>
    </t>
    <t>Changes from draft-ietf-mmusic-sdp-bundle-negotiation-12
      <list style="symbols">
        <t>Usage of SDP 'extmap' attribute added</t>
        <t>SDP 'bundle-only' attribute scoped with "m=" lines with a zero port value</t>
        <t>Changes based on WGLC comments from Thomas Stach</t>
        <t>- ICE candidates not assigned to bundle-only m- lines with a zero port value</t>
        <t>- Editorial changes</t>
        <t>Changes based on WGLC comments from Colin Perkins</t>
        <t>- Editorial changes:</t>
        <t>-- "RTP SDES item" -> "RTCP SDES item"</t>
        <t>-- "RTP MID SDES item" -> "RTCP MID SDES item"</t>
        <t>- Changes in section 10.1.1:</t>
        <t>-- "SHOULD NOT" -> "MUST NOT"</t>
        <t>-- Additional text added to the Note</t>
        <t>- Change to section 13.2:</t>
        <t>-- Clarify that mid value is not zero terminated</t>
        <t>- Change to section 13.3:</t>
        <t>-- Clarify that mid value is not zero terminated</t>
        <t>-- Clarify padding</t>
        <t>Changes based on WGLC comments from Paul Kyzivat</t>
        <t>- Editorial changes:</t>
        <t>Changes based on WGLC comments from Jonathan Lennox</t>
        <t>- Editorial changes:</t>
        <t>- Defintion of SDP bundle-only attribute alligned with
        structure in 4566bis draft</t>
      </list>
    </t>
    <t>Changes from draft-ietf-mmusic-sdp-bundle-negotiation-11
      <list style="symbols">
        <t>Editorial corrections based on comments from Harald Alvestrand.</t>
        <t>Editorial corrections based on comments from Cullen Jennings.</t>
        <t>Reference update (RFC 7160).</t>
        <t>Clarification about RTCP packet sending when RTP/RTCP multiplexing
        is not used (http://www.ietf.org/mail-archive/web/mmusic/current/msg13765.html).</t>
        <t>Additional text added to the Security Considerations.</t>
      </list>
    </t>
    <t>Changes from draft-ietf-mmusic-sdp-bundle-negotiation-10
      <list style="symbols">
        <t>SDP bundle-only attribute added to IANA Considerations.</t>
        <t>SDES item and RTP header extension added to Abstract and Introduction.</t>
        <t>Modification to text updating section 8.2 of RFC 3264.</t>
        <t>Reference corrections.</t>
        <t>Editorial corrections.</t>
      </list>
    </t>
    <t>Changes from draft-ietf-mmusic-sdp-bundle-negotiation-09
      <list style="symbols">
        <t>Terminology change: "bundle-only attribute assigned to m= line" to
        "bundle-only attribute associated with m= line".</t>
        <t>Editorial corrections.</t>
      </list>
    </t>
    <t>Changes from draft-ietf-mmusic-sdp-bundle-negotiation-08
      <list style="symbols">
        <t>Editorial corrections.</t>
        <t>- "of"->"if" (8.3.2.5).</t>
        <t>- "optional"->"OPTIONAL" (9.1).</t>
        <t>- Syntax/ABNF for 'bundle-only' attribute added.</t>
        <t>- SDP Offer/Answer sections merged.</t>
        <t>- 'Request new offerer BUNDLE address' section added</t>
      </list>
    </t>
    <t>Changes from draft-ietf-mmusic-sdp-bundle-negotiation-07
      <list style="symbols">
        <t>OPEN ISSUE regarding Receiver-ID closed.</t>
        <t>- RTP MID SDES Item.</t>
        <t>- RTP MID Header Extension.</t>
        <t>OPEN ISSUE regarding insertion of SDP 'rtcp' attribute in answers closed.</t>
        <t>- Indicating that, when rtcp-mux is used, the answerer MUST NOT include
        an 'rtcp' attribute in the answer, based on the procedures in section 5.1.3 of
        RFC 5761.</t>
      </list>
    </t>
    <t>Changes from draft-ietf-mmusic-sdp-bundle-negotiation-06
      <list style="symbols">
        <t>Draft title changed.</t>
        <t>Added "SDP" to section names containing "Offer" or "Answer".</t>
        <t>Editorial fixes based on comments from Paul Kyzivat (http://www.ietf.org/mail-archive/web/mmusic/current/msg13314.html).</t>
        <t>Editorial fixed based on comments from Colin Perkins (http://www.ietf.org/mail-archive/web/mmusic/current/msg13318.html).</t>
        <t>- Removed text about extending BUNDLE to allow multiple RTP sessions within a BUNDLE group.</t>
      </list>
    </t>
    <t>Changes from draft-ietf-mmusic-sdp-bundle-negotiation-05
      <list style="symbols">
        <t>Major re-structure of SDP Offer/Answer sections, to align with RFC 3264 structure.</t>
        <t>Additional definitions added.</t>
        <t>- Shared address.</t>
        <t>- Bundled "m=" line.</t>
        <t>- Bundle-only "m=" line.</t>
        <t>- Offerer suggested BUNDLE mid.</t>
        <t>- Answerer selected BUNDLE mid.</t>
        <t>Q6 Closed (IETF#88): An Offerer MUST NOT assign a shared address to multiple "m=" lines until it has
        received an SDP Answer indicating support of the BUNDLE extension.</t>
        <t>Q8 Closed (IETF#88): An Offerer can, before it knows whether the Answerer supports the BUNDLE extension,
        assign a zero port value to a 'bundle-only' "m=" line.</t>
        <t>SDP 'bundle-only' attribute section added.</t>
        <t>Connection data nettype/addrtype restrictions added.</t>
        <t>RFC 3264 update section added.</t>
        <t>Indicating that a specific payload type value can be used in multiple "m=" lines, if the value
        represents the same codec configuration in each "m=" line.</t>
      </list>
    </t>
    <t>Changes from draft-ietf-mmusic-sdp-bundle-negotiation-04
      <list style="symbols">
        <t>Updated Offerer procedures (http://www.ietf.org/mail-archive/web/mmusic/current/msg12293.html).</t>
        <t>Updated Answerer procedures (http://www.ietf.org/mail-archive/web/mmusic/current/msg12333.html).</t>
        <t>Usage of SDP 'bundle-only' attribute added.</t>
        <t>Reference to Trickle ICE document added.</t>
      </list>
    </t>
    <t>Changes from draft-ietf-mmusic-sdp-bundle-negotiation-02
      <list style="symbols">
        <t>Mechanism modified, to be based on usage of SDP Offers
        with both different and identical port number values, depending
        on whether it is known if the remote endpoint supports the
        extension.</t>
        <t>Cullen Jennings added as co-author.</t>
      </list>
    </t>
    <t>Changes from draft-ietf-mmusic-sdp-bundle-negotiation-01
      <list style="symbols">
        <t>No changes. New version due to expiration.</t>
      </list>
    </t>
    <t>Changes from draft-ietf-mmusic-sdp-bundle-negotiation-00
      <list style="symbols">
        <t>No changes. New version due to expiration.</t>
      </list>
    </t>
    <t>Changes from draft-holmberg-mmusic-sdp-multiplex-negotiation-00
      <list style="symbols">
        <t>Draft name changed.</t>
        <t>Harald Alvestrand added as co-author.</t>
        <t>"Multiplex" terminology changed to "bundle".</t>
        <t>Added text about single versus multiple RTP Sessions.</t>
        <t>Added reference to RFC 3550.</t>
      </list>
    </t>
  </section>
</middle>

<back>
    <references title="Normative References">
    <?rfc include="reference.RFC.2119"?>
    <?rfc include="reference.RFC.3264"?>
    <?rfc include="reference.RFC.3550"?>
    <?rfc include="reference.RFC.3605"?>
    <?rfc include="reference.RFC.4566"?>
    <?rfc include="reference.RFC.4961"?>
    <?rfc include="reference.RFC.5245"?>
    <?rfc include="reference.RFC.5285"?>
    <?rfc include="reference.RFC.5761"?>
    <?rfc include="reference.RFC.5764"?>
    <?rfc include="reference.RFC.5888"?>
    <?rfc include="reference.RFC.6347"?>
    <?rfc include="reference.RFC.7656"?>
    <?rfc include="reference.RFC.7941"?>
    <?rfc include="reference.I-D.draft-ietf-ice-rfc5245bis-04"?>
    <?rfc include="reference.I-D.draft-ietf-mmusic-sdp-mux-attributes-14"?>
    <?rfc include="reference.I-D.draft-ietf-mmusic-mux-exclusive-10"?>
    <?rfc include="reference.I-D.draft-ietf-mmusic-ice-sip-sdp-10"?>
    </references>

    <references title="Informative References">
    <?rfc include="reference.RFC.3261"?>
    <?rfc include="reference.RFC.4568"?>
    <?rfc include="reference.RFC.5576"?>
    <?rfc include="reference.RFC.7160"?>
    <?rfc include="reference.I-D.draft-ietf-mmusic-trickle-ice-02"?>
    </references>

  <section  title="Design Considerations" toc="default">
      <t>
        One of the main issues regarding the BUNDLE grouping extensions has been whether,
        in SDP Offers and SDP Answers, the same port value should be inserted in "m="
        lines associated with a BUNDLE group, as the purpose of the extension is to negotiate
        the usage of a single address:port combination for media specified by the
        "m=" lines. Issues with both approaches, discussed in the Appendix have been
        raised. The outcome was to specify a mechanism which uses SDP Offers with both
        different and identical port values.
      </t>
      <t>
        Below are the primary issues that have been considered when defining the "BUNDLE"
        grouping extension:
        <list style="symbols">
          <t>1) Interoperability with existing UAs.</t>
          <t>2) Interoperability with intermediary B2BUA- and proxy entities.</t>
          <t>3) Time to gather, and the number of, ICE candidates.</t>
          <t>4) Different error scenarios, and when they occur.</t>
          <t>5) SDP Offer/Answer impacts, including usage of port number value zero.</t>
        </list>
      </t>

    <section  title="UA Interoperability" toc="default">
      <t>
        Consider the following SDP Offer/Answer exchange, where Alice sends an SDP Offer to Bob:
      </t>
      <figure>
        <artwork align="left" alt="" height="" name="" type="" width=""
                   xml:space="preserve"><![CDATA[

SDP Offer

    v=0
    o=alice 2890844526 2890844526 IN IP4 atlanta.example.com
    s=
    c=IN IP4 atlanta.example.com
    t=0 0
    m=audio 10000 RTP/AVP 97
    a=rtpmap:97 iLBC/8000
    m=video 10002 RTP/AVP 97
    a=rtpmap:97 H261/90000


]]></artwork>
      </figure>
      <figure>
        <artwork align="left" alt="" height="" name="" type="" width=""
                   xml:space="preserve"><![CDATA[

SDP Answer

    v=0
    o=bob 2808844564 2808844564 IN IP4 biloxi.example.com
    s=
    c=IN IP4 biloxi.example.com
    t=0 0
    m=audio 20000 RTP/AVP 97
    a=rtpmap:97 iLBC/8000
    m=video 20002 RTP/AVP 97
    a=rtpmap:97 H261/90000

]]></artwork>
      </figure>
      <t>
        RFC 4961 specifies a way of doing symmetric RTP but that is an a later
        invention to RTP and Bob can not assume that Alice supports RFC 4961. This
        means that Alice may be sending RTP from a different port than 10000 or
        10002 - some implementation simply send the RTP from an ephemeral
        port. When Bob's endpoint receives an RTP packet, the only way that Bob
        knows if it should be passed to the video or audio codec is by looking at
        the port it was received on. This lead some SDP implementations to use the
        fact that each "m=" line had a different port number to use that port
        number as an index to find the correct m line in the SDP. As a result, some
        implementations that do support symmetric RTP and ICE still use a SDP data
        structure where SDP with "m=" lines with the same port such as:
      </t>
      <figure>
        <artwork align="left" alt="" height="" name="" type="" width=""
                   xml:space="preserve"><![CDATA[

SDP Offer

    v=0
    o=alice 2890844526 2890844526 IN IP4 atlanta.example.com
    s=
    c=IN IP4 atlanta.example.com
    t=0 0
    m=audio 10000 RTP/AVP 97
    a=rtpmap:97 iLBC/8000
    m=video 10000 RTP/AVP 98
    a=rtpmap:98 H261/90000


]]></artwork>
      </figure>
      <t>
        will result in the second "m=" line being considered an SDP error
        because it has the same port as the first line.
      </t>
    </section>

    <section  title="Usage of port number value zero" toc="default">
      <t>
        In an SDP Offer or SDP Answer, the media specified by an "m=" line can be
        disabled/rejected by setting the port number value to zero. This is different
        from e.g., using the SDP direction attributes, where RTCP traffic will
        continue even if the SDP "inactive" attribute is indicated for the
        associated "m=" line.
      </t>
      <t>
        If each "m=" line associated with a BUNDLE group would contain different
        port values, and one of those port values would be used for a BUNDLE address
        associated with the BUNDLE group, problems would occur if an endpoint wants to
        disable/reject the "m=" line associated with that port, by setting the port
        value to zero. After that, no "m=" line would contain the port value which
        is used for the BUNDLE address.  In addition, it is unclear what would happen
        to the ICE candidates associated with the "m=" line, as they are also used for
        the BUNDLE address.
      </t>
    </section>

    <section  title="B2BUA And Proxy Interoperability" toc="default">
      <t>
        Some back to back user agents may be configured in a mode where if
        the incoming call leg contains an SDP attribute the B2BUA does not
        understand, the B2BUA still generates that SDP attribute in the Offer
        for the outgoing call leg. Consider a B2BUA that did not understand
        the SDP "rtcp" attribute, defined in RFC 3605, yet acted this way.
        Further assume that the B2BUA was configured to tear down any call
        where it did not see any RTCP for 5 minutes. In this case, if the B2BUA
        received an Offer like:
    </t>
    <figure>
      <artwork align="left" alt="" height="" name="" type="" width=""
                   xml:space="preserve"><![CDATA[

SDP Offer

    v=0
    o=alice 2890844526 2890844526 IN IP4 atlanta.example.com
    s=
    c=IN IP4 atlanta.example.com
    t=0 0
    m=audio 49170 RTP/AVP 0
    a=rtcp:53020


]]></artwork>
        </figure>
        <t>
      It would be looking for RTCP on port 49172 but would not see any
      because the RTCP would be on port 53020 and after five minutes, it would
      tear down the call. Similarly, a B2BUA that did not understand BUNDLE yet
      put BUNDLE in it's offer may be looking for media on the wrong port and
      tear down the call. It is worth noting that a B2BUA that generated an
      Offer with capabilities it does not understand is not compliant with the
      specifications.
    </t>

      <section  title="Traffic Policing" toc="default">
        <t>
          Sometimes intermediaries do not act as B2BUA, in the sense that
          they don't modify SDP bodies, nor do they terminate SIP dialogs.
          Still, however, they may use SDP information (e.g., IP address and
          port) in order to control traffic gating functions, and to set
          traffic policing rules. There might be rules which will trigger
          a session to be terminated in case media is not sent or received
          on the ports retrieved from the SDP. This typically occurs once the
          session is already established and ongoing.
        </t>
      </section>
      <section  title="Bandwidth Allocation" toc="default">
        <t>
          Sometimes intermediaries do not act as B2BUA, in the sense that
          they don't modify SDP bodies, nor do they terminate SIP dialogs.
          Still, however, they may use SDP information (e.g., codecs and
          media types) in order to control bandwidth allocation functions.
          The bandwidth allocation is done per "m=" line, which means that
          it might not be enough if media specified by all "m=" lines
          try to use that bandwidth. That may either simply lead to bad
          user experience, or to termination of the call.
        </t>
      </section>
    </section>

    <section  title="Candidate Gathering" toc="default">
      <t>
        When using ICE, a candidate needs to be gathered for each port. This
        takes approximately 20 ms extra for each extra "m=" line due to the NAT
        pacing requirements. All of this gather can be overlapped with other
        things while for exampe a web-page is loading to minimize the impact. If the client
        only wants to generate TURN or STUN ICE candidates for one of the "m="
        lines and then use trickle ICE <xref target="I-D.ietf-mmusic-trickle-ice" />
        to get the non host ICE candidates for the rest of the "m=" lines, it MAY do
        that and will not need any additional gathering time.
      </t>
      <t>
        Some people have suggested a TURN extension to get a bunch of TURN
        allocations at once. This would only provide a single STUN result so in
        cases where the other end did not support BUNDLE, may cause more use of
        the TURN server but would be quick in the cases where both sides
        supported BUNDLE and would fall back to a successful call in the other
        cases.
      </t>
    </section>
    </section>
  </back>
</rfc>
