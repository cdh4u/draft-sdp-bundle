<?xml version="1.0" encoding="iso-8859-1"?>
<!-- comment -->
<!DOCTYPE rfc SYSTEM "rfc2629.dtd"[]>
<?rfc toc="yes" ?>
<?rfc compact="yes" ?>
<?rfc sortrefs="no" ?>
<rfc ipr="pre5378Trust200902" category="std" docName="draft-ietf-mmusic-sdp-bundle-negotiation-36.txt" updates="3264" submissionType="IETF" xml:lang="en">
<front>
    <title abbrev="Bundled media">
    Negotiating Media Multiplexing Using the Session Description Protocol (SDP)
  </title>
    <author initials="C.H." surname="Holmberg" fullname="Christer Holmberg">
    <organization>Ericsson</organization>
    <address>
      <postal>
        <street>Hirsalantie 11</street>
        <code>02420</code>
        <city>Jorvas</city>
        <country>Finland</country>
      </postal>
      <email>christer.holmberg@ericsson.com</email>
    </address>
    </author>

  <author fullname="Harald Tveit Alvestrand" surname="Alvestrand" initials="H. T.">
    <organization>Google</organization>
    <address>
      <postal>
        <street>Kungsbron 2</street>
        <city>Stockholm</city>
        <code>11122</code>
        <country>Sweden</country>
      </postal>
      <email>harald@alvestrand.no</email>
    </address>
    </author>

  <author fullname="Cullen Jennings" initials="C." surname="Jennings">
    <organization>Cisco</organization>
    <address>
      <postal>
        <street>400 3rd Avenue SW, Suite 350</street>
        <city>Calgary</city>
        <region>AB</region>
        <code>T2P 4H2</code>
        <country>Canada</country>
      </postal>
      <email>fluffy@iii.ca</email>
      </address>
    </author>

    <date year="2016" />
    <area>Transport</area>
    <workgroup>MMUSIC Working Group</workgroup>
    <keyword>RTP</keyword>
    <keyword>SDP</keyword>
  <keyword>Bundle</keyword>
    <keyword>Multiplexing</keyword>
    <keyword>RTCWEB</keyword>
  <keyword>CLUE</keyword>
  <keyword>RTCWEB</keyword>
  <keyword>MMUSIC</keyword>
  <keyword>AVT</keyword>
    <keyword>WEB</keyword>
    <keyword>Browser</keyword>

    <abstract>
      <t>
        This specification defines a new Session Description
        Protocol (SDP) Grouping Framework
        extension, 'BUNDLE'. The extension can be used with the
        SDP Offer/Answer mechanism to negotiate the usage of a
        single transport for sending and receiving media,
        referred to as bundled media, specified by multiple
        SDP media descriptions ("m=" sections).
      </t>
      <t>
        To assist endpoints in negotiating the use of bundling, this
        specification defines a new SDP attribute, 'bundle-only',
        which can be used to request that specific media is only
        used if bundled. The specification also updates RFC 3264,
        to allow usage of zero port values without meaning that
        media is rejected.
      </t>
      <t>
        There are multiple ways to correlate the bundled RTP
        packets with the appropriate media descriptions. This
        specification defines a new Real-time Transport Protocol
        (RTP) source description (SDES) item and a new RTP header
        extension that provides an additional way to do this
        correlation by using them to carry a value that
        associates the RTP/RTCP packets with a specific media
        description.
      </t>
    </abstract>
</front>

<middle>
  <section title="Introduction" toc="default">
   <t>
     When multimedia communications are established, each transport reserved for an individual media stream
     consumes additional resources (especially when Interactive Connectivity Establishment (ICE)
     <xref format="default" pageno="false" target="RFC5245"/> is used). For this reason, it is
     attractive to use the same transport for multiple media streams.
  </t>
  <t>
    This specification defines a way to use a single transport for
    sending and receiving media specified by multiple SDP media descriptions ("m=" sections, as
    referred to throughout the remainder of this specification).
  </t>
  <t>
    This specification defines a new SDP Grouping Framework <xref format="default" pageno="false"
    target="RFC5888"/> extension called 'BUNDLE'. The extension can be used with the Session Description
    Protocol (SDP) Offer/Answer mechanism <xref format="default" pageno="false" target="RFC3264"/>
    to negotiate the usage of a BUNDLE group. Within a BUNDLE group, a single BUNDLE transport is used
    for sending and receiving media specified by multiple "m=" sections. This is referred to as bundled media.
  </t>
  <t>
    The offerer and answerer <xref format="default" pageno="false" target="RFC3264"/> use
    the BUNDLE extension to negotiate the attributes of the BUNDLE transport
    to be used for sending and receiving
    the bundled media specified by a BUNDLE group. Once the offerer and the answerer have
    negotiated a BUNDLE group, they can begin to use the same BUNDLE transport to
    send and receive media for all "m=" sections in
    the negotiated BUNDLE group.
  </t>
  <t>
    TODO: The three preceding paragraphs say basically the same thing. Can they be simplified?
  </t>
  <t>
    The mechanisms described in this specification are compatible with media transports that are
    identified by something other than a 5-tuple (source address, source port, destination
    address, destination port, and transport-layer protocol). For example,
    Interactive Connectivity Establishment (ICE) <xref format="default" pageno="false" target="RFC5245"/>,
    which uses relay servers and multiple 5-tuples (candidate pairs) to provide a single media transport,
    where the transport is identified by a combination of local/remote username fragments.
  </t>
  <t>
    This specification also defines a new SDP attribute, 'bundle-only', which can be used to
    request that specific media is only used if kept within a BUNDLE group. The specification
    also updates RFC 3264, to allow usage of zero port values without meaning that media is rejected.
  </t>
  <t>
    As defined in RFC 4566 <xref format="default" pageno="false" target="RFC4566"/>, the
    semantics of assigning the same transport address to multiple
    "m=" sections are undefined, and there is no grouping defined by such means. Instead, an
    explicit grouping mechanism needs to be used to express the intended semantics. This
    specification provides such an extension.
  </t>
  <t>
    This specification also updates sections 5.1, 8.1 and 8.2 of RFC 3264 <xref format="default" pageno="false"
    target="RFC3264"/>. The update allows an answerer to assign a non-zero port value to an "m=" section in an
    SDP answer, even if the "m=" section in the associated SDP offer contained a zero port value.
  </t>
  <t>
    This specification also defines a new Real-time Transport Protocol (RTP) <xref format="default"
    pageno="false" target="RFC3550"/> source description (SDES) item, 'MID', and a new RTP SDES header
    extension that can be used to associate RTP streams with media descriptions.
  </t>
  <t>
    SDP bodies can contain multiple BUNDLE groups. A given BUNDLE transport MUST only be used
    by a single BUNDLE group. The procedures in this specification apply independently to a given
    BUNDLE group. Note that, as defined in <xref format="default" pageno="false" target="RFC7656"/>,
    all RTP based media flows using the same media transport belong to a single
    RTP session <xref format="default" pageno="false" target="RFC3550"/>.
  </t>
  <t>
    The BUNDLE extension is backward compatible. Endpoints that do not support the extension
    are expected to generate offers and answers without an SDP 'group:BUNDLE' attribute, and
    are expected to use distinct transports for each "m=" section within an offer and answer, according
    to the procedures in <xref format="default" pageno="false" target="RFC4566"/> and
    <xref format="default" pageno="false" target="RFC3264"/>
  </t>
  </section>
    <section title="Terminology" toc="default">
    <t>
      "m=" section: SDP bodies contain one or more media descriptions, which are
      delineated by "m=" lines, hence the shorthand '"m=" section'.
    </t>
    <t>
      5-tuple: A collection of the following values: source address, source port, destination
      address, destination port, and transport-layer protocol.
    </t>
    <t>
      Transport: A media transport as defined in
      <xref format="default" pageno="false" target="RFC7656"/>. Most commonly identified by a
      5-tuple, using the address/port from "m=" and "c=" lines, but may be identified by something
      else depending on the protocol(s) being used (e.g., ICE).
    </t>
    <t>
      BUNDLE group: A set of "m=" sections, created using an SDP Offer/Answer
      exchange, that will use (or are being proposed to use) the same transport.
    </t>
    <t>
      BUNDLE transport: The transport shared by all the "m=" sections in a
      BUNDLE group.
    </t>
    <t>
      Offerer BUNDLE-section: The "m=" section in the offer that contains
      attributes used by a BUNDLE transport. May be different than
      the BUNDLE group's answerer BUNDLE-section.
    </t>
    <t>
      Answerer BUNDLE-section: The "m=" section in the answer that contains
      attributes used by a BUNDLE transport. May be different than
      the BUNDLE group's offerer BUNDLE-section.
    </t>
    <t>
      TODO: As the spec is currently written, the offerer BUNDLE-section will
      always be the same as the answerer BUNDLE-section. But people have stated
      otherwise on the mailing list, so I expect this will have to change. See
      other TODO in "Answerer selection of offerer BUNDLE-section".
    </t>
    <t>
      Bundled "m=" section: An "m=" section that is part of a BUNDLE group.
    </t>
    <t>
      Bundle-only "m=" section: An offered bundled "m=" section that will only use
      a BUNDLE transport, not offering fallback to being non-bundled. This is
      implemented using the SDP 'bundle-only' attribute, or the port field
      of the "m=" line.
    </t>
    <t>
      Bundled media: All media sent and received using the same BUNDLE transport.
    </t>
    <t>
      Identification-tag: A unique token value that is used to identify an
      "m=" section. The SDP 'mid' attribute <xref format="default" pageno="false"
      target="RFC5888" />, contained with an "m=" section, is used for this
      purpose. The session-level SDP 'group' attribute
      <xref format="default" pageno="false" target="RFC5888" /> carries a list
      of identification-tags, identifying the "m=" sections contained in that
      particular BUNDLE group.
    </t>
  </section>
    <section title="Conventions" toc="default">
    <t>
      The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT",
      "SHOULD", "SHOULD NOT", "RECOMMENDED", "MAY", and "OPTIONAL" in this
      document are to be interpreted as described in BCP 14, RFC 2119 <xref
      format="default" pageno="false" target="RFC2119" />.
    </t>
    </section>


    <section title="Applicability Statement" toc="default">
    <t>
      The mechanism in this specification only applies to the Session
      Description Protocol (SDP) <xref format="default" pageno="false"
      target="RFC4566"/>, when used together with the SDP offer/answer
      mechanism <xref format="default" pageno="false" target="RFC3264"/>.
      Declarative usage of SDP is out of scope of this document, and is
      thus undefined.
    </t>
    </section>

  <section title="SDP Grouping Framework BUNDLE Extension" anchor="sec-group" toc="default">
    <t>
      This section defines a new SDP Grouping Framework extension
      <xref format="default" pageno="false" target="RFC5888"/>, 'BUNDLE'. The
      BUNDLE extension can be used with the SDP Offer/Answer mechanism to negotiate
      the usage of a single transport for sending and receiving bundled media.
    </t>
    <t>
      The 5-tuple used by this transport
      to send bundled media MAY be the same as the 5-tuple used to receive
      bundled media, depending on whether symmetric RTP <xref format="default" pageno="false"
      target="RFC4961"/> is used.
    </t>
    <t>
      A BUNDLE transport MUST use the same transport-layer protocol (e.g., UDP or TCP)
      for all BUNDLED media.
    </t>
    <t>
      The BUNDLE extension is indicated using an SDP 'group' attribute
      with a "BUNDLE" semantics value <xref format="default" pageno="false"
      target="RFC5888"/>. An identification-tag is used to identify each bundled
      "m=" section, and each identification-tag is listed in the SDP 'group:BUNDLE'
      attribute identification-tag list. Each "m=" section whose identification-tag
      is listed in the identification-tag list is in a
      BUNDLE group.
    </t>
    <t>
      SDP bodies MAY contain multiple BUNDLE groups. Any given bundled "m="
      section MUST NOT be contained in more than one BUNDLE group.
    </t>
    <t>
      NOTE: The order of the identification tags listed in the SDP 'group:BUNDLE' attribute
      identification-tag list does not have to be the same as the order in which
      the corresponding "m=" sections occur in the SDP.
    </t>
    <t>
      <xref target="sec-sdp-oa" pageno="false" format="default"/> defines the
      detailed SDP Offer/Answer procedures for the BUNDLE extension.
    </t>
  </section>

  <section anchor="sec-bundle-only" title="SDP 'bundle-only' Attribute" toc="default">
    <t>
      This section defines a new SDP media-level attribute <xref target="RFC4566" pageno="false"
      format="default"/>, 'bundle-only'. 'bundle-only' is a property attribute
      <xref target="RFC4566" pageno="false" format="default"/>, and hence has no value.
    </t>
    <figure>
      <preamble></preamble>
      <artwork><![CDATA[

   Name: bundle-only

   Value: N/A

   Usage Level: media

   Charset Dependent: no

   Example:

     a=bundle-only

      ]]></artwork>
    </figure>
    <t>
      In order to ensure that an "m=" section will only be used in a BUNDLE group, even if
      communicating with an answerer that does not support the BUNDLE extension,
      the offerer can assign a zero port value to the "m="
      section. According to <xref target="RFC3264" pageno="false" format="default"/> an answerer
      that is not BUNDLE-aware will reject such an "m=" section.
      Thus, by including an SDP 'bundle-only' attribute in such an "m=" section, the offerer can
      force the answerer to accept the "m=" section if and only if the answerer supports the BUNDLE
      extension and agrees to keep the "m=" section in the BUNDLE group.
    </t>
    <t>
      NOTE: Once the answerer agrees to keep an "m=" section in a BUNDLE group, the offerer might
      not need to use the 'bundle-only' attribute in subsequent offers.
      As described in <xref target="sec-sdp-oa-ino" pageno="false" format="default"/>, subsequent offers can accomplish
      the same functionality by not providing a unique address/port for an
      "m=" section, ensuring that the answerer will either keep the "m=" section
      in the BUNDLE group or reject it.
    </t>
    <t>
      The usage of the 'bundle-only' attribute is only defined for a bundled "m=" section with
      a zero port value, within an offer. Other usage is unspecified.
    </t>
    <t>
      <xref target="sec-sdp-oa" pageno="false" format="default"/> defines the detailed SDP
      Offer/Answer procedures for the 'bundle-only' attribute.
    </t>
  </section>

  <section title="SDP Information Considerations" anchor="sec-sdp-cons" toc="default">
      <t>
        This section describes restrictions associated with the usage of
        SDP parameters within a BUNDLE group. It also describes, when parameter
        and attribute values are present in multiple bundled "m=" sections, how to
        choose a value for the BUNDLE transport.
      </t>
    <section title="Connection Data (c=)" anchor="sec-sdp-cons-c" toc="default">
      <t>
        The "c=" line nettype value <xref format="default" pageno="false"
        target="RFC4566"/> in a bundled "m=" section MUST be 'IN'.
      </t>
      <t>
        The "c=" line addrtype value <xref format="default" pageno="false"
        target="RFC4566"/> in a bundled "m=" section MUST be 'IP4' or
        'IP6'. The same value MUST be used in each "m=" section in a given BUNDLE group.
      </t>
      <t>
        NOTE: Extensions to this specification can specify usage of the BUNDLE
        mechanism for other nettype and addrtype values than the ones listed above.
      </t>
    </section>
    <section title="Bandwidth (b=)" anchor="sec-sdp-cons-b" toc="default">
        <t>
        An offerer and answerer MUST use the rules and restrictions defined
        in <xref target="I-D.ietf-mmusic-sdp-mux-attributes" /> for
        using the SDP bandwidth (b=) line in bundled "m=" sections.
      </t>
    </section>
    <section title="Attributes (a=)" anchor="sec-sdp-cons-a" toc="default">
        <t>
        An offerer and answerer MUST use the rules and restrictions defined
        in <xref target="I-D.ietf-mmusic-sdp-mux-attributes" /> for
        using SDP attributes in bundled "m=" sections.
      </t>
    </section>
  </section>

  <section title="SDP Offer/Answer Procedures" anchor="sec-sdp-oa" toc="default">
      <t>
        This section describes the SDP Offer/Answer <xref format="default"
        pageno="false" target="RFC3264"/> procedures for:
        <list style="symbols">
          <t>
            Negotiating and creating a BUNDLE group.
          </t>
          <t>
            Negotiating the properties of the BUNDLE transport.
          </t>
          <t>
            Adding an "m=" section to a BUNDLE group.
          </t>
          <t>
            Moving an "m=" section out of a BUNDLE group.
          </t>
          <t>
            Disabling an "m=" section within a BUNDLE group.
          </t>
        </list>
      </t>
      <t>
        The generic rules and procedures defined in <xref format="default" pageno="false"
        target="RFC3264"/> and <xref format="default" pageno="false" target="RFC5888"/>
        also apply to the BUNDLE extension. For example, if an offer is rejected
        by the answerer, the previously negotiated SDP parameters and characteristics
        (including those associated with a BUNDLE group) apply. Hence, if an offerer
        generates an offer in which the offerer creates a BUNDLE group,
        and the answerer rejects the offer, the BUNDLE group is discarded.
      </t>
      <t>
        The procedures in this section are independent of the media type or
        "m=" section proto value represented by a bundled "m=" section.
        <xref format="default" pageno="false" target="sec-rtp"/> defines additional
        considerations for RTP based media.
        <xref format="default" pageno="false" target="sec-bundle-only"/> defines
        additional considerations for the usage of the SDP 'bundle-only' attribute.
        <xref format="default" pageno="false" target="sec-ice"/> defines additional
        considerations for the usage of Interactive Connectivity Establishment (ICE)
        <xref format="default" pageno="false" target="I-D.ietf-ice-rfc5245bis"/> mechanism.
      </t>
      <t>
        SDP offers and answers can contain multiple BUNDLE groups. The procedures in this
        section apply independently to a given BUNDLE group.
      </t>
        <section anchor="sec-sdp-oa-cat" title="Mux Category Considerations" toc="default">
        <t>
          When an offerer places SDP attributes in a bundled "m=" section,
          and the offerer does not want to offer fallback to a non-BUNDLE transport,
          IDENTICAL and TRANSPORT mux category SDP attributes
          <xref target="I-D.ietf-mmusic-sdp-mux-attributes" /> MUST only be placed in
          the offerer BUNDLE-section for that BUNDLE group (that is, the "m=" section identified
          by the first indentification-tag in the BUNDLE group's 'group' attribute in the offer).
        </t>
        <t>
          When an answerer places SDP attributes in a bundled "m=" section,
          IDENTICAL and TRANSPORT mux category SDP attributes MUST only be placed in
          the answerer BUNDLE-section for that BUNDLE group (that is, the "m=" section identified
          by the first indentification-tag in the BUNDLE group's 'group' attribute in the answer).
        </t>
        <t>
          NOTE: As bundled "m=" sections use the same transport, they also share the same IDENTICAL
          and TRANSPORT mux category SDP attributes and attribute values, so there is no need to
          place such SDP attributes in each "m=" section. The attributes and attribute
          values are implicitly applied to each "m=" section in the BUNDLE group.
        </t>
    </section>
    <section anchor="sec-sdp-oa-ino" title="Generating an SDP Offer that creates a BUNDLE group" toc="default">
        <t>
          When an offerer generates an offer, in order to create a
          BUNDLE group, it MUST:
          <list style="symbols">
            <t>
              Select one "m=" section to be the proposed offerer BUNDLE-section, which will
              carry the offer's BUNDLE transport attributes.
              Generate this "m=" section according to normal procedures. Note that
              the answerer may select a different "m=" section to be the offerer 
              BUNDLE-section.
            </t>
            <t>
              For each other "m=" section in the BUNDLE group:
            </t>
            <list style="symbols">
              <t>
                If the offerer does not wish to offer fallback to a non-BUNDLE transport,
                include a 'bundle-only' attribute in the "m=" section and use a zero port
                value on the "m=" line, omitting IDENTICAL and TRANSPORT category attributes
                as described in <xref target="sec-sdp-oa-cat" pageno="false" format="default"/>.
              </t>
              <t>
                Otherwise, generate the "m=" section according to normal procedures, in addition
                to the restrictions for IDENTICAL category attributes described by
                <xref target="I-D.ietf-mmusic-sdp-mux-attributes" />.
              </t>
              <t>
                TODO: If an "m=" section offers fallback to being non-bundled, should the offerer be
                prepared to receive media for that "m=" section on both the BUNDLE transport and the
                fallback transport? This seems consistent with other specs, but I can't find it
                explicitly stated anywhere. Though, currently an issue preventing this is that the
                answerer gets to select the attributes the offerer will use for the BUNDLE
                transport. If offering three "m=" sections, the media for the third "m=" section
                might arrive on any of the three offered transports.
              </t>
            </list>
            <t>
              Add an SDP 'group:BUNDLE' attribute to the offer.
            </t>
            <t>
              Place the identification-tag of each bundled "m=" section in the
              SDP 'group:BUNDLE' attribute identification-tag list, placing the
              offerer BUNDLE-section's identification-tag first in the list.
            </t>
          </list>
        </t>
        <t>
          NOTE: If the offerer assigns a zero port value to an "m=" section, but does not also include an
          SDP 'bundle-only' attribute in the "m=" section, it is an indication that the offerer wants
          to disable the "m=" section [<xref target="sec-sdp-oa-mod-dis" pageno="false" format="default"/>].
        </t>
        <t>
          [<xref target="sec-example-add" pageno="false" format="default"/>] shows
          an example of an initial offer.
        </t>
      <section title="Suggesting the offerer BUNDLE-section" anchor="sec-sdp-oa-ino-req" toc="default">
        <t>
          In the offer, the offerer BUNDLE-section contains the attributes the offerer
          suggests to use for the BUNDLE transport.
        </t>
        <t>
          The offerer BUNDLE-section MUST NOT contain a zero
          port value or an SDP 'bundle-only' attribute.
        </t>
      </section>
      <section anchor="sec-sdp-oa-ino-ex" title="Example: Initial SDP Offer">
        <t>
          The example shows an initial SDP offer. The offer includes two
          "m=" sections in the SDP, and includes both in
          a BUNDLE group. The audio "m=" section is used as the offerer BUNDLE-section
          (placed first in the SDP group:BUNDLE
          attribute identification-tag list). The video "m=" section does not use a
          'bundle-only' attribute or a zero port value, and so it allows fallback to
          a non-BUNDLE transport, which would use port 10002 instead of port 10000.
        </t>
        <figure>
        <artwork align="left" alt="" height="" name="" type="" width=""
                 xml:space="preserve"><![CDATA[

SDP Offer

  v=0
  o=alice 2890844526 2890844526 IN IP4 atlanta.example.com
  s=
  c=IN IP4 atlanta.example.com
  t=0 0
  a=group:BUNDLE foo bar
  m=audio 10000 RTP/AVP 0 8 97
  b=AS:200
  a=mid:foo
  a=rtcp-mux
  a=rtpmap:0 PCMU/8000
  a=rtpmap:8 PCMA/8000
  a=rtpmap:97 iLBC/8000
  a=extmap 1 urn:ietf:params:rtp-hdrext:sdes:mid
  m=video 10002 RTP/AVP 31 32
  b=AS:1000
  a=mid:bar
  a=rtcp-mux
  a=rtpmap:31 H261/90000
  a=rtpmap:32 MPV/90000
  a=extmap 1 urn:ietf:params:rtp-hdrext:sdes:mid

]]></artwork>
      </figure>
      </section>
    </section>

    <section anchor="sec-sdp-oa-ans" title="Generating an SDP Answer" toc="default">
        <t>This section describes the procedures for generating an answer that contains a
        BUNDLE group. The procedures here apply whether the BUNDLE group was created in the
        corresponding offer (as described in <xref target="sec-sdp-oa-ino" pageno="false" format="default"/>),
        or is being modified after a previous offer/answer exchange (as described in
        <xref target="sec-sdp-oa-mod" pageno="false" format="default"/>).
        <t>
          When an answerer generates an answer that contains a BUNDLE group, the following general
          SDP grouping framework restrictions, defined in <xref target="RFC5888" pageno="false"
          format="default"/>, also apply to the BUNDLE group:
          <list style="symbols">
            <t>
              The answerer MUST NOT include a BUNDLE group in the answer, unless the
              offerer requested the BUNDLE group in the corresponding offer.
            </t>
            <t>
              The answerer MUST NOT include an "m=" section within a BUNDLE group, unless
              the offerer requested the "m=" section to be within that BUNDLE group in the
              corresponding offer.
            </t>
          </list>
        </t>
        <t>
          If the answer contains a BUNDLE group, the answerer MUST:
          <list style="symbols">
            <t>
              Select an offerer BUNDLE-section [<xref target="sec-sdp-oa-ans-off"
              pageno="false" format="default"/>].
            </t>
            <t>
              Add an SDP 'group:BUNDLE' attribute to the answer.
            </t>
            <t>
              Place the identification-tag of each bundled "m=" section in the
              SDP 'group:BUNDLE' attribute identification-tag list, placing the
              selected offerer BUNDLE-section's identification-tag first in the list.
            </t>
          </list>
        </t>
        <t>
          The answerer MAY modify the BUNDLE transport each time it
          generates an answer to an offer, by placing new transport attributes (e.g., "m=" line
          port value) in the answerer BUNDLE-section.
        </t>
        <section title="Removing an 'm=' Section from a BUNDLE group" anchor="sec-sdp-oa-ans-mov" toc="default">
        <t>
          If the answerer does not want to or is not able to keep an "m=" section within a BUNDLE group, it MUST:
          <list style="symbols">
            <t>
              Move the "m=" section out of the BUNDLE group.
              This is only allowed for an "m=" section that
              is not bundle-only; that is, an "m=" section that does not use the 'bundle-only' attribute,
              and that offers a fallback transport distinct from
              the BUNDLE transport.
            </t>
            <t>
              Otherwise, reject the "m=" section by placing a zero port
              in the "m=" field of the "m=" section in the answer, according to the procedures in <xref
              target="RFC3264" pageno="false" format="default"/>.
            </t>
            <t>
              In addition, in either case above, the answerer MUST NOT place the
              identification-tag of the removed "m=" section in the SDP
              'group' attribute identification-tag list of the BUNDLE
              group.
            </t>
          </list>
        </t>
        <t>
          NOTE: If a bundled "m=" section in an offer contains a zero port value, but the "m=" section does not contain
          an SDP 'bundle-only' attribute, it is an indication that the offerer wants to disable the "m="
          section [<xref target="sec-sdp-oa-mod-dis" pageno="false" format="default"/>].
        </t>
        </section>
        <section title="Answerer BUNDLE-section selection" anchor="sec-sdp-oa-ans-off" toc="default">
        <t>
          In an offer, a particular "m=" section is suggested as the offerer BUNDLE-section,
          which contains the offer's BUNDLE transport attributes.
          [<xref target="sec-sdp-oa-ino-req" pageno="false" format="default"/>]. The answerer
          MUST check whether that "m=" section fulfills the following criteria:
          <list style="symbols">
            <t>
              The answerer will not move the "m=" section out of the BUNDLE group in this answer
              [<xref target="sec-sdp-oa-ans-mov" pageno="false" format="default"/>].
            </t>
            <t>
              The answerer will not reject the "m=" section in this answer [<xref target="sec-sdp-oa-ans-rej"
              pageno="false" format="default"/>].
            </t>
            <t>
              The "m=" section does not contain a zero port value.
            </t>
            <t>
              TODO: In the mailing list, we've agreed that if "a=bundle-only" is used, and the
              offerer proposes "Foo" as the offerer BUNDLE-section, the answerer is still allowed to
              reject "Foo". But that's not possible given the above restriction. We need to either
              revise the "answerer selection of offerer BUNDLE-section" logic or remove it. If it
              were removed, that would imply that the offerer BUNDLE-section is always implicitly
              bundle-only. An extra corner-casey situation that whatever we come up with should
              address, as a test case: the offerer wants to offer two "m=" sections with fallback
              to being non-bundled, and two bundle-only "m=" sections. The answerer wants to keep
              the bundle-only "m=" sections in the BUNDLE group, but remove the "m=" sections that
              offer fallback. How does this work? If a bundle-only section requires a zero port,
              then there are only two ports in the offer, but three ports are needed.
            </t>
          </list>
        </t>
        <t>
          If all of the criteria above are fulfilled, the answerer MUST select the proposed
          offerer BUNDLE-section, which will also be used as the answerer BUNDLE-section.
          This answerer MUST place this "m=" section's identification-tag
          first in the identification-tag list of the 'group' attribute.
        </t>
        <t>
          If one or more of the criteria are not fulfilled, the answerer MUST select the next
          identification-tag in the identification-tag list, and perform the same criteria
          check for the "m=" section with that identification-tag. If there are no
          more identification-tags in the identification-tag list, the answerer MUST
          discard the BUNDLE group, by ommitting that group from its answer entirely. In addition, unless the answerer rejects the whole offer,
          the answerer MUST apply the answerer procedures for moving an "m=" section out of a
          BUNDLE group [<xref target="sec-sdp-oa-ans-mov" pageno="false" format="default"/>]
          for each bundled "m=" section in the offer.
        </t>
        <t>
          [<xref target="sec-example-add" pageno="false" format="default"/>] shows an
          example of a BUNDLE-section selection.
        </t>
      </section>
      <section title="Keeping an 'm=' section in a BUNDLE group" anchor="sec-sdp-oa-ans-ans" toc="default">
        <t>
          When an answerer generates an answer that contains a BUNDLE group, it MUST:
          <list style="symbols">
            <t>
              Generate the answerer BUNDLE-section according to normal procedures.
            </t>
            <t>
              Generate each other "m=" section using the same address/port combination as the
              answerer BUNDLE-section, omitting IDENTICAL and TRANSPORT category attributes
              as described in <xref target="sec-sdp-oa-cat" pageno="false" format="default"/>.
            </t>
          </list>
        </t>
        <t>
          The answerer MUST NOT place an SDP 'bundle-only' attribute in any
          "m=" section in an answer.
        </t>
        <t>
          TODO: Earlier we said that the usage of 'bundle-only' in an answer was not defined.
          But now it's explicitly disallowed? Need to make up our minds.
        </t>
        <t>
          NOTE: if the answerer keeps a bundle-only "m=" section within the BUNDLE group,
          it follows the same procedures as
          for any other "m=" section kept within the BUNDLE group.
        </t>
      </section>
      <section title="Example: SDP Answer">
        <t>
          The example shows an SDP answer, based on the SDP offer in
          [<xref target="sec-sdp-oa-ino-ex" pageno="false" format="default"/>].
          The answers accepts both "m=" sections in the BUNDLE group. Note that
          the "rtcp-mux" attribute, being in the IDENTICAL category, is ommitted for
          the video "m=" section, since it's not the answerer BUNDLE-section.
        </t>
        <figure>
        <artwork align="left" alt="" height="" name="" type="" width=""
                 xml:space="preserve"><![CDATA[

SDP Answer

  v=0
  o=bob 2808844564 2808844564 IN IP4 biloxi.example.com
  s=
  c=IN IP4 biloxi.example.com
  t=0 0
  a=group:BUNDLE foo bar
  m=audio 20000 RTP/AVP 0
  b=AS:200
  a=mid:foo
  a=rtcp-mux
  a=rtpmap:0 PCMU/8000
  a=extmap 1 urn:ietf:params:rtp-hdrext:sdes:mid
  m=video 20000 RTP/AVP 32
  b=AS:1000
  a=mid:bar
  a=rtpmap:32 MPV/90000
  a=extmap 1 urn:ietf:params:rtp-hdrext:sdes:mid


]]></artwork>
      </figure>
      </section>
    </section>

    <section anchor="sec-sdp-oa-off-ans" title="Offerer Processing of the SDP Answer" toc="default">
      <t>
        When an offerer receives an answer, if the answer contains a BUNDLE group, the offerer
        MUST check that any bundled "m=" section in the answer was indicated as bundled in the
        corresponding offer. If there is no mismatch, the offerer MUST use the BUNDLE transport,
        defined by the offerer/answerer BUNDLE-sections
        selected by the answerer [<xref format="default" pageno="false" target="sec-sdp-oa-ans-off"/>],
        for each bundled "m=" section.
      </t>
      <t>
        TODO: The "MUST check" part is very incomplete. There are plenty of invalid things that
        aren't being checked for, like shuffling "m=" sections between groups. Can't we just assume
        that an answerer will reject any offer that explicitly violates this specification?
      </t>
      <t>
        NOTE: As the answerer might reject one or more bundled "m=" sections, or move a bundled
        "m=" section out of a BUNDLE group, an "m=" section may be bundled in the offer but
        not the corresponding answer.
      </t>
      <t>
        If the answer does not contain a BUNDLE group, the offerer MUST process the answer
        as a normal answer.
      </t>
    </section>

    <section title="Modifying the Session" anchor="sec-sdp-oa-mod" toc="default">
        <t>
          When an offerer generates a subsequent offer that includes a previously negotiated BUNDLE
          group, it MUST follow the same procedures as when a BUNDLE group is initially created 
          [<xref target="sec-sdp-oa-ino" pageno="false" format="default"/>], but with the following
          differences:
          <list style="symbols">
            <t>
              Instead of using the 'bundle-only' attribute and a zero port value for bundle-only
              "m=" sections, omit the 'bundle-only' attribute and use an address/port that
              matches the offerer BUNDLE-section.
            </t>
            <t>
              TODO: What is the point of this rule? It only complicates things. Why not just keep
              using 'bundle-only' in subsequent offers? Also, this rule is not sufficient for
              media transports that aren't identified by a 5-tuple (such as ICE). Should this
              rule be generalized to such transports? Or should such transports be allowed to
              use "bundle-only" in subsequent offers?
            </t>
          </list>
          <t>
            An "m=" section MAY initially be offered with fallback to a non-BUNDLE transport,
            but subsequently offered as bundle-only, or vice-versa.
          </t>
          <t>
            TODO: Previously, there was a list of conditions that allowed you to offer fallback:
            suggesting a new BUNDLE transport, adding an "m=" section to a BUNDLE group, removing an
            "m=" section from a BUNDLE group, or disabling a bundled "m=" section. Otherwise, it was
            illegal to offer fallback. I don't see the point of this restriction. Do we need it?
          </t>
          <t>
            A subsequent offer MAY suggest a new BUNDLE transport, by placing new transport attributes
            (e.g., "m=" line port value) in the offerer BUNDLE-section.
          </t>
          <t>
            NOTE: Combining the above two MAYs, the offerer can place fallback transport
            parameters in any number of bundled "m="
            sections (and place the previously selected transport parameters in any remaining bundled
            "m=" sections) if it wants to suggest multiple alternatives for the new BUNDLE
            transport.
          </t>
          <t>
            A subsequent offer MAY add "m=" sections to a BUNDLE group and/or remove them. In
            addition, an "m=" section MAY be removed from one BUNDLE group and added to a different
            BUNDLE group in the same offer.
          </t>
          <t>
            TODO: Crazy corner case time. Suppose I'm bundling A and B together in one group,
            and C and D together in a separate group. Now, in a subsequent offer, I start
            bundling A/C together, and B/D together, and at the same time change the transport
            parameters for each BUNDLE group. Depending on the protocols used, it may be
            ambiguous which underlying transport objects are being changed. Basically: is A
            joining C's group, or is C joining A's group? Practical example where this matters:
            ICE. If I change the ufrag/password to do an ICE restart at the same time as I'm
            shuffling "m=" sections, ICE is supposed to send media using the previously selected
            candidate pair until a new pair is formed. But *which* previously selected pair should
            it use for the "A/C" group? The "A/B" group's previously selected pair, or the "C/D"
            group's? The fundamental issue is that there's no reliable way to identify BUNDLE
            groups between subsequent offer/answer exchanges, if this kind of shuffling is allowed.
          </t>
          <t>
            NOTE: If a removed "m=" section was the previously selected offerer BUNDLE-section,
            the offerer needs to suggest a new offerer BUNDLE-section
            [<xref format="default" pageno="false" target="sec-sdp-oa-ino-req"/>].
          </t>
          <t>
            [<xref target="sec-example-off-add" pageno="false" format="default"/>]
            shows an example where an offerer sends an offer in order to
            add a bundled "m=" section to a BUNDLE group.
          </t>
          <t>
            [<xref target="sec-example-off-mov" pageno="false" format="default"/>]
            shows an example of an offer for moving an "m=" section out of a BUNDLE group.
          </t>
          <t>
            [<xref target="sec-example-off-dis" pageno="false" format="default"/>]
            shows an example of an offer for disabling an "m=" section within a
            BUNDLE group.
          </t>
        </t>
      </section>
    </section>
  </section>

  <section title="Protocol Identification" anchor="sec-protocol-id" toc="default">
    <t>
      The BUNDLE transport MUST use the same transport-
      layer protocol for each "m=" section in the BUNDLE group. If bundled "m=" sections use different protocols on top
      of the transport-layer protocol, there MUST exist a publicly
      available specification which describes a mechanism, for this
      particular protocol combination, how to associate received data
      with the correct protocol.
    </t>
    <t>
      In addition, if received data can be associated with more than
      one bundled "m=" section, there MUST exist a publicly available
      specification which describes a mechanism for associating the
      received data with the correct "m=" section.
    </t>
    <t>
      This document describes a mechanism to identify the
      protocol of received data among the STUN, DTLS and SRTP protocols
      (in any combination), when UDP is used as transport-layer protocol,
      but does not describe how to identify different protocols transported on
      DTLS. While the mechanism is generally applicable to other protocols and
      transport-layer protocols, any such use requires further specification around
      how to multiplex multiple protocols on a given transport-layer protocol,
      and how to associate received data with the correct protocols.
    </t>
    <section anchor="sec-packets-id-sds" title="STUN, DTLS, SRTP" toc="default">
      <t>
        Section 5.1.2 of <xref format="default" pageno="false" target="RFC5764"/> describes a
        mechanism to identify the protocol of a received packet among the STUN, Datagram
        Transport Layer Security (DTLS) and SRTP protocols (in any combination).
        If an offer or answer includes bundled "m=" sections that represent these protocols, the offerer
        or answerer MUST support the mechanism described in <xref format="default" pageno="false"
        target="RFC5764"/>, and no explicit negotiation is required in order to indicate support
        and usage of the mechanism.
      </t>
      <t>
        <xref format="default" pageno="false" target="RFC5764"/> does not describe how to identify
        different protocols transported on DTLS, only how to identify the DTLS protocol itself. If
        multiple protocols are transported on DTLS, there MUST exist a specification describing a
        mechanism for identifying each individual protocol. In addition, if a received DTLS packet
        can be associated with more than one "m=" section, there MUST exist a specification which
        describes a mechanism for associating the received DTLS packet with the correct "m=" section.
      </t>
      <t>
        [<xref format="default" pageno="false" target="sec-rtp-pt"/>] describes how to
        associate the packets in a received SRTP stream with the correct "m=" section.
      </t>
    </section>
  </section>


  <section anchor="sec-rtp" title="RTP Considerations" toc="default">
    <section anchor="sec-rtp-sessions" title="Single RTP Session" toc="default">
          <t>
            All RTP-based media using a single BUNDLE transport belong to a
            single RTP session <xref format="default" pageno="false"
            target="RFC3550"/>.
          </t>
          <t>
            Since a single RTP session is used for each bundle group, all
            "m=" sections representing RTP-based media in a bundle group will
            share a single SSRC numbering space <xref format="default"
            pageno="false" target="RFC3550"/>.
          </t>
          <t>
            The following rules and restrictions apply for a single RTP
            session:
          </t>
          <t>
            <list style="symbols">
              <t>
                A specific payload type value can be used in multiple bundled "m=" sections
                only if each codec associated with the payload type number shares an identical
                codec configuration [<xref format="default" pageno="false"
                target="sec-rtp-sessions-pt"/>].
              </t>
              <t>
                The proto value in each bundled RTP-based "m=" section MUST be identical
                (e.g. RTP/AVPF).
              </t>
              <t>
                The RTP MID header extension MUST be enabled, by including
                an SDP 'extmap' attribute <xref format="default" pageno="false" target="RFC5285"/>,
                with an 'urn:ietf:params:rtp- hdrext:sdes:mid' URI value, in each
                bundled RTP-based "m=" section in every offer and answer.
              </t>
              <t>
                A given SSRC MUST NOT transmit RTP packets using payload types that
                originate from different bundled "m=" sections.
              </t>
            </list>
          </t>
          <t>
            NOTE: The last bullet above is to avoid sending multiple media types
            from the same SSRC. If transmission of multiple media types are done
            with time overlap, RTP and RTCP fail to function. Even if done in
            proper sequence this causes RTP Timestamp rate switching issues
            <xref format="default" pageno="false" target="RFC7160"/>. However,
            once an SSRC has left the RTP session (by sending an RTCP BYE packet),
            that SSRC can be reused by another source (possibly associated
            with a different bundled "m=" section) after a delay of 5 RTCP reporting intervals
            (the delay is to ensure the SSRC has timed out, in case the RTCP BYE
            packet was lost <xref format="default" pageno="false" target="RFC3550"/>).
          </t>
      <section anchor="sec-rtp-sessions-pt" title="Payload Type (PT) Value Reuse" toc="default">
          <t>
            Multiple bundled "m=" sections might represent RTP based media. As all RTP based
            media specified by a BUNDLE group belong to the same RTP session, in order
            for a given payload type value to be used inside more than one bundled "m=" section,
            all codecs associated with the payload type number MUST share an identical codec
            configuration. This means that the codecs MUST share the same media type,
            encoding name, clock rate and any parameter that can affect the codec configuration
            and packetization. <xref format="default" pageno="false"
            target="I-D.ietf-mmusic-sdp-mux-attributes"/> lists SDP attributes, whose attribute
            values must be identical for all codecs that use the same payload type value.
          </t>
      </section>
    </section>

    <section anchor="sec-rtp-pt" title="Associating RTP/RTCP Streams With Correct SDP Media Description" toc="default">
        <t>
          As described in <xref format="default" pageno="false" target="RFC3550"/>, RTP/RTCP packets
          are associated with RTP streams <xref format="default" pageno="false"
          target="RFC7656"/>. Each RTP stream is identified by an SSRC value, and each
          RTP/RTCP packet carries an SSRC value that is used to associate the packet with the correct
          RTP stream (an RTCP packet can carry multiple SSRC values, and might therefore be associated
          with multiple RTP streams).
        </t>
        <t>
          In order to be able to process received RTP/RTCP packets correctly it must be possible
          to associate an RTP stream with the correct "m=" section, as the "m=" section and SDP attributes
          in the "m=" section contain information needed to process the packets.
        </t>
        <t>
          As all RTP streams associated with a BUNDLE group are using the same
          transport for sending and receiving RTP/RTCP packets, the
          transport cannot be used to associate an RTP stream
          with the correct "m=" section. In addition, multiple RTP streams might be
          associated with the same "m=" section.
        </t>
        <t>
          Also, as described in [<xref format="default" pageno="false" target="sec-rtp-sessions-pt"/>],
          the same payload type value might be used by multiple RTP streams, in which case the payload
          type value cannot be used to associate an RTP stream with the correct "m=" section.
        </t>
        <t>
          An offerer and answerer can inform each other which SSRC values they will use
          for an RTP stream by using the SDP 'ssrc' attribute <xref format="default" pageno="false"
          target="RFC5576"/>. However, an offerer will not know which SSRC values the
          answerer will use until the offerer has received the answer providing that information.
          Due to this, before the offerer has received the answer, the offerer will not be
          able to associate an RTP stream with the correct "m=" section using the SSRC value associated
          with the RTP stream. In addition, the offerer and answerer may start using new SSRC
          values mid-session, without informing each other using the SDP 'ssrc' attribute.
        </t>
        <t>
          In order for an offerer and answerer to always be able to associate an RTP stream
          with the correct "m=" section, the offerer and answerer using the BUNDLE extension MUST
          support the mechanism defined in <xref format="default" pageno="false" target="sec-receiver-id"/>,
          where the offerer and answerer insert the identification-tag (provided by the remote peer)
          associated with an "m=" section in RTP and RTCP packets associated with a BUNDLE group.
        </t>
        <t>
          The mapping from an SSRC to an identification-tag is carried in RTCP
          SDES packets or in RTP header extensions (<xref format="default" pageno="false"
          target="sec-receiver-id"/>). Since a compound RTCP packet can contain multiple
          RTCP SDES packets, and each RTCP SDES packet can contain multiple chunks, an
          RTCP packet can contain several SSRC to identification-tag mappings. The offerer
          and answerer maintain tables mapping RTP streams identified by SSRC,
          to m= lines identified by the identification-tag. These tables are
          updated each time an RTP/RTCP packet containing one or more mappings
          from SSRC to identification-tag is received. Note that the mapping
          from SSRC to identification-tag can change at any time during an RTP
          session.
        </t>
        <t>
          Once an offerer or answerer recieve an RTP/RTCP packet carrying an identification-tag
          and an SSRC value (an RTCP packet might carry multiple identification-tags and SSRC values), it creates a
          mapping between the SSRC value and the identification-tag, in order to associate the RTP stream
          with the "m=" section associated with the identification-tag. Note that the mapping might
          change mid-session if, for a given SSRC value, a different identification-tag is provided in
          an RTP/RTCP packet.
        </t>
        <t>
          If an offerer and answerer is not able to associate an RTP stream with an "m=" section (using
          the mechanisms described in this section, or using other appropriate mechanism, e.g, based
          on the payload type value if it is unique to a single "m=" section), it MUST either drop the
          RTP/RTCP packets associated with the RTP stream, or process them in an application specific
          manner, once non-stream specific processing (e.g., related to congestion control) of the packets
          has occurred. Note that RTCP packets can report on multiple RTP streams.
        </t>
    </section>

    <section title="RTP/RTCP Multiplexing" anchor="sec-rtprtcp-mux" toc="default">
        <t>
          Within a BUNDLE group, the offerer and answerer MUST enable
          RTP/RTCP multiplexing <xref format="default" pageno="false"
          target="RFC5761"/> for the RTP-based media specified by
          the BUNDLE group.
        </t>
        <t>
          When RTP/RTCP multiplexing is enabled, the same 5-tuple
          will be used for sending all RTP
          and RTCP packets for "m=" sections in the negotiated BUNDLE group.
          The same 5-tuple MAY be used
          for receiving RTP packets and RTCP packets, depending on whether
          symmetric RTP <xref format="default" pageno="false" target="RFC4961"/> is used.
        </t>
        <section title="SDP Offer/Answer Procedures" anchor="sec-rtprtcp-mux-oa" toc="default">
          <t>
            This section describes how an offerer and answerer use the
            SDP 'rtcp-mux' attribute <xref format="default" pageno="false"
            target="RFC5761"/> and the SDP 'rtcp-mux-only' attribute
            <xref format="default" pageno="false" target="I-D.ietf-mmusic-mux-exclusive"/>
            to negotiate usage of RTP/RTCP multiplexing for RTP-based media specified
            by a BUNDLE group.
          </t>
          <t>
            The procedures in this section only apply to RTP-based "m=" sections.
          </t>
        <section title="Generating the Initial SDP Offer" anchor="sec-rtprtcp-mux-oa-ino" toc="default">
          <t>
            When an offerer generates an initial offer, the
            offerer MUST include an SDP 'rtcp-mux' attribute
            <xref format="default" pageno="false" target="RFC5761"/>
            in each bundled RTP-based "m=" section in the offer, including
            any bundle-only "m=" section. In addition, the offerer MUST
            include an SDP 'rtcp-mux-only' attribute
            <xref format="default" pageno="false" target="I-D.ietf-mmusic-mux-exclusive"/>
            in each RTP-based bundle-only "m=" section, and MAY include an SDP
            'rtcp-mux-only' attribute in other bundled RTP-based "m=" sections.
          </t>
          <t>
            NOTE: Whether the offerer includes an SDP 'rtcp-mux-only' attribute in
            a bundled "m=" section or not depends on whether the offerer supports fallback to
            usage of a separate port for RTCP, in case the answerer removes the
            "m=" section from the BUNDLE group.
          </t>
          <t>
            NOTE: If the offerer includes an SDP 'rtcp-mux' attribute in a bundled "m=" section,
            but does not include an SDP 'rtcp-mux-only' attribute in the "m=" section, the
            offerer can also include an SDP 'rtcp' attribute <xref format="default" pageno="false" target="RFC3605"/>
            with the "m=" section in order to provide a fallback port for RTCP, as described
            in <xref format="default" pageno="false" target="RFC5761"/>. However, the fallback
            port will only be used in case the answerer removes the
            "m=" section from the BUNDLE group.
          </t>
          <t>
            In the offer that creates a BUNDLE group, a fallback for non-multiplexed RTCP
            MUST be provided for each bundled RTP-based "m=" section (excluding
            bundle-only "m=" sections).
          </t>
        </section>
        <section title="Generating the SDP Answer" anchor="sec-rtprtcp-mux-oa-ans" toc="default">
          <t>
            When an answerer generates an answer, if the answerer accepts one or more RTP-based
            "m=" sections within a BUNDLE group, the answerer MUST enable usage of RTP/RTCP
            multiplexing. The answerer MUST include an SDP "rtcp-mux" attribute in
            each RTP-based "m=" section in the answer. In addition, if an "m=" section in the
            corresponding offer contained an SDP "rtcp-mux-only" attribute, the answerer
            MUST include an SDP "rtcp-mux-only" attribute in the "m=" section in the answer.
          </t>
          <t>
            If an RTP-based "m=" section in the corresponding offer did not contain an
            SDP 'rtcp-mux' attribute, the answerer MUST remove the "m=" section from
            the BUNDLE group in the answer.
          </t>
          <t>
            If an RTP-based "m=" section in the corresponding offer contained an
            SDP "rtcp-mux-only" attribute, and if the answerer moves the "m=" section out of
            the BUNDLE group in the answer <xref format="default" pageno="false" target="sec-sdp-oa-ans-mov"/>,
            the answerer MUST still either enable RTP/RTCP multiplexing for the media associated
            with the "m=" section, or reject the "m=" section <xref format="default" pageno="false" target="sec-sdp-oa-ans-rej"/>.
          </t>
          <t>
            The answerer MUST NOT include an SDP 'rtcp' attribute in any bundled
            "m=" section in the answer. When RTCP multiplexing is used, this attribute
            is meaningless for an answer.
          </t>
        </section>
        <section title="Offerer Processing of the SDP Answer" anchor="sec-rtprtcp-mux-oa-pra" toc="default">
          <t>
            When an offerer receives an answer, if the answerer has accepted
            the usage of RTP/RTCP multiplexing (see <xref target="sec-rtprtcp-mux-oa-ans"/>),
            the answerer follows the procedures for RTP/RTCP multiplexing defined
            in <xref format="default" pageno="false" target="RFC5761"/>, using the
            negotiated BUNDLE transport.
          </t>
          <t>
            NOTE: It is considered a protocol error if the answerer has not
            accepted the usage of RTP/RTCP multiplexing for RTP-based "m=" sections
            that the answerer included in the BUNDLE group.
          </t>
        </section>
        <section title="Modifying the Session" anchor="sec-rtprtcp-mux-oa-mod" toc="default">
          <t>
            When an offerer generates a subsequent offer, for each RTP-based "m=" section
            that was previously added to the BUNDLE group the offerer MUST include
            an SDP 'rtcp-mux' attribute and an SDP 'rtcp-mux-only' attribute in
            the "m=" section in the same way it was previously done, unless the offerer
            wants to disable or remove the "m=" section from the BUNDLE group.
          </t>
          <t>
            If the offerer wants to add a bundled RTP-based "m=" section
            to the BUNDLE group, it includes an SDP 'rtcp-mux' attribute and
            an SDP 'rtcp-mux-only' attribute in the "m=" section using the procedures in
            [<xref format="default" pageno="false" target="sec-rtprtcp-mux-oa-ino"/>].
          </t>
        </section>
      </section>
    </section>
  </section>
  <section title="ICE Considerations" anchor="sec-ice" toc="default">
      <t>
        This section describes how to use the BUNDLE grouping extension together
        with the Interactive Connectivity Establishment (ICE) mechanism <xref
        format="default" pageno="false" target="I-D.ietf-ice-rfc5245bis"/>.
      </t>
      <t>
        The generic procedures for negotiating usage of ICE using SDP, defined
        in <xref target="I-D.ietf-mmusic-ice-sip-sdp"/>, also apply to usage of ICE
        with BUNDLE, with the following exceptions:
      </t>
      <t>
        <list style="symbols">
          <t>
            When a BUNDLE group is negotiated, the ICE agent MUST only perform processing for
            one media stream representing the entire BUNDLE group, and one component within that
            media stream (given that RTCP multiplexing will also be used). This means that
            connectivity checks and keep-alives only need to be performed for the whole BUNDLE group,
            instead of per bundled "m=" section.
          </t>
        </list>
      </t>
      <t>
        Support and usage of ICE mechanism together with the BUNDLE extension is OPTIONAL.
      </t>
      <t>
        NOTE: ICE uses attributes in the TRANSPORT category, which are subject to the restrictions
        in <xref format="default" pageno="false" target="sec-sdp-oa-cat"/>.
      </t>
    </section>
    </section>

    <section title="DTLS Considerations" anchor="sec-dtls" toc="default">
      <t>
        One or more media streams within a BUNDLE group might use
        the Datagram Transport Layer Security (DTLS) protocol
        <xref format="default" pageno="false" target="RFC6347"/>
        in order to encrypt the data, or to negotiate encryption keys
        if another encryption mechanism is used to encrypt media.
      </t>
      <t>
        When DTLS is used within a BUNDLE group, the following rules
        apply:
        <list style="symbols">
        <t>
          There MUST only be one DTLS association
          <xref format="default" pageno="false" target="RFC6347"/>
          used by the BUNDLE transport.
        </t>
        <t>
          Each usage of the DTLS association within the BUNDLE
          group MUST use the same mechanism for determining
          which endpoints (the offerer or answerer) become
          DTLS client and DTLS server.
        </t>
        <t>
          Each usage of the DTLS association within the BUNDLE
          group MUST use the same mechanism for determining
          whether an offer or answer will trigger the
          establishment of a new DTLS association, or whether
          an existing DTLS association will be used.
        </t>
        <t>
          If the DTLS client supports DTLS-SRTP
          <xref format="default" pageno="false" target="RFC5764"/>
          it MUST include the 'use_srtp' extension
          <xref format="default" pageno="false" target="RFC5764"/>
          in the DTLS ClientHello message
          <xref format="default" pageno="false" target="RFC5764"/>,
          The client MUST include the extension even if the usage
          of DTLS-SRTP is not negotiated as part of the
          multimedia session (e.g., SIP session <xref format="default"
          pageno="false" target="RFC3261"/>.
        </t>
        </list>
      </t>
      <t>
        NOTE: The inclusion of the 'use_srtp' extension during the initial
        DTLS handshake ensures that a DTLS renegotiation will not be required
        in order to include the extension, in case DTLS-SRTP encrypted media
        is added to the BUNDLE group later during the multimedia session.
      </t>
    </section>

  <section anchor="sec-3264" title="Update to RFC 3264" toc="default">
      <t>
        This section replaces the text of the following sections
        of RFC 3264:
      </t>
      <t>
        <list style="symbols">
          <t>Section 5.1 (Unicast Streams).</t>
          <t>Section 8.2 (Removing a Media Stream).</t>
          <t>Section 8.4 (Putting a Unicast Media Stream on Hold).</t>
        </list>
      </t>
    <section anchor="sec-3264-old-5_1" title="Original text of section 5.1 (2nd paragraph) of RFC 3264" toc="default">
      <t>
        For recvonly and sendrecv streams, the port number and address in the
        offer indicate where the offerer would like to receive the media
        stream. For sendonly RTP streams, the address and port number
        indirectly indicate where the offerer wants to receive RTCP reports.
        Unless there is an explicit indication otherwise, reports are sent to
        the port number one higher than the number indicated.  The IP address
        and port present in the offer indicate nothing about the source IP
        address and source port of RTP and RTCP packets that will be sent by
        the offerer. A port number of zero in the offer indicates that the
        stream is offered but MUST NOT be used.  This has no useful semantics
        in an initial offer, but is allowed for reasons of completeness,
        since the answer can contain a zero port indicating a rejected stream
        (Section 6). Furthermore, existing streams can be terminated by
        setting the port to zero (Section 8). In general, a port number of
        zero indicates that the media stream is not wanted.
      </t>
    </section>
    <section anchor="sec-3264-new-5_1" title="New text replacing section 5.1 (2nd paragraph) of RFC 3264" toc="default">
      <t>
        For recvonly and sendrecv streams, the port number and address in the
        offer indicate where the offerer would like to receive the media
        stream. For sendonly RTP streams, the address and port number
        indirectly indicate where the offerer wants to receive RTCP reports.
        Unless there is an explicit indication otherwise, reports are sent to
        the port number one higher than the number indicated. The IP address
        and port present in the offer indicate nothing about the source IP
        address and source port of RTP and RTCP packets that will be sent by
        the offerer. A port number of zero in the offer by default indicates that the
        stream is offered but MUST NOT be used, but an extension mechanism
        might specify different semantics for the usage of a zero port value.
        Furthermore, existing streams can be terminated by setting the port to
        zero (Section 8). In general, a port number of zero by default indicates
        that the media stream is not wanted.
      </t>
    </section>
    <section anchor="sec-3264-old-8_2" title="Original text of section 8.2 (2nd paragraph) of RFC 3264" toc="default">
      <t>
        A stream that is offered with a port of zero MUST be marked with port
        zero in the answer. Like the offer, the answer MAY omit all
        attributes present previously, and MAY list just a single media
        format from amongst those in the offer.
      </t>
    </section>
    <section anchor="sec-3264-new-8_2" title="New text replacing section 8.2 (2nd paragraph) of RFC 3264" toc="default">
      <t>
        A stream that is offered with a port of zero MUST by default be
        marked with port zero in the answer, unless an extension mechanism,
        which specifies semantics for the usage of a non-zero port value, is
        used. If the stream is marked with port zero in the answer, the answer
        MAY omit all attributes present previously, and MAY list
        just a single media format from amongst those in the offer.
      </t>
    </section>
    <section anchor="sec-3264-old-8_4" title="Original text of section 8.4 (6th paragraph) of RFC 3264" toc="default">
      <t>
        RFC 2543 [10] specified that placing a user on hold was accomplished
        by setting the connection address to 0.0.0.0.  Its usage for putting
        a call on hold is no longer recommended, since it doesn't allow for
        RTCP to be used with held streams, doesn't work with IPv6, and breaks
        with connection oriented media.  However, it can be useful in an
        initial offer when the offerer knows it wants to use a particular set
        of media streams and formats, but doesn't know the addresses and
        ports at the time of the offer.  Of course, when used, the port
        number MUST NOT be zero, which would specify that the stream has been
        disabled.  An agent MUST be capable of receiving SDP with a
        connection address of 0.0.0.0, in which case it means that neither
        RTP nor RTCP should be sent to the peer.
      </t>
    </section>
    <section anchor="sec-3264-new-8_4" title="New text replacing section 8.4 (6th paragraph) of RFC 3264" toc="default">
      <t>
        RFC 2543 [10] specified that placing a user on hold was accomplished
        by setting the connection address to 0.0.0.0.  Its usage for putting
        a call on hold is no longer recommended, since it doesn't allow for
        RTCP to be used with held streams, doesn't work with IPv6, and breaks
        with connection oriented media. However, it can be useful in an
        initial offer when the offerer knows it wants to use a particular set
        of media streams and formats, but doesn't know the addresses and
        ports at the time of the offer. Of course, when used, the port
        number MUST NOT be zero, if it would specify that the stream has been
        disabled. However, an extension mechanism might specify different
        semantics of the zero port number usage. An agent MUST be capable
        of receiving SDP with a connection address of 0.0.0.0, in which case it
        means that neither RTP nor RTCP should be sent to the peer.
      </t>
    </section>
  </section>

    <section title="RTP/RTCP extensions for identification-tag transport" anchor="sec-receiver-id" toc="default">
      <t>
        SDP Offerers and Answerers <xref format="default" pageno="false" target="RFC3264"/>
        can uniquely identify "m=" sections with identification-tags within SDP Offers
        and Answers, using the procedures in <xref format="default" pageno="false"
        target="RFC5888"/>.
      </t>
      <t>
        This section defines a new RTCP SDES item <xref format="default" pageno="false"
        target="RFC3550"/>, 'MID', which is used to carry identification-tags within RTCP
        SDES packets. This section also defines a new RTP SDES header extension
        <xref format="default" pageno="false" target="RFC7941"/>, which
        is used to carry the 'MID' RTCP SDES item in RTP packets.
      </t>
      <t>
        The SDES item and RTP SDES header extension make it possible for a receiver to associate
        each RTP stream with with a specific "m=" section, which the receiver has
        identified with an identification-tag, even if those "m=" sections are part of the same RTP session.
        The RTP SDES header extension also ensures that the media recipient gets the identification-tag
        upon receipt of the first decodable media and is able to associate the media with the
        correct application.
      </t>
      <t>
        A media recipient informs the media sender about the identification-tag
        that identifies an "m=" section through the use of an 'mid' attribute
        <xref format="default" pageno="false" target="RFC5888"/>. The media sender then
        inserts the identification-tag in RTCP and RTP packets sent to the media recipient.
      </t>
      <t>
        NOTE: This text above defines how identification-tags are carried in SDP Offers
        and Answers. The usage of other signalling protocols for carrying identification-tags
        is not prevented, but the usage of such protocols is outside the scope of this document.
      </t>
      <t>
        <xref format="default" pageno="false" target="RFC3550"/> defines general procedures
        regarding the RTCP transmission interval. The RTCP MID SDES item SHOULD be sent in
        the first few RTCP packets sent after joining the session, and SHOULD be sent regularly
        thereafter. The exact number of RTCP packets in which this SDES item is sent is
        intentionally not specified here, as it will depend on the expected packet loss
        rate, the RTCP reporting interval, and the allowable overhead.
      </t>
      <t>
        The RTP SDES header extension for carrying the 'MID' RTCP SDES SHOULD be included
        in some RTP packets at the start of the session and whenever the SSRC changes. It might
        also be useful to include the header extension in RTP packets that comprise access points in the media
        (e.g., with video I-frames). The exact number of RTP packets in which this header
        extension is sent is intentionally not specified here, as it will depend on expected
        packet loss rate and loss patterns, the overhead the application can tolerate, and
        the importance of immediate receipt of the identification-tag.
      </t>
      <t>
        For robustness purposes, endpoints need to be prepared for situations where the
        reception of the identification-tag is delayed, and SHOULD NOT terminate sessions
        in such cases, as the identification-tag is likely to arrive soon.
      </t>
    <section title="RTCP MID SDES Item" anchor="sec-receiver-id-sdes-item" toc="default">
       <figure>
         <artwork align="left"><![CDATA[

    0                   1                   2                   3
    0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |      MID=TBD  |     length    | identification-tag          ...
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

          ]]></artwork>
        </figure>
        <t>
          The identification-tag payload is UTF-8 encoded, as in SDP.
        </t>
        <t>
          The identification-tag is not zero terminated.
        </t>
        <t>
          [RFC EDITOR NOTE: Please replace TBD with the assigned SDES
          identifier value.]
        </t>
    </section>
    <section title="RTP SDES Header Extension For MID" anchor="sec-receiver-id-rtp-he" toc="default">
        <t>
          The payload, containing the identification-tag, of the RTP SDES header extension element
          can be encoded using either the one-byte or two-byte header <xref format="default"
          pageno="false" target="RFC7941"/>. The identification-tag payload is UTF-8
          encoded, as in SDP.
        </t>
        <t>
          The identification-tag is not zero terminated. Note, that the set of header extensions
          included in the packet needs to be padded to the next 32-bit boundary using zero
          bytes <xref format="default" pageno="false" target="RFC5285"/>.
        </t>
        <t>
          As the identification-tag is included in either an RTCP SDES item or an RTP SDES header
          extension, or both, there should be some consideration about the packet expansion
          caused by the identification-tag. To avoid Maximum Transmission Unit (MTU) issues
          for the RTP packets, the header extension's size needs to be taken into account when
          encoding the media.
        </t>
        <t>
          It is recommended that the identification-tag is kept short. Due to the properties of
          the RTP header extension mechanism, when using the one-byte header, a tag that is 1-3 bytes
          will result in a minimal number of 32-bit words used for the RTP SDES header extension,
          in case no other header extensions are included at the same time. Note, do take into
          account that some single characters when UTF-8 encoded will result in multiple octets.
          The identification-tag MUST NOT contain any user information, and applications SHALL
          avoid generating the identification-tag using a pattern that enables application
          identification.
        </t>
    </section>
  </section>
  <section title="IANA Considerations" anchor="sec-receiver-id-iana" toc="default">
    <section title="New SDES item" anchor="sec-receiver-id-iana-sdes-item" toc="default">
      <t>
        [RFC EDITOR NOTE: Please replace RFCXXXX with the RFC number
        of this document.]
      </t>
      <t>
        [RFC EDITOR NOTE: Please replace TBD with the assigned SDES
        identifier value.]
      </t>
      <t>
        This document adds the MID SDES item to the IANA "RTP SDES item
        types" registry as follows:
      </t>
      <figure>
        <artwork align="left"><![CDATA[

  Value:     TBD
  Abbrev.:   MID
  Name:      Media Identification
  Reference: RFCXXXX

        ]]></artwork>
      </figure>
    </section>
    <section title="New RTP SDES Header Extension URI" anchor="sec-receiver-id-iana-rtp-uri" toc="default">
      <t>
        [RFC EDITOR NOTE: Please replace RFCXXXX with the RFC number
        of this document.]
      </t>
      <t>
        This document defines a new extension URI in the RTP SDES Compact Header Extensions
        sub-registry of the RTP Compact Header Extensions registry sub-registry, according
        to the following data:
      </t>
      <figure>
        <artwork align="left"><![CDATA[

  Extension URI: urn:ietf:params:rtp-hdrext:sdes:mid
  Description:   Media identification
  Contact:       christer.holmberg@ericsson.com
  Reference:     RFCXXXX

  The SDES item does not reveal privacy information about the users.
  It is simply used to associate RTP-based media with the correct SDP
  media description ("m=" section) in the SDP used to negotiate the media.

  The purpose of the extension is for the offerer to be able to
  associate received multiplexed RTP-based media before the offerer
  receives the associated SDP answer.

        ]]></artwork>
      </figure>
    </section>
    <section title="New SDP Attribute" anchor="sec-receiver-id-iana-sdp-attribute" toc="default">
      <t>
        [RFC EDITOR NOTE: Please replace RFCXXXX with the RFC number
        of this document.]
      </t>
      <t>
        This document defines a new SDP media-level attribute,
        'bundle-only', according to the following data:
      </t>
      <figure>
        <artwork align="left"><![CDATA[

  Attribute name:     bundle-only
  Type of attribute:  media
  Subject to charset: No
  Purpose:            Request a media description to be accepted
                      in the answer only if kept within a BUNDLE
                      group by the answerer.
  Appropriate values: N/A
  Contact name:       Christer Holmberg
  Contact e-mail:     christer.holmberg@ericsson.com
  Reference:          RFCXXXX
  Mux category:       NORMAL

        ]]></artwork>
      </figure>
    </section>

    <section title="New SDP Group Semantics" anchor="sec-receiver-id-iana-sdp-group-semantics" toc="default">
      <t>
        [RFC EDITOR NOTE: Please replace RFCXXXX with the RFC number
        of this document.]
      </t>
      <t>
        This document registers the following semantics with IANA in the
        "Semantics for the "group" SDP Attribute" subregistry (under the
        "Session Description Protocol (SDP) Parameters" registry:
      </t>
      <figure>
        <artwork align="left"><![CDATA[

    Semantics                              Token   Reference
    -------------------------------------  ------  ---------
    Media bundling                         BUNDLE  [RFCXXXX]

        ]]></artwork>
      </figure>
    </section>
  </section>

    <section title="Security Considerations" anchor="sec-security" toc="default">
    <t>
      The security considerations defined in <xref format="default"
      pageno="false" target="RFC3264"/> and <xref format="default"
      pageno="false" target="RFC5888"/> apply to the BUNDLE
      extension. Bundling does not change which information
      flows over the network but only changes which transports
      that information is flowing on and thus has very little
      impact on the security of the RTP sessions.
    </t>
    <t>
      When the BUNDLE extension is used, a single set of security credentials
      might be used for all media streams specified by a BUNDLE group.
    </t>
    <t>
      When the BUNDLE extension is used, the number of SSRC values within
      a single RTP session increases, which increases the risk of SSRC
      collision. <xref format="default" pageno="false" target="RFC4568"/>
      describes how SSRC collision may weaken SRTP and SRTCP encryption
      in certain situations.
    </t>
    </section>

  <section title="Examples" anchor="sec-example-alt1" toc="default">
    <section title="Example: Bundle Address Selection" anchor="sec-example-add" toc="default">
      <t>
        The example below shows:
        <list style="symbols">
          <t>An offer, in which the offerer places a unique address/port combination in each bundled "m=" section within the BUNDLE group.</t>
          <t>An answer, in which the answerer selects the offerer BUNDLE address, and then selects its own BUNDLE
          transport address/port and places it in each bundled "m=" section within the BUNDLE group.</t>
        </list>
      </t>
          <figure>
          <artwork align="left" alt="" height="" name="" type="" width=""
                   xml:space="preserve"><![CDATA[

SDP Offer (1)

    v=0
    o=alice 2890844526 2890844526 IN IP4 atlanta.example.com
    s=
    c=IN IP4 atlanta.example.com
    t=0 0
    a=group:BUNDLE foo bar
    m=audio 10000 RTP/AVP 0 8 97
    b=AS:200
    a=mid:foo
    a=rtcp-mux
    a=rtpmap:0 PCMU/8000
    a=rtpmap:8 PCMA/8000
    a=rtpmap:97 iLBC/8000
    a=extmap 1 urn:ietf:params:rtp-hdrext:sdes:mid
    m=video 10002 RTP/AVP 31 32
    b=AS:1000
    a=mid:bar
    a=rtcp-mux
    a=rtpmap:31 H261/90000
    a=rtpmap:32 MPV/90000
    a=extmap 1 urn:ietf:params:rtp-hdrext:sdes:mid


SDP Answer (2)

    v=0
    o=bob 2808844564 2808844564 IN IP4 biloxi.example.com
    s=
    c=IN IP4 biloxi.example.com
    t=0 0
    a=group:BUNDLE foo bar
    m=audio 20000 RTP/AVP 0
    b=AS:200
    a=mid:foo
    a=rtcp-mux
    a=rtpmap:0 PCMU/8000
    a=extmap 1 urn:ietf:params:rtp-hdrext:sdes:mid
    m=video 20000 RTP/AVP 32
    b=AS:1000
    a=mid:bar
    a=rtcp-mux
    a=rtpmap:32 MPV/90000
    a=extmap 1 urn:ietf:params:rtp-hdrext:sdes:mid


]]></artwork>
        </figure>
    </section>

    <section title="Example: BUNDLE Extension Rejected" anchor="sec-example-bunrej" toc="default">
      <t>
        The example below shows:
        <list style="symbols">
          <t>An offer, in which the offerer places a unique address/port combination in each bundled "m=" section within the BUNDLE group.</t>
          <t>An answer, in which the answerer rejects the offered BUNDLE group, and places a unique address/port
          in each "m=" section (following normal RFC 3264 procedures).</t>
        </list>
      </t>
      <figure>
      <artwork align="left" alt="" height="" name="" type="" width=""
                   xml:space="preserve"><![CDATA[

SDP Offer (1)

    v=0
    o=alice 2890844526 2890844526 IN IP4 atlanta.example.com
    s=
    c=IN IP4 atlanta.example.com
    t=0 0
    a=group:BUNDLE foo bar
    m=audio 10000 RTP/AVP 0 8 97
    b=AS:200
    a=mid:foo
    a=rtcp-mux
    a=rtpmap:0 PCMU/8000
    a=rtpmap:8 PCMA/8000
    a=rtpmap:97 iLBC/8000
    a=extmap 1 urn:ietf:params:rtp-hdrext:sdes:mid
    m=video 10002 RTP/AVP 31 32
    b=AS:1000
    a=mid:bar
    a=rtcp-mux
    a=rtpmap:31 H261/90000
    a=rtpmap:32 MPV/90000
    a=extmap 1 urn:ietf:params:rtp-hdrext:sdes:mid


SDP Answer (2)

    v=0
    o=bob 2808844564 2808844564 IN IP4 biloxi.example.com
    s=
    c=IN IP4 biloxi.example.com
    t=0 0
    m=audio 20000 RTP/AVP 0
    b=AS:200
    a=rtcp-mux
    a=rtpmap:0 PCMU/8000
    m=video 30000 RTP/AVP 32
    b=AS:1000
    a=rtcp-mux
    a=rtpmap:32 MPV/90000


      ]]></artwork>
      </figure>
    </section>

    <section title="Example: Offerer Adds A Media Description To A BUNDLE Group" anchor="sec-example-off-add" toc="default">
      <t>
        The example below shows:
        <list style="symbols">
          <t>A subsequent offer (the BUNDLE group has been created as part of a previous offer/answer
          exchange), in which the offerer adds a new "m=" section, identified by the "zen"
          identification-tag, to a previously negotiated BUNDLE group, places a unique address/port
          in the added "m=" section, and places the previously selected BUNDLE transport address/port in
          each of the other bundled "m=" sections within the BUNDLE group.</t>
          <t>An answer, in which the answerer places its BUNDLE tranport address/port in each
          bundled "m=" section (including the newly added "m=" section) within the BUNDLE group.</t>
        </list>
      </t>
          <figure>
          <artwork align="left" alt="" height="" name="" type="" width=""
                   xml:space="preserve"><![CDATA[

SDP Offer (1)

    v=0
    o=alice 2890844526 2890844526 IN IP4 atlanta.example.com
    s=
    c=IN IP4 atlanta.example.com
    t=0 0
    a=group:BUNDLE foo bar zen
    m=audio 10000 RTP/AVP 0 8 97
    b=AS:200
    a=mid:foo
    a=rtcp-mux
    a=rtpmap:0 PCMU/8000
    a=rtpmap:8 PCMA/8000
    a=rtpmap:97 iLBC/8000
    a=extmap 1 urn:ietf:params:rtp-hdrext:sdes:mid
    m=video 10000 RTP/AVP 31 32
    b=AS:1000
    a=mid:bar
    a=rtcp-mux
    a=rtpmap:31 H261/90000
    a=rtpmap:32 MPV/90000
    a=extmap 1 urn:ietf:params:rtp-hdrext:sdes:mid
    m=video 20000 RTP/AVP 66
    b=AS:1000
    a=mid:zen
    a=rtcp-mux
    a=rtpmap:66 H261/90000
    a=extmap 1 urn:ietf:params:rtp-hdrext:sdes:mid


SDP Answer (2)

    v=0
    o=bob 2808844564 2808844564 IN IP4 biloxi.example.com
    s=
    c=IN IP4 biloxi.example.com
    t=0 0
    a=group:BUNDLE foo bar zen
    m=audio 20000 RTP/AVP 0
    b=AS:200
    a=mid:foo
    a=rtcp-mux
    a=rtpmap:0 PCMU/8000
    a=extmap 1 urn:ietf:params:rtp-hdrext:sdes:mid
    m=video 20000 RTP/AVP 32
    b=AS:1000
    a=mid:bar
    a=rtcp-mux
    a=rtpmap:32 MPV/90000
    a=extmap 1 urn:ietf:params:rtp-hdrext:sdes:mid
    m=video 20000 RTP/AVP 66
    b=AS:1000
    a=mid:zen
    a=rtcp-mux
    a=rtpmap:66 H261/90000
    a=extmap 1 urn:ietf:params:rtp-hdrext:sdes:mid


]]></artwork>
        </figure>
    </section>

    <section title="Example: Offerer Moves A Media Description Out Of A BUNDLE Group" anchor="sec-example-off-mov" toc="default">
      <t>
        The example below shows:
        <list style="symbols">
          <t>A subsequent offer (the BUNDLE group has been created as part of a previous offer/answer
          transaction), in which the offerer moves a bundled "m=" section out of a BUNDLE group, places a unique address/port in
          the moved "m=" section, and places the previously selected BUNDLE transport address/port in each other bundled "m=" section within the BUNDLE group.</t>
          <t>An answer, in which the answerer moves the "m=" section out of the BUNDLE group, places a unique address/port in
          the moved "m=" section, and places its BUNDLE transport address/port in each of the remaining bundled "m=" sections within the BUNDLE group.</t>
        </list>
      </t>
          <figure>
          <artwork align="left" alt="" height="" name="" type="" width=""
                   xml:space="preserve"><![CDATA[

SDP Offer (1)

    v=0
    o=alice 2890844526 2890844526 IN IP4 atlanta.example.com
    s=
    c=IN IP4 atlanta.example.com
    t=0 0
    a=group:BUNDLE foo bar
    m=audio 10000 RTP/AVP 0 8 97
    b=AS:200
    a=mid:foo
    a=rtcp-mux
    a=rtpmap:0 PCMU/8000
    a=rtpmap:8 PCMA/8000
    a=rtpmap:97 iLBC/8000
    a=extmap 1 urn:ietf:params:rtp-hdrext:sdes:mid
    m=video 10000 RTP/AVP 31 32
    b=AS:1000
    a=mid:bar
    a=rtcp-mux
    a=rtpmap:31 H261/90000
    a=rtpmap:32 MPV/90000
    a=extmap 1 urn:ietf:params:rtp-hdrext:sdes:mid
    m=video 50000 RTP/AVP 66
    b=AS:1000
    a=mid:zen
    a=rtcp-mux
    a=rtpmap:66 H261/90000


SDP Answer (2)

    v=0
    o=bob 2808844564 2808844564 IN IP4 biloxi.example.com
    s=
    c=IN IP4 biloxi.example.com
    t=0 0
    a=group:BUNDLE foo bar
    m=audio 20000 RTP/AVP 0
    b=AS:200
    a=mid:foo
    a=rtcp-mux
    a=rtpmap:0 PCMU/8000
    a=extmap 1 urn:ietf:params:rtp-hdrext:sdes:mid
    m=video 20000 RTP/AVP 32
    b=AS:1000
    a=mid:bar
    a=rtcp-mux
    a=rtpmap:32 MPV/90000
    a=extmap 1 urn:ietf:params:rtp-hdrext:sdes:mid
    m=video 60000 RTP/AVP 66
    b=AS:1000
    a=mid:zen
    a=rtcp-mux
    a=rtpmap:66 H261/90000


]]></artwork>
        </figure>
    </section>

        <section title="Example: Offerer Disables A Media Description Within A BUNDLE Group" anchor="sec-example-off-dis" toc="default">
      <t>
        The example below shows:
        <list style="symbols">
          <t>A subsequent offer (the BUNDLE group has been created as part of a previous offer/answer
          transaction), in which the offerer disables a bundled "m=" section within a BUNDLE group, assigns a zero port number
          to the disabled "m=" section, and places the previously selected BUNDLE transport address/port in each of the other bundled
          "m=" sections within the BUNDLE group.</t>
          <t>An answer, in which the answerer moves the disabled "m=" section out of the BUNDLE group, assigns a zero port value
          to the disabled "m=" section, and places its BUNDLE transport address/port in each of the remaining bundled "m=" sections within
          the BUNDLE group.</t>
        </list>
      </t>
          <figure>
          <artwork align="left" alt="" height="" name="" type="" width=""
                   xml:space="preserve"><![CDATA[

SDP Offer (1)

    v=0
    o=alice 2890844526 2890844526 IN IP4 atlanta.example.com
    s=
    c=IN IP4 atlanta.example.com
    t=0 0
    a=group:BUNDLE foo bar
    m=audio 10000 RTP/AVP 0 8 97
    b=AS:200
    a=mid:foo
    a=rtcp-mux
    a=rtpmap:0 PCMU/8000
    a=rtpmap:8 PCMA/8000
    a=rtpmap:97 iLBC/8000
    a=extmap 1 urn:ietf:params:rtp-hdrext:sdes:mid
    m=video 10000 RTP/AVP 31 32
    b=AS:1000
    a=mid:bar
    a=rtcp-mux
    a=rtpmap:31 H261/90000
    a=rtpmap:32 MPV/90000
    a=extmap 1 urn:ietf:params:rtp-hdrext:sdes:mid
    m=video 0 RTP/AVP 66
    a=mid:zen
    a=rtpmap:66 H261/90000


SDP Answer (2)

    v=0
    o=bob 2808844564 2808844564 IN IP4 biloxi.example.com
    s=
    c=IN IP4 biloxi.example.com
    t=0 0
    a=group:BUNDLE foo bar
    m=audio 20000 RTP/AVP 0
    b=AS:200
    a=mid:foo
    a=rtcp-mux
    a=rtpmap:0 PCMU/8000
    a=extmap 1 urn:ietf:params:rtp-hdrext:sdes:mid
    m=video 20000 RTP/AVP 32
    b=AS:1000
    a=mid:bar
    a=rtcp-mux
    a=rtpmap:32 MPV/90000
    a=extmap 1 urn:ietf:params:rtp-hdrext:sdes:mid
    m=video 0 RTP/AVP 66
    a=mid:zen
    a=rtpmap:66 H261/90000


      ]]></artwork>
      </figure>
    </section>
  </section>

  <section anchor="sec-acks" title="Acknowledgements" toc="default">
    <t>
      The usage of the SDP grouping extension for negotiating bundled media is
      based on a similar alternatives proposed by Harald Alvestrand and Cullen
      Jennings. The BUNDLE extension described in this document is based on
      the different alternative proposals, and text (e.g., SDP examples)
      have been borrowed (and, in some cases, modified) from those alternative
      proposals.
    </t>
    <t>
      The SDP examples are also modified versions from the ones in the Alvestrand
      proposal.
    </t>
    <t>
      Thanks to Paul Kyzivat, Martin Thomson, Flemming Andreasen, Thomas Stach,
      Ari Keranen, Adam Roach, Christian Groves, Roman Shpount, Suhas Nandakumar, Nils
      Ohlmeier, Jens Guballa, Raju Makaraju and Justin Uberti for
      reading the text, and providing useful feedback.
    </t>
    <t>
      Thanks to Magnus Westerlund, Colin Perkins and Jonathan Lennox for providing
      help and text on the RTP/RTCP procedures.
    </t>
    <t>
      Thanks to Spotify for providing music for the countless hours of
      document editing.
    </t>
  </section>

  <section title="Change Log">
    <t>[RFC EDITOR NOTE: Please remove this section when publishing]</t>
    <t>Changes from draft-ietf-mmusic-sdp-bundle-negotiation-35
      <list style="symbols">
        <t>Editorial changes on RTP streaming mapping section based on comments from Colin Perkins.</t>
      </list>
    </t>
    <t>Changes from draft-ietf-mmusic-sdp-bundle-negotiation-34
      <list style="symbols">
        <t>RTP streams, instead of RTP packets, are associated with m- lines.</t>
      </list>
    </t>
    <t>Changes from draft-ietf-mmusic-sdp-bundle-negotiation-33
      <list style="symbols">
        <t>Editorial changes based on comments from Eric Rescorla and Cullen Jennings:</t>
        <t>- Changes regarding usage of RTP/RTCP multiplexing attributes.</t>
        <t>- Additional text regarding associating RTP/RTCP packets with SDP m- lines.</t>
        <t>- Reference correction.</t>
      </list>
    </t>
    <t>Changes from draft-ietf-mmusic-sdp-bundle-negotiation-32
      <list style="symbols">
        <t>Editorial changes based on comments from Eric Rescorla and Cullen Jennings:</t>
        <t>- Justification for mechanism added to Introduction.</t>
        <t>- Clarify that the order of m- lines in the group:BUNDLE
          attribute does not have to be the same as the order in which
          the m- lines are listed in the SDP.</t>
      </list>
    </t>
    <t>Changes from draft-ietf-mmusic-sdp-bundle-negotiation-31
      <list style="symbols">
        <t>Editorial changes based on GitHub Pull requests by Martin Thomson:</t>
        <t>- https://github.com/cdh4u/draft-sdp-bundle/pull/2</t>
        <t>- https://github.com/cdh4u/draft-sdp-bundle/pull/1</t>
        <t>Editorial change based on comment from Diederick Huijbers (9th July 2016).</t>
        <t>Changes based on comments from Flemming Andreasen (21st June 2016):</t>
        <t>- Mux category for SDP bundle-only attribute added.</t>
        <t>- Mux category considerations editorial clarification.</t>
        <t>- Editorial changes.</t>
        <t>RTP SDES extension according to draft-ietf-avtext-sdes-hdr-ext.</t>
        <t>Note whether Design Considerations appendix is to be kept removed:</t>
        <t>- Appendix is kept within document.</t>
      </list>
    </t>
    <t>Changes from draft-ietf-mmusic-sdp-bundle-negotiation-30
      <list style="symbols">
        <t>Indicating in the Abstract and Introduction that
        the document updates RFC 3264.</t>
      </list>
    </t>
    <t>Changes from draft-ietf-mmusic-sdp-bundle-negotiation-29
      <list style="symbols">
        <t>Change based on WGLC comment from Colin Perkins.</t>
        <t>- Clarify that SSRC can be reused by another source
             after a delay of 5 RTCP reporting intervals.</t>
        <t>Change based on WGLC comment from Alissa Cooper.</t>
        <t>- IANA registry name fix.</t>
        <t>- Additional IANA registration information added.</t>
      </list>
    </t>
    <t>Changes from draft-ietf-mmusic-sdp-bundle-negotiation-28
      <list style="symbols">
       <t>- Alignment with exclusive mux procedures.</t>
      </list>
    </t>
    <t>Changes from draft-ietf-mmusic-sdp-bundle-negotiation-27
      <list style="symbols">
       <t>- Yet another terminology change.</t>
       <t>- Mux category considerations added.</t>
      </list>
    </t>
    <t>Changes from draft-ietf-mmusic-sdp-bundle-negotiation-26
      <list style="symbols">
        <t>- ICE considerations modified: ICE-related SDP attributes only added
             to the bundled m- line representing the selected BUNDLE address.</t>
        <t>- Reference to draft-ietf-mmusic-ice-sip-sdp added.</t>
        <t>- Reference to RFC 5245 replaced with reference to draft-ietf-ice-rfc5245bis.</t>
      </list>
    </t>
    <t>Changes from draft-ietf-mmusic-sdp-bundle-negotiation-25
      <list style="symbols">
        <t>- RTP/RTCP mux procedures updated with exclusive RTP/RTCP mux considerations.</t>
      </list>
    </t>
    <t>Changes from draft-ietf-mmusic-sdp-bundle-negotiation-24
      <list style="symbols">
        <t>- Reference and procedures associated with exclusive RTP/RTCP mux added</t>
      </list>
    </t>
    <t>Changes from draft-ietf-mmusic-sdp-bundle-negotiation-23
      <list style="symbols">
        <t>- RTCP-MUX mandatory for bundled RTP m- lines</t>
        <t>- Editorial fixes based on comments from Flemming Andreasen</t>
      </list>
    </t>
    <t>Changes from draft-ietf-mmusic-sdp-bundle-negotiation-22
      <list style="symbols">
        <t>- Correction of Ari's family name</t>
        <t>- Editorial fixes based on comments from Thomas Stach</t>
        <t>- RTP/RTCP correction based on comment from Magnus Westerlund</t>
        <t>-- http://www.ietf.org/mail-archive/web/mmusic/current/msg14861.html</t>
      </list>
    </t>
    <t>Changes from draft-ietf-mmusic-sdp-bundle-negotiation-21
      <list style="symbols">
        <t>- Correct based on comment from Paul Kyzivat</t>
        <t>-- 'received packets' replaced with 'received data'</t>
      </list>
    </t>
    <t>Changes from draft-ietf-mmusic-sdp-bundle-negotiation-20
      <list style="symbols">
        <t>- Clarification based on comment from James Guballa</t>
        <t>- Clarification based on comment from Flemming Andreasen</t>
      </list>
    </t>
    <t>Changes from draft-ietf-mmusic-sdp-bundle-negotiation-19
      <list style="symbols">
        <t>- DTLS Considerations section added.</t>
        <t>- BUNDLE semantics added to the IANA Considerations</t>
        <t>- Changes based on WGLC comments from Adam Roach</t>
        <t>-- http://www.ietf.org/mail-archive/web/mmusic/current/msg14673.html</t>
      </list>
    </t>
    <t>Changes from draft-ietf-mmusic-sdp-bundle-negotiation-18
      <list style="symbols">
        <t>- Changes based on agreements at IETF#92</t>
        <t>-- BAS Offer removed, based on agreement at IETF#92.</t>
        <t>-- Procedures regarding usage of SDP "b=" line is replaced with a
        reference to to draft-ietf-mmusic-sdp-mux-attributes.</t>
      </list>
    </t>
    <t>Changes from draft-ietf-mmusic-sdp-bundle-negotiation-17
      <list style="symbols">
        <t>- Editorial changes based on comments from Magnus Westerlund.</t>
      </list>
    </t>
    <t>Changes from draft-ietf-mmusic-sdp-bundle-negotiation-16
      <list style="symbols">
        <t>- Modification of RTP/RTCP multiplexing section, based
        on comments from Magnus Westerlund.</t>
        <t>- Reference updates.</t>
      </list>
    </t>
    <t>Changes from draft-ietf-mmusic-sdp-bundle-negotiation-15
      <list style="symbols">
        <t>- Editorial fix.</t>
      </list>
    </t>
    <t>Changes from draft-ietf-mmusic-sdp-bundle-negotiation-14
      <list style="symbols">
        <t>- Editorial changes.</t>
      </list>
    </t>
    <t>Changes from draft-ietf-mmusic-sdp-bundle-negotiation-13
      <list style="symbols">
        <t>Changes to allow a new suggested offerer BUNDLE address
        to be assigned to each bundled m- line.</t>
        <t>Changes based on WGLC comments from Paul Kyzivat</t>
        <t>- Editorial fixes</t>
      </list>
    </t>
    <t>Changes from draft-ietf-mmusic-sdp-bundle-negotiation-12
      <list style="symbols">
        <t>Usage of SDP 'extmap' attribute added</t>
        <t>SDP 'bundle-only' attribute scoped with "m=" sections with a zero port value</t>
        <t>Changes based on WGLC comments from Thomas Stach</t>
        <t>- ICE candidates not assigned to bundle-only m- lines with a zero port value</t>
        <t>- Editorial changes</t>
        <t>Changes based on WGLC comments from Colin Perkins</t>
        <t>- Editorial changes:</t>
        <t>-- "RTP SDES item" -> "RTCP SDES item"</t>
        <t>-- "RTP MID SDES item" -> "RTCP MID SDES item"</t>
        <t>- Changes in section 10.1.1:</t>
        <t>-- "SHOULD NOT" -> "MUST NOT"</t>
        <t>-- Additional text added to the Note</t>
        <t>- Change to section 13.2:</t>
        <t>-- Clarify that mid value is not zero terminated</t>
        <t>- Change to section 13.3:</t>
        <t>-- Clarify that mid value is not zero terminated</t>
        <t>-- Clarify padding</t>
        <t>Changes based on WGLC comments from Paul Kyzivat</t>
        <t>- Editorial changes:</t>
        <t>Changes based on WGLC comments from Jonathan Lennox</t>
        <t>- Editorial changes:</t>
        <t>- Defintion of SDP bundle-only attribute alligned with
        structure in 4566bis draft</t>
      </list>
    </t>
    <t>Changes from draft-ietf-mmusic-sdp-bundle-negotiation-11
      <list style="symbols">
        <t>Editorial corrections based on comments from Harald Alvestrand.</t>
        <t>Editorial corrections based on comments from Cullen Jennings.</t>
        <t>Reference update (RFC 7160).</t>
        <t>Clarification about RTCP packet sending when RTP/RTCP multiplexing
        is not used (http://www.ietf.org/mail-archive/web/mmusic/current/msg13765.html).</t>
        <t>Additional text added to the Security Considerations.</t>
      </list>
    </t>
    <t>Changes from draft-ietf-mmusic-sdp-bundle-negotiation-10
      <list style="symbols">
        <t>SDP bundle-only attribute added to IANA Considerations.</t>
        <t>SDES item and RTP header extension added to Abstract and Introduction.</t>
        <t>Modification to text updating section 8.2 of RFC 3264.</t>
        <t>Reference corrections.</t>
        <t>Editorial corrections.</t>
      </list>
    </t>
    <t>Changes from draft-ietf-mmusic-sdp-bundle-negotiation-09
      <list style="symbols">
        <t>Terminology change: "bundle-only attribute assigned to m= line" to
        "bundle-only attribute associated with m= line".</t>
        <t>Editorial corrections.</t>
      </list>
    </t>
    <t>Changes from draft-ietf-mmusic-sdp-bundle-negotiation-08
      <list style="symbols">
        <t>Editorial corrections.</t>
        <t>- "of"->"if" (8.3.2.5).</t>
        <t>- "optional"->"OPTIONAL" (9.1).</t>
        <t>- Syntax/ABNF for 'bundle-only' attribute added.</t>
        <t>- SDP Offer/Answer sections merged.</t>
        <t>- 'Request new offerer BUNDLE address' section added</t>
      </list>
    </t>
    <t>Changes from draft-ietf-mmusic-sdp-bundle-negotiation-07
      <list style="symbols">
        <t>OPEN ISSUE regarding Receiver-ID closed.</t>
        <t>- RTP MID SDES Item.</t>
        <t>- RTP MID Header Extension.</t>
        <t>OPEN ISSUE regarding insertion of SDP 'rtcp' attribute in answers closed.</t>
        <t>- Indicating that, when rtcp-mux is used, the answerer MUST NOT include
        an 'rtcp' attribute in the answer, based on the procedures in section 5.1.3 of
        RFC 5761.</t>
      </list>
    </t>
    <t>Changes from draft-ietf-mmusic-sdp-bundle-negotiation-06
      <list style="symbols">
        <t>Draft title changed.</t>
        <t>Added "SDP" to section names containing "Offer" or "Answer".</t>
        <t>Editorial fixes based on comments from Paul Kyzivat (http://www.ietf.org/mail-archive/web/mmusic/current/msg13314.html).</t>
        <t>Editorial fixed based on comments from Colin Perkins (http://www.ietf.org/mail-archive/web/mmusic/current/msg13318.html).</t>
        <t>- Removed text about extending BUNDLE to allow multiple RTP sessions within a BUNDLE group.</t>
      </list>
    </t>
    <t>Changes from draft-ietf-mmusic-sdp-bundle-negotiation-05
      <list style="symbols">
        <t>Major re-structure of SDP Offer/Answer sections, to align with RFC 3264 structure.</t>
        <t>Additional definitions added.</t>
        <t>- Shared address.</t>
        <t>- Bundled "m=" section.</t>
        <t>- Bundle-only "m=" section.</t>
        <t>- Offerer suggested BUNDLE mid.</t>
        <t>- Answerer selected BUNDLE mid.</t>
        <t>Q6 Closed (IETF#88): An Offerer MUST NOT assign a shared address to multiple "m=" sections until it has
        received an SDP Answer indicating support of the BUNDLE extension.</t>
        <t>Q8 Closed (IETF#88): An Offerer can, before it knows whether the Answerer supports the BUNDLE extension,
        assign a zero port value to a 'bundle-only' "m=" section.</t>
        <t>SDP 'bundle-only' attribute section added.</t>
        <t>Connection data nettype/addrtype restrictions added.</t>
        <t>RFC 3264 update section added.</t>
        <t>Indicating that a specific payload type value can be used in multiple "m=" sections, if the value
        represents the same codec configuration in each "m=" section.</t>
      </list>
    </t>
    <t>Changes from draft-ietf-mmusic-sdp-bundle-negotiation-04
      <list style="symbols">
        <t>Updated Offerer procedures (http://www.ietf.org/mail-archive/web/mmusic/current/msg12293.html).</t>
        <t>Updated Answerer procedures (http://www.ietf.org/mail-archive/web/mmusic/current/msg12333.html).</t>
        <t>Usage of SDP 'bundle-only' attribute added.</t>
        <t>Reference to Trickle ICE document added.</t>
      </list>
    </t>
    <t>Changes from draft-ietf-mmusic-sdp-bundle-negotiation-02
      <list style="symbols">
        <t>Mechanism modified, to be based on usage of SDP Offers
        with both different and identical port number values, depending
        on whether it is known if the remote endpoint supports the
        extension.</t>
        <t>Cullen Jennings added as co-author.</t>
      </list>
    </t>
    <t>Changes from draft-ietf-mmusic-sdp-bundle-negotiation-01
      <list style="symbols">
        <t>No changes. New version due to expiration.</t>
      </list>
    </t>
    <t>Changes from draft-ietf-mmusic-sdp-bundle-negotiation-00
      <list style="symbols">
        <t>No changes. New version due to expiration.</t>
      </list>
    </t>
    <t>Changes from draft-holmberg-mmusic-sdp-multiplex-negotiation-00
      <list style="symbols">
        <t>Draft name changed.</t>
        <t>Harald Alvestrand added as co-author.</t>
        <t>"Multiplex" terminology changed to "bundle".</t>
        <t>Added text about single versus multiple RTP Sessions.</t>
        <t>Added reference to RFC 3550.</t>
      </list>
    </t>
  </section>
</middle>

<back>
    <references title="Normative References">
    <?rfc include="reference.RFC.2119"?>
    <?rfc include="reference.RFC.3264"?>
    <?rfc include="reference.RFC.3550"?>
    <?rfc include="reference.RFC.3605"?>
    <?rfc include="reference.RFC.4566"?>
    <?rfc include="reference.RFC.4961"?>
    <?rfc include="reference.RFC.5245"?>
    <?rfc include="reference.RFC.5285"?>
    <?rfc include="reference.RFC.5761"?>
    <?rfc include="reference.RFC.5764"?>
    <?rfc include="reference.RFC.5888"?>
    <?rfc include="reference.RFC.6347"?>
    <?rfc include="reference.RFC.7656"?>
    <?rfc include="reference.RFC.7941"?>
    <?rfc include="reference.I-D.draft-ietf-ice-rfc5245bis-04"?>
    <?rfc include="reference.I-D.draft-ietf-mmusic-sdp-mux-attributes-14"?>
    <?rfc include="reference.I-D.draft-ietf-mmusic-mux-exclusive-10"?>
    <?rfc include="reference.I-D.draft-ietf-mmusic-ice-sip-sdp-10"?>
    </references>

    <references title="Informative References">
    <?rfc include="reference.RFC.3261"?>
    <?rfc include="reference.RFC.4568"?>
    <?rfc include="reference.RFC.5576"?>
    <?rfc include="reference.RFC.7160"?>
    <?rfc include="reference.I-D.draft-ietf-mmusic-trickle-ice-02"?>
    </references>

  <section  title="Design Considerations" toc="default">
      <t>
        One of the main issues regarding the BUNDLE grouping extensions has been whether,
        in SDP Offers and SDP Answers, the same port value should be inserted in "m="
        lines associated with a BUNDLE group, as the purpose of the extension is to negotiate
        the usage of a single transport for media specified by the
        "m=" sections. Issues with both approaches, discussed in the Appendix have been
        raised. The outcome was to specify a mechanism which uses SDP Offers with both
        different and identical port values.
      </t>
      <t>
        Below are the primary issues that have been considered when defining the "BUNDLE"
        grouping extension:
        <list style="symbols">
          <t>1) Interoperability with existing UAs.</t>
          <t>2) Interoperability with intermediary B2BUA- and proxy entities.</t>
          <t>3) Time to gather, and the number of, ICE candidates.</t>
          <t>4) Different error scenarios, and when they occur.</t>
          <t>5) SDP Offer/Answer impacts, including usage of port number value zero.</t>
        </list>
      </t>

    <section  title="UA Interoperability" toc="default">
      <t>
        Consider the following SDP Offer/Answer exchange, where Alice sends an SDP Offer to Bob:
      </t>
      <figure>
        <artwork align="left" alt="" height="" name="" type="" width=""
                   xml:space="preserve"><![CDATA[

SDP Offer

    v=0
    o=alice 2890844526 2890844526 IN IP4 atlanta.example.com
    s=
    c=IN IP4 atlanta.example.com
    t=0 0
    m=audio 10000 RTP/AVP 97
    a=rtpmap:97 iLBC/8000
    m=video 10002 RTP/AVP 97
    a=rtpmap:97 H261/90000


]]></artwork>
      </figure>
      <figure>
        <artwork align="left" alt="" height="" name="" type="" width=""
                   xml:space="preserve"><![CDATA[

SDP Answer

    v=0
    o=bob 2808844564 2808844564 IN IP4 biloxi.example.com
    s=
    c=IN IP4 biloxi.example.com
    t=0 0
    m=audio 20000 RTP/AVP 97
    a=rtpmap:97 iLBC/8000
    m=video 20002 RTP/AVP 97
    a=rtpmap:97 H261/90000

]]></artwork>
      </figure>
      <t>
        RFC 4961 specifies a way of doing symmetric RTP but that is an a later
        invention to RTP and Bob can not assume that Alice supports RFC 4961. This
        means that Alice may be sending RTP from a different port than 10000 or
        10002 - some implementation simply send the RTP from an ephemeral
        port. When Bob's endpoint receives an RTP packet, the only way that Bob
        knows if it should be passed to the video or audio codec is by looking at
        the port it was received on. This lead some SDP implementations to use the
        fact that each "m=" section had a different port number to use that port
        number as an index to find the correct m line in the SDP. As a result, some
        implementations that do support symmetric RTP and ICE still use a SDP data
        structure where SDP with "m=" sections with the same port such as:
      </t>
      <figure>
        <artwork align="left" alt="" height="" name="" type="" width=""
                   xml:space="preserve"><![CDATA[

SDP Offer

    v=0
    o=alice 2890844526 2890844526 IN IP4 atlanta.example.com
    s=
    c=IN IP4 atlanta.example.com
    t=0 0
    m=audio 10000 RTP/AVP 97
    a=rtpmap:97 iLBC/8000
    m=video 10000 RTP/AVP 98
    a=rtpmap:98 H261/90000


]]></artwork>
      </figure>
      <t>
        will result in the second "m=" section being considered an SDP error
        because it has the same port as the first line.
      </t>
    </section>

    <section  title="Usage of port number value zero" toc="default">
      <t>
        In an SDP Offer or SDP Answer, the media specified by an "m=" section can be
        disabled/rejected by setting the port number value to zero. This is different
        from e.g., using the SDP direction attributes, where RTCP traffic will
        continue even if the SDP "inactive" attribute is indicated for the
        associated "m=" section.
      </t>
      <t>
        If each "m=" section associated with a BUNDLE group would contain different
        port values, and one of those port values would be used for a BUNDLE address
        associated with the BUNDLE group, problems would occur if an endpoint wants to
        disable/reject the "m=" section associated with that port, by setting the port
        value to zero. After that, no "m=" section would contain the port value which
        is used for the BUNDLE address.  In addition, it is unclear what would happen
        to the ICE candidates associated with the "m=" section, as they are also used for
        the BUNDLE address.
      </t>
    </section>

    <section  title="B2BUA And Proxy Interoperability" toc="default">
      <t>
        Some back to back user agents may be configured in a mode where if
        the incoming call leg contains an SDP attribute the B2BUA does not
        understand, the B2BUA still generates that SDP attribute in the Offer
        for the outgoing call leg. Consider a B2BUA that did not understand
        the SDP "rtcp" attribute, defined in RFC 3605, yet acted this way.
        Further assume that the B2BUA was configured to tear down any call
        where it did not see any RTCP for 5 minutes. In this case, if the B2BUA
        received an Offer like:
    </t>
    <figure>
      <artwork align="left" alt="" height="" name="" type="" width=""
                   xml:space="preserve"><![CDATA[

SDP Offer

    v=0
    o=alice 2890844526 2890844526 IN IP4 atlanta.example.com
    s=
    c=IN IP4 atlanta.example.com
    t=0 0
    m=audio 49170 RTP/AVP 0
    a=rtcp:53020


]]></artwork>
        </figure>
        <t>
      It would be looking for RTCP on port 49172 but would not see any
      because the RTCP would be on port 53020 and after five minutes, it would
      tear down the call. Similarly, a B2BUA that did not understand BUNDLE yet
      put BUNDLE in it's offer may be looking for media on the wrong port and
      tear down the call. It is worth noting that a B2BUA that generated an
      Offer with capabilities it does not understand is not compliant with the
      specifications.
    </t>

      <section  title="Traffic Policing" toc="default">
        <t>
          Sometimes intermediaries do not act as B2BUA, in the sense that
          they don't modify SDP bodies, nor do they terminate SIP dialogs.
          Still, however, they may use SDP information (e.g., IP address and
          port) in order to control traffic gating functions, and to set
          traffic policing rules. There might be rules which will trigger
          a session to be terminated in case media is not sent or received
          on the ports retrieved from the SDP. This typically occurs once the
          session is already established and ongoing.
        </t>
      </section>
      <section  title="Bandwidth Allocation" toc="default">
        <t>
          Sometimes intermediaries do not act as B2BUA, in the sense that
          they don't modify SDP bodies, nor do they terminate SIP dialogs.
          Still, however, they may use SDP information (e.g., codecs and
          media types) in order to control bandwidth allocation functions.
          The bandwidth allocation is done per "m=" section, which means that
          it might not be enough if media specified by all "m=" sections
          try to use that bandwidth. That may either simply lead to bad
          user experience, or to termination of the call.
        </t>
      </section>
    </section>

    <section  title="Candidate Gathering" toc="default">
      <t>
        When using ICE, a candidate needs to be gathered for each port. This
        takes approximately 20 ms extra for each extra "m=" section due to the NAT
        pacing requirements. All of this gather can be overlapped with other
        things while for exampe a web-page is loading to minimize the impact. If the client
        only wants to generate TURN or STUN ICE candidates for one of the "m="
        lines and then use trickle ICE <xref target="I-D.ietf-mmusic-trickle-ice" />
        to get the non host ICE candidates for the rest of the "m=" sections, it MAY do
        that and will not need any additional gathering time.
      </t>
      <t>
        Some people have suggested a TURN extension to get a bunch of TURN
        allocations at once. This would only provide a single STUN result so in
        cases where the other end did not support BUNDLE, may cause more use of
        the TURN server but would be quick in the cases where both sides
        supported BUNDLE and would fall back to a successful call in the other
        cases.
      </t>
    </section>
    </section>
  </back>
</rfc>
